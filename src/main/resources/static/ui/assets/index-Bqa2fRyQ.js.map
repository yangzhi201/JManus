{"version":3,"mappings":"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","names":["CommonApiService","planId","response","errorText","rawText","data","error","formData","errorData","contentType","useMessageFormatting","text","timestamp","diff","message","computed","bytes","k","sizes","i","maxLength","html","formatTimestamp","formatFileSize","_createElementBlock","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_openBlock","_hoisted_4","_Fragment","attachment","index","_createVNode","_unref","Icon","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","props","__props","emit","__emit","t","useI18n","getNestingClass","getSubPlanStatusClass","agent","getSubPlanStatusText","getSubPlanStatusIcon","getSubPlanProgress","completedCount","getSubPlanCompletedCount","getAgentPreviewStatusClass","status","getAgentPreviewStatusIcon","getAgentStatusText","hasNestedSubPlans","step","getNestedSubPlans","handleSubPlanClick","handleSubPlanAgentClick","agentIndex","stepId","handleThinkActStepClick","_stepIndex","handleNestedSubPlanSelected","subPlanIndex","subPlan","handleNestedStepSelected","_normalizeClass","_hoisted_1","$t","nestingLevel","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","$event","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_renderList","maxVisibleSteps","stepIndex","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","nestedStep","nestedStepIndex","_createBlock","_component_RecursiveSubPlan","maxNestingDepth","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","directSubPlan","directIndex","agentExecutionSequence","handleAgentClick","agentExecution","getPlanStatusClass","getPlanStatusText","getAgentStatusClass","getAgentStatusIcon","handleStepSelected","formatToolParameters","parameters","parsed","planExecution","_hoisted_17","RecursiveSubPlan","shouldShowThinking","handleAgentSelected","handleSubPlanSelected","handleUserInputSubmit","inputData","thinking","thinkingDetails","ExecutionDetails","stepActions","genericInput","hasContent","formInputsStore","reactive","ref","isInitialized","initializationTimeout","initializeFormInputs","formInputs","input","onMounted","watch","value","numIndex","label","getOptionsArray","options","opt","isRequired","required","onUnmounted","userInputWaitState","inputIndex","_vModelText","option","_vModelSelect","_vModelCheckbox","_vModelRadio","formatResponseText","copyToClipboard","plainText","handleRegenerate","handleRetry","handleUserInputSubmitted","UserInputForm","_mergeProps","content","isStreaming","handleCopy","ThinkingSection","ResponseSection","_cache","getMessageClasses","messageClasses","messageId","UserMessage","AssistantMessage","convertPlanExecutionRecord","record","converted","convertAgentExecutionRecord","convertMessageToCompatible","useChatMessages","messages","isLoading","streamingMessageId","activeMessageId","lastMessage","hasMessages","addMessage","type","updateMessage","id","updates","m","removeMessage","clearMessages","startStreaming","stopStreaming","setActiveMessage","appendToMessage","field","updateMessageThinkingDetails","updateMessageThinking","updateMessagePlanExecution","findMessage","getMessageIndex","readonly","useScrollBehavior","containerRef","showScrollToBottom","isAutoScrollEnabled","scrollThreshold","scrollToBottom","smooth","nextTick","isNearBottom","scrollTop","scrollHeight","clientHeight","checkScrollPosition","nearBottom","handleScroll","autoScrollToBottom","forceScrollToBottom","scrollToMessage","messageElement","getScrollInfo","isAtTop","isAtBottom","scrollPercentage","addScrollListener","removeScrollListener","initializeScrollBehavior","cleanupScrollBehavior","PlanExecutionManager","rootPlanId","uiState","deleted","planCacheSize","uiStateCacheSize","callbacks","query","errorPlanId","cachedRecord","uiStatePlanId","DirectApiService","useTaskStore","details","taskStore","PlanActApiService","planExecutionManager","messagesRef","pollingInterval","isMessageStreaming","compatibleMessages","handleMessageContainerClick","event","target","handleCopyMessage","handleRegenerateMessage","handleRetryMessage","handlePlanUpdate","planDetails","messageIndex","finalResponse","handlePlanCompleted","planDetailsObj","summary","handleDialogRoundStart","handlePlanError","__expose","ChatMessage","_Transition","FileUploadApiService","files","file","result","uploadKey","fileName","fileInputRef","uploadedFiles","isUploading","resetSession","newFiles","handleFileUpload","handleFileChange","fileArray","f","uploadFiles","removeFile","fileToRemove","acceptedFileTypes","MemoryStore","memoryId","memoryStore","isTaskRunning","inputRef","fileUploadRef","currentInput","defaultPlaceholder","currentPlaceholder","selectedOption","innerToolOptions","isLoadingTools","loadInnerTools","allTools","CoordinatorToolApiService","filteredTools","tool","inputSchema","param","e","savedTool","selectionOptions","newValue","handleFilesUploaded","key","handleFilesRemoved","handleUploadKeyChanged","handleUploadStarted","handleUploadCompleted","handleUploadError","isDisabled","adjustInputHeight","handleKeydown","handleSend","finalInput","selectedTool","extendedQuery","clearInput","handlePlanModeClick","handleStop","updateState","enabled","placeholder","setInputValue","getQuery","FileUploadComponent","_createTextVNode","MemoryApiService","conversationId","memoryName","showTitleEdit","searchQuery","filteredMessages","showNameModal","currentEditMessageId","nameInput","showDeleteModal","currentDeleteId","expandedMap","handleEscKey","closeDeleteModal","closeNameModal","loadMessages","mes","mesMsg","handleSearch","selectMemory","timestampNum","matchesName","matchesId","matchesContent","bubble","showNameEditModal","currentName","saveName","newName","msg","currentMessage","returnMemory","toggleMessage","filteredIndex","showDeleteConfirm","confirmDelete","_Teleport","_withModifiers","idx","_hoisted_33","_hoisted_46","API_BASE_URL","fetchAgentExecutionDetail","refreshAgentExecutionDetail","FileBrowserApiService","apiResponse","filePath","blob","url","a","mimeType","textMimeTypes","textExtensions","lowerFileName","ext","node","isExpanded","showActions","showContextMenu","contextMenuStyle","toggleExpanded","handleClick","handleFileSelect","hideContextMenu","handleDownload","handleRightClick","copyPath","err","getNodeIcon","level","$emit","child","_component_FileTreeNode","loading","fileTree","selectedFile","fileContent","loadingContent","contentError","autoRefreshTimer","isTextFile","isPlanDirectoryNotFound","clearAutoRefresh","startAutoRefresh","refreshFileTree","errorMessage","handleFileSelected","handleDownloadFile","closeFileViewer","getFileIcon","newPlanId","FileTreeNode","scrollContainer","selectedStep","activeTab","lastExecutedPlanId","hasExecutedAnyPlan","showScrollToBottomButton","shouldAutoScrollToBottom","stepStatusText","fileBrowserPlanId","shouldShowNoTaskMessage","agentExecutionDetail","stepData","checkScrollState","autoScrollToBottomIfNeeded","refreshCurrentStep","newStepId","setScrollContainer","element","hasScrollableContent","formatJson","jsonData","jsonObj","cleanup","initScrollListener","setupScrollListener","oldPlanId","tas","actToolInfo","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_66","FileBrowser","_hoisted_67","_hoisted_68","_hoisted_69","PlanParameterApiService","planTemplateId","showModal","success","publishing","deleting","currentTool","isSaved","publishAsHttpService","publishAsInternalToolcall","parameterRequirements","isLoadingParameters","showGroupSuggestions","availableServiceGroups","isLoadingGroups","filteredServiceGroups","trimmedGroup","group","modalTitle","isUpdate","initializeFormData","newDescription","trimmedDescription","loadAvailableServiceGroups","tools","ToolApiService","groupsSet","handleServiceGroupInput","handleServiceGroupBlur","selectServiceGroup","loadParameterRequirements","requirements","showMessage","validateForm","handlePublish","existingTool","enabledServices","serviceUrls","handleDelete","watchModal","loadCoordinatorToolData","baseUrl","newId","oldId","newVisible","Modal","isSaving","handleCancel","handleSave","handleContinueWithoutSave","modelValue","toast","useToast","executionParams","parameterValues","parameterErrors","isValidationError","isExecutingPlan","showSaveDialog","pendingExecutionPayload","apiTabs","isAnyServiceEnabled","buttonText","canExecute","handleExecutePlan","sidebarStore","validateParameters","replacementParams","proceedWithExecution","payload","handleSaveAndExecute","resolve","handleContinueExecution","handlePublishMcpService","clearExecutionParams","newValues","updateExecutionParamsFromParameters","updateParameterValue","paramName","hasErrors","showPublishButton","currentPlanTemplateId","toolInfo","tab","SaveConfirmationDialog","useJsonEditor","showJsonPreview","displayData","parseJsonToVisual","jsonContent","stepObj","convertVisualToJson","formattedJsonOutput","newContent","oldContent","jsonOutput","initialStepRequirements","isInitialLoad","newRequirements","req","newStep","addStep","removeStep","moveStepUp","moveStepDown","handleRollback","handleRestore","toggleJsonPreview","closeJsonPreview","autoResizeTextarea","textarea","lineHeight","lines","minRows","maxRows","targetRows","newHeight","args","canRollback","canRestore","isGenerating","isExecuting","bind","fn","thisArg","toString","getPrototypeOf","iterator","toStringTag","kindOf","cache","thing","str","kindOfTest","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isEmptyObject","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","trim","forEach","obj","allOwnKeys","l","keys","len","findKey","_key","_global","isContextDefined","context","merge","caseless","skipUndefined","assignValue","targetKey","extend","b","stripBOM","inherits","constructor","superConstructor","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","merged","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","_iterator","pair","matchAll","regExp","matches","isHTMLForm","toCamelCase","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","name","ret","freezeMethods","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","isSpecCompliantForm","toJSONObject","stack","visit","source","reducedValue","isAsyncFn","isThenable","_setImmediate","setImmediateSupported","postMessageSupported","token","cb","asap","isIterable","utils$1","AxiosError","code","config","request","utils","customProps","axiosError","errCode","httpAdapter","isVisitable","removeBrackets","renderKey","path","dots","isFlatArray","predicates","toFormData","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","exposedHelpers","build","encode","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","platform$1","URLSearchParams","FormData","Blob","hasBrowserEnv","_navigator","hasStandardBrowserEnv","hasStandardBrowserWebWorkerEnv","origin","platform","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","stringifySafely","rawValue","parser","defaults","headers","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","method","ignoreDuplicateOf","parseHeaders","rawHeaders","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg1","arg2","arg3","AxiosHeaders$1","valueOrRewrite","rewrite","self","setHeader","_value","_header","_rewrite","lHeader","setHeaders","dest","entry","matcher","deleteHeader","format","normalized","targets","asStrings","first","accessors","defineAccessor","AxiosHeaders","mapped","headerValue","transformData","fns","isCancel","CanceledError","settle","reject","validateStatus","parseProtocol","speedometer","samplesCount","min","timestamps","head","tail","firstSampleTS","chunkLength","now","startedAt","bytesCount","passed","throttle","freq","threshold","lastArgs","timer","invoke","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","loaded","total","progressBytes","rate","inRange","progressEventDecorator","throttled","lengthComputable","asyncDecorator","isURLSameOrigin","isMSIE","cookies","expires","domain","secure","sameSite","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","allowAbsoluteUrls","isRelativeUrl","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","resolveConfig","newConfig","withXSRFToken","xsrfHeaderName","xsrfCookieName","auth","formHeaders","allowedHeaders","xsrfValue","isXHRAdapterSupported","xhrAdapter","_config","requestData","requestHeaders","responseType","onUploadProgress","onDownloadProgress","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","done","onloadend","responseHeaders","timeoutErrorMessage","cancel","protocol","composeSignals","signals","timeout","length","controller","aborted","onabort","reason","unsubscribe","signal","streamChunk","chunk","chunkSize","pos","end","readBytes","iterable","readStream","stream","reader","trackStream","onProgress","onFinish","_onFinish","loadedBytes","DEFAULT_CHUNK_SIZE","globalFetchAPI","Request","Response","ReadableStream","TextEncoder","test","factory","env","envFetch","isFetchSupported","isRequestSupported","isResponseSupported","isReadableStreamSupported","encodeText","supportsRequestStream","duplexAccessed","hasContentType","supportsResponseStream","resolvers","res","getBodyLength","body","resolveBodyLength","cancelToken","withCredentials","fetchOptions","_fetch","composedSignal","requestContentLength","_request","contentTypeHeader","flush","isCredentialsSupported","resolvedOptions","isStreamResponse","responseContentLength","responseData","seedCache","getFetch","fetch","seeds","seed","map","knownAdapters","fetchAdapter.getFetch","renderReason","isResolvedHandle","adapter","getAdapter","adapters","nameOrAdapter","rejectedReasons","reasons","state","s","throwIfCancellationRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","desc","opts","correctSpelling","assertOptions","schema","allowUnknown","Axios$1","instanceConfig","configOrUrl","dummy","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","onFulfilled","onRejected","fullPath","Axios","generateHTTPMethod","isForm","CancelToken$1","CancelToken","executor","resolvePromise","onfulfilled","_resolve","abort","c","spread","callback","isAxiosError","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","all","Cancel","formToJSON","ConfigApiService","filteredSelectedToolIds","toolId","newFilteredTools","selectedLength","getToolDisplayNameWithGroup","getToolDescription","title","showAddButton","addButtonText","useGridLayout","emptyText","visible","sortBy","collapsedGroups","selectedTools","updateGroupCheckboxState","groupName","checkbox","isGroupPartiallySelected","newIds","filtered","aSelected","bSelected","groupA","groupB","groupedTools","groups","totalTools","isToolSelected","toolKey","toggleToolSelection","isChecked","getSelectedToolsInGroup","isGroupFullySelected","selectedCount","toggleGroupSelection","toolKeys","newSelected","toggleGroupCollapse","handleConfirm","groupNames","compatibleProps","planTypeError","titleError","availableModels","isLoadingModels","modelsLoadError","modelSearchFilters","openDropdownSteps","highlightedIndices","getSearchFilter","setSearchFilter","getFilteredModelsForStep","searchTerm","model","getModelDisplayValue","getModelPlaceholder","isModelDropdownOpenForStep","openModelDropdown","closeModelDropdown","toggleModelDropdown","selectModelForStep","modelName","handleModelSearchInput","getHighlightedIndex","setHighlightedIndex","selectFirstFilteredModel","highlightedIndex","navigateModelDown","totalItems","currentIndex","newIndex","navigateModelUp","handleClickOutside","newSteps","showToolModal","currentStepIndex","loadAvailableModels","showToolSelectionModal","handleToolSelectionConfirm","selectedToolIds","handleToolsFiltered","handleCopyPlan","initializeParsedData","newData","formatTableHeader","terminateColumns","columns","col","_withKeys","AssignedTools","ToolSelectionModal","searchKeyword","sidebarWidth","isResizing","startX","startWidth","executionControllerRef","currentToolInfo","templateToolInfo","publishMcpModalRef","coordinatorToolConfig","loadCoordinatorToolConfig","handleSaveTemplate","refreshParameterRequirements","handleSaveBeforeExecute","planData","finalPlanData","finalPayload","showPublishMcpModal","showCopyPlanModal","newPlanTitle","isCopyingPlan","handleMcpServicePublished","loadAllTemplateToolInfo","handleClearExecutionParams","handleUpdateExecutionParams","closeCopyPlanModal","confirmCopyPlan","newPlan","__vitePreload","n","typedResult","loadToolInfo","toolData","handleOrganizationChange","getRelativeTimeString","date","diffMs","diffMinutes","diffHours","diffDays","getTaskPreviewText","template","filteredGroupedTemplates","keyword","templates","matchingTemplates","preview","newKeyword","hasMatch","startResize","handleMouseMove","handleMouseUp","containerWidth","deltaPercent","newWidth","resetSidebarWidth","newPlanTemplateId","savedWidth","JsonEditorV2","JsonEditor","ExecutionController","PublishServiceModal","route","useRoute","router","useRouter","useMessage","prompt","inputOnlyContent","rightPanelRef","chatRef","sidebarRef","currentRootPlanId","leftPanelWidth","startLeftWidth","computedLeftPanelWidth","maxAvailableWidth","shouldProcessEventForCurrentPlan","freshDetails","handleInputClear","handleInputUpdateState","taskContent","handleChatSendMessage","taskToInput","handlePlanExecutionRequested","newTask","newPrompt","oldPrompt","newTaskToInput","resetPanelSize","allowSpecialIds","assistantMessage","userMessage","typedResponse","handleSendMessage","handleInputFocus","handleSubPlanStepSelected","parentPlanId","subPlanId","subStepIndex","handlePlanModeClicked","goBack","handleConfig","userMessageAdded","messageError","executionResponse","errorStack","errorHandlingError","memorySelected","newChat","Sidebar","LanguageSwitcher","ChatContainer","InputArea","$i18n","RightPanel","Memory"],"ignoreList":[31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],"sources":["../../src/api/common-api-service.ts","../../src/components/chat/composables/useMessageFormatting.ts","../../src/components/chat/UserMessage.vue","../../src/components/chat/RecursiveSubPlan.vue","../../src/components/chat/ExecutionDetails.vue","../../src/components/chat/ThinkingSection.vue","../../src/components/chat/UserInputForm.vue","../../src/components/chat/ResponseSection.vue","../../src/components/chat/AssistantMessage.vue","../../src/components/chat/ChatMessage.vue","../../src/components/chat/composables/useChatMessages.ts","../../src/components/chat/composables/useScrollBehavior.ts","../../src/utils/plan-execution-manager.ts","../../src/components/chat/ChatContainer.vue","../../src/api/file-upload-api-service.ts","../../src/components/file-upload/FileUploadComponent.vue","../../src/stores/memory.ts","../../src/components/input/InputArea.vue","../../src/api/memory-api-service.ts","../../src/components/memory/Memory.vue","../../src/api/agent-execution.ts","../../src/api/file-browser-api-service.ts","../../src/components/file-browser/FileTreeNode.vue","../../src/components/file-browser/index.vue","../../src/components/right-panel/RightPanel.vue","../../src/api/plan-parameter-api-service.ts","../../src/components/publish-service-modal/PublishServiceModal.vue","../../src/components/sidebar/SaveConfirmationDialog.vue","../../src/components/sidebar/ExecutionController.vue","../../src/components/sidebar/json-editor-logic.ts","../../src/components/sidebar/JsonEditor.vue","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/bind.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/utils.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/AxiosError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/null.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/toFormData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/buildURL.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/InterceptorManager.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/defaults/transitional.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/FormData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/Blob.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/common/utils.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/toURLEncodedForm.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/formDataToJSON.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/defaults/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/parseHeaders.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/AxiosHeaders.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/transformData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/isCancel.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/CanceledError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/settle.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/parseProtocol.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/speedometer.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/throttle.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/progressEventReducer.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isURLSameOrigin.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/cookies.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isAbsoluteURL.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/combineURLs.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/buildFullPath.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/mergeConfig.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/resolveConfig.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/xhr.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/composeSignals.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/trackStream.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/fetch.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/adapters.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/dispatchRequest.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/env/data.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/validator.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/Axios.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/CancelToken.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/spread.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isAxiosError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/HttpStatusCode.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/axios.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/index.js","../../src/api/config-api-service.ts","../../src/components/shared/AssignedTools.vue","../../src/components/tool-selection-modal/ToolSelectionModal.vue","../../src/components/sidebar/JsonEditorV2.vue","../../src/components/sidebar/Sidebar.vue","../../src/views/direct/index.vue"],"sourcesContent":["/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Common request methods (TypeScript version, suitable for Vue projects)\n\nimport type { PlanExecutionRecordResponse } from '@/types/plan-execution-record'\n\nexport class CommonApiService {\n  private static readonly BASE_URL = '/api/executor'\n\n  // Get detailed execution records\n  public static async getDetails(planId: string): Promise<PlanExecutionRecordResponse> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/details/${planId}`)\n      if (response.status === 404) {\n        // 404 returns null\n        return null\n      }\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`Failed to get detailed information: ${response.status} - ${errorText}`)\n      }\n      const rawText = await response.text()\n      const data = JSON.parse(rawText)\n\n      // Type validation - ensure the response contains required currentPlanId\n      if (data && typeof data === 'object' && !data.currentPlanId) {\n        // If currentPlanId is missing from response, add it from the parameter\n        data.currentPlanId = planId\n      }\n\n      return data\n    } catch (error: unknown) {\n      // Log error but don't throw exception\n      console.error('[CommonApiService] Failed to get plan details:', error)\n      // Don't return failed status for network errors - let polling continue\n      // Only return null to indicate no data available\n      return null\n    }\n  }\n\n  // Submit user form input\n  public static async submitFormInput(\n    planId: string,\n    formData: Record<string, unknown>\n  ): Promise<Record<string, unknown>> {\n    const response = await fetch(`${this.BASE_URL}/submit-input/${planId}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(formData),\n    })\n    if (!response.ok) {\n      let errorData\n      try {\n        errorData = await response.json()\n      } catch {\n        errorData = { message: `Failed to submit form input: ${response.status}` }\n      }\n      throw new Error(errorData.message || `Failed to submit form input: ${response.status}`)\n    }\n    const contentType = response.headers.get('content-type')\n    if (contentType && contentType.indexOf('application/json') !== -1) {\n      return await response.json()\n    }\n    return { success: true }\n  }\n\n  /**\n   * Get all Prompt list\n   */\n  static async getAllPrompts(): Promise<unknown[]> {\n    try {\n      const response = await fetch(this.BASE_URL)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get Prompt list:', error)\n      throw error\n    }\n  }\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { computed } from 'vue'\nimport type { ChatMessage } from './useChatMessages'\n\n/**\n * Message formatting utilities\n */\nexport function useMessageFormatting() {\n  /**\n   * Format response text with markdown and code highlighting\n   */\n  const formatResponseText = (text: string): string => {\n    if (!text) return ''\n\n    return text\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`([^`]+)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>')\n      .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n  }\n\n  /**\n   * Format timestamp for display\n   */\n  const formatTimestamp = (timestamp: Date): string => {\n    const now = new Date()\n    const diff = now.getTime() - timestamp.getTime()\n\n    // Less than 1 minute\n    if (diff < 60000) {\n      return 'Just now'\n    }\n\n    // Less than 1 hour\n    if (diff < 3600000) {\n      const minutes = Math.floor(diff / 60000)\n      return `${minutes} minutes ago`\n    }\n\n    // Less than 1 day\n    if (diff < 86400000) {\n      const hours = Math.floor(diff / 3600000)\n      return `${hours} hours ago`\n    }\n\n    // More than 1 day\n    return timestamp.toLocaleDateString('zh-CN', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    })\n  }\n\n  /**\n   * Get message CSS classes\n   */\n  const getMessageClasses = (message: ChatMessage) => {\n    return computed(() => ({\n      user: message.type === 'user',\n      assistant: message.type === 'assistant',\n      streaming: message.isStreaming,\n      'has-error': !!message.error,\n      'has-thinking': !!message.thinking,\n      'has-execution': !!message.planExecution,\n    }))\n  }\n\n  /**\n   * Format file size for attachments\n   */\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 B'\n\n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n  }\n\n  /**\n   * Truncate long text with ellipsis\n   */\n  const truncateText = (text: string, maxLength: number = 100): string => {\n    if (!text || text.length <= maxLength) return text\n    return text.substring(0, maxLength) + '...'\n  }\n\n  /**\n   * Extract plain text from HTML\n   */\n  const stripHtml = (html: string): string => {\n    return html.replace(/<[^>]*>/g, '')\n  }\n\n  /**\n   * Check if message has content to display\n   */\n  const hasDisplayableContent = (message: ChatMessage): boolean => {\n    return !!(\n      message.content ||\n      (message.thinking ?? false) ||\n      (message.planExecution ?? false) ||\n      message.error\n    )\n  }\n\n  /**\n   * Get message status text\n   */\n  const getMessageStatus = (message: ChatMessage): string => {\n    if (message.error) return 'Send failed'\n    if (message.isStreaming) return 'Typing...'\n    if (message.type === 'assistant' && !message.content && !message.thinking)\n      return 'Waiting for response'\n    return ''\n  }\n\n  return {\n    formatResponseText,\n    formatTimestamp,\n    getMessageClasses,\n    formatFileSize,\n    truncateText,\n    stripHtml,\n    hasDisplayableContent,\n    getMessageStatus,\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-message\" :data-message-id=\"message.id\">\n    <div class=\"user-content\">\n      <div class=\"message-text\">\n        {{ message.content }}\n      </div>\n\n      <!-- Attachments if any -->\n      <div v-if=\"message.attachments?.length\" class=\"attachments\">\n        <div\n          v-for=\"(attachment, index) in message.attachments\"\n          :key=\"index\"\n          class=\"attachment-item\"\n        >\n          <Icon icon=\"carbon:document\" class=\"attachment-icon\" />\n          <span class=\"attachment-name\">{{ attachment.name }}</span>\n          <span class=\"attachment-size\">{{ formatFileSize(attachment.size) }}</span>\n        </div>\n      </div>\n\n      <!-- Timestamp -->\n      <div class=\"message-timestamp\">\n        {{ formatTimestamp(message.timestamp) }}\n      </div>\n    </div>\n\n    <!-- Message status indicator -->\n    <div v-if=\"message.error\" class=\"message-status error\">\n      <Icon icon=\"carbon:warning\" class=\"status-icon\" />\n      <span class=\"status-text\">{{ message.error }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n}\n\ndefineProps<Props>()\n\nconst { formatTimestamp, formatFileSize } = useMessageFormatting()\n</script>\n\n<style lang=\"less\" scoped>\n.user-message {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  margin-bottom: 16px;\n\n  .user-content {\n    max-width: 70%;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    padding: 12px 16px;\n    border-radius: 18px 18px 4px 18px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    position: relative;\n\n    .message-text {\n      word-wrap: break-word;\n      white-space: pre-wrap;\n      line-height: 1.5;\n      font-size: 14px;\n    }\n\n    .attachments {\n      margin-top: 8px;\n\n      .attachment-item {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding: 6px 8px;\n        background: rgba(255, 255, 255, 0.1);\n        border-radius: 8px;\n        margin-bottom: 4px;\n        font-size: 12px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n\n        .attachment-icon {\n          font-size: 14px;\n          color: rgba(255, 255, 255, 0.8);\n        }\n\n        .attachment-name {\n          flex: 1;\n          color: #ffffff;\n        }\n\n        .attachment-size {\n          color: rgba(255, 255, 255, 0.7);\n          font-size: 11px;\n        }\n      }\n    }\n\n    .message-timestamp {\n      margin-top: 6px;\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.7);\n      text-align: right;\n    }\n  }\n\n  .message-status {\n    margin-top: 4px;\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    font-size: 12px;\n\n    &.error {\n      color: #ff6b6b;\n\n      .status-icon {\n        font-size: 14px;\n      }\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .user-message {\n    .user-content {\n      max-width: 85%;\n      padding: 10px 14px;\n      border-radius: 16px 16px 4px 16px;\n\n      .message-text {\n        font-size: 13px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"recursive-sub-plan\" :class=\"getNestingClass()\">\n    <!-- Sub-plan header -->\n    <div class=\"sub-plan-header\" @click=\"handleSubPlanClick\">\n      <div class=\"sub-plan-info\">\n        <Icon :icon=\"getSubPlanStatusIcon()\" class=\"sub-plan-status-icon\" />\n        <div class=\"sub-plan-details\">\n          <div class=\"sub-plan-title\">\n            {{ subPlan.title || $t('chat.subPlan') }} #{{ subPlanIndex + 1 }}\n            <span v-if=\"(nestingLevel ?? 0) > 0\" class=\"nesting-level\"\n              >(L{{ (nestingLevel ?? 0) + 1 }})</span\n            >\n          </div>\n          <div class=\"sub-plan-id\">{{ subPlan.currentPlanId }}</div>\n        </div>\n      </div>\n      <div class=\"sub-plan-meta\">\n        <div class=\"sub-plan-status-badge\" :class=\"getSubPlanStatusClass()\">\n          {{ getSubPlanStatusText() }}\n        </div>\n        <div v-if=\"subPlan.parentActToolCall\" class=\"trigger-tool\">\n          <Icon icon=\"carbon:function\" class=\"trigger-icon\" />\n          <span class=\"trigger-text\">{{ subPlan.parentActToolCall.name }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan progress -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-progress\">\n      <div class=\"progress-info\">\n        <span class=\"progress-text\">\n          {{ $t('chat.progress') }}: {{ getSubPlanCompletedCount() }} /\n          {{ subPlan.agentExecutionSequence.length }}\n        </span>\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" :style=\"{ width: getSubPlanProgress() + '%' }\"></div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan agent execution steps -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-agents-steps\">\n      <div class=\"agents-steps-header\">\n        <span class=\"agents-label\">{{ $t('chat.agentExecutions') }}:</span>\n      </div>\n      <div class=\"agents-steps-list\">\n        <div\n          v-for=\"(agent, agentIndex) in subPlan.agentExecutionSequence\"\n          :key=\"agent.id || agentIndex\"\n          class=\"agent-step-item\"\n          :class=\"getAgentPreviewStatusClass(agent.status)\"\n          @click=\"handleSubPlanAgentClick(agentIndex, agent)\"\n        >\n          <div class=\"agent-step-header\">\n            <Icon :icon=\"getAgentPreviewStatusIcon(agent.status)\" class=\"agent-icon\" />\n            <span class=\"agent-name\">{{ agent.agentName || $t('chat.unknownAgent') }}</span>\n            <div class=\"agent-status-badge\" :class=\"getAgentPreviewStatusClass(agent.status)\">\n              {{ getAgentStatusText(agent.status) }}\n            </div>\n          </div>\n\n          <!-- Agent execution info for sub-plan agents -->\n          <div class=\"sub-agent-execution-info\">\n            <!-- Agent result -->\n            <div v-if=\"agent.result\" class=\"agent-result\">\n              <div class=\"result-header\">\n                <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n                <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n              </div>\n              <pre class=\"result-content\">{{ agent.result }}</pre>\n            </div>\n\n            <!-- Error message -->\n            <div v-if=\"agent.errorMessage\" class=\"agent-error\">\n              <div class=\"error-header\">\n                <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n                <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n              </div>\n              <pre class=\"error-content\">{{ agent.errorMessage }}</pre>\n            </div>\n\n            <!-- Think-act steps with nested sub-plans -->\n            <div v-if=\"agent.thinkActSteps?.length\" class=\"think-act-preview\">\n              <div class=\"think-act-header\">\n                <Icon icon=\"carbon:thinking\" class=\"think-act-icon\" />\n                <span class=\"think-act-label\"\n                  >{{ $t('chat.thinkActSteps') }} ({{ agent.thinkActSteps.length }})</span\n                >\n              </div>\n              <div class=\"think-act-steps-preview\">\n                <div\n                  v-for=\"(step, stepIndex) in agent.thinkActSteps.slice(0, maxVisibleSteps ?? 2)\"\n                  :key=\"step.id || stepIndex\"\n                  class=\"think-act-step-preview\"\n                  @click.stop=\"handleThinkActStepClick(agentIndex, stepIndex, agent)\"\n                >\n                  <span class=\"step-number\">#{{ stepIndex + 1 }}</span>\n                  <span class=\"step-description\">{{\n                    step.actionDescription || $t('chat.thinking')\n                  }}</span>\n                  <Icon icon=\"carbon:arrow-right\" class=\"step-arrow\" />\n                </div>\n                <div v-if=\"agent.thinkActSteps.length > (maxVisibleSteps ?? 2)\" class=\"more-steps\">\n                  <span class=\"more-steps-text\">\n                    {{\n                      $t('chat.andMoreSteps', {\n                        count: agent.thinkActSteps.length - (maxVisibleSteps ?? 2),\n                      })\n                    }}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <!-- Nested sub-plans from think-act steps -->\n            <div v-if=\"hasNestedSubPlans(agent)\" class=\"nested-sub-plans\">\n              <div class=\"nested-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view-alt\" class=\"nested-icon\" />\n                <span class=\"nested-label\">{{ $t('chat.nestedSubPlans') }}</span>\n              </div>\n              <div class=\"nested-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(nestedStep, nestedStepIndex) in getNestedSubPlans(agent)\"\n                  :key=\"nestedStep.id || nestedStepIndex\"\n                  :sub-plan=\"nestedStep.subPlanExecutionRecord!\"\n                  :sub-plan-index=\"nestedStepIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n\n            <!-- Direct sub-plans from agent -->\n            <div v-if=\"agent.subPlanExecutionRecords?.length\" class=\"direct-sub-plans\">\n              <div class=\"direct-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view\" class=\"direct-icon\" />\n                <span class=\"direct-label\">{{ $t('chat.directSubPlans') }}</span>\n              </div>\n              <div class=\"direct-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(directSubPlan, directIndex) in agent.subPlanExecutionRecords\"\n                  :key=\"directSubPlan.currentPlanId || directIndex\"\n                  :sub-plan=\"directSubPlan\"\n                  :sub-plan-index=\"directIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {} from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type {\n  PlanExecutionRecord,\n  AgentExecutionRecord,\n  ExecutionStatus,\n  ThinkActRecord,\n} from '@/types/plan-execution-record'\n\ninterface Props {\n  subPlan: PlanExecutionRecord\n  subPlanIndex: number\n  nestingLevel?: number\n  maxNestingDepth?: number\n  maxVisibleSteps?: number\n}\n\ninterface Emits {\n  (\n    e: 'sub-plan-selected',\n    agentIndex: number,\n    subPlanIndex: number,\n    subPlan: PlanExecutionRecord\n  ): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  nestingLevel: 0,\n  maxNestingDepth: 3,\n  maxVisibleSteps: 2,\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Helper functions\nconst getNestingClass = (): string => {\n  return `nesting-level-${props.nestingLevel}`\n}\n\n// Sub-plan status methods\nconst getSubPlanStatusClass = (): string => {\n  if (props.subPlan.completed) {\n    return 'completed'\n  }\n\n  const hasRunningAgent = props.subPlan.agentExecutionSequence?.some(\n    agent => agent.status === 'RUNNING'\n  )\n  if (hasRunningAgent) {\n    return 'running'\n  }\n\n  const hasFinishedAgent = props.subPlan.agentExecutionSequence?.some(\n    agent => agent.status === 'FINISHED'\n  )\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n\n  return 'pending'\n}\n\nconst getSubPlanStatusText = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\nconst getSubPlanStatusIcon = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return 'carbon:checkmark'\n    case 'running':\n      return 'carbon:play'\n    case 'in-progress':\n      return 'carbon:in-progress'\n    case 'pending':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getSubPlanProgress = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  if (props.subPlan.completed) return 100\n\n  const completedCount = getSubPlanCompletedCount()\n  return Math.min(100, (completedCount / props.subPlan.agentExecutionSequence.length) * 100)\n}\n\nconst getSubPlanCompletedCount = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  return props.subPlan.agentExecutionSequence.filter(agent => agent.status === 'FINISHED').length\n}\n\n// Agent preview status methods\nconst getAgentPreviewStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'completed'\n    case 'RUNNING':\n      return 'running'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentPreviewStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\n// Nested sub-plans detection\nconst hasNestedSubPlans = (agent: AgentExecutionRecord): boolean => {\n  return agent.thinkActSteps?.some(step => step.subPlanExecutionRecord) ?? false\n}\n\nconst getNestedSubPlans = (agent: AgentExecutionRecord): ThinkActRecord[] => {\n  return agent.thinkActSteps?.filter(step => step.subPlanExecutionRecord) ?? []\n}\n\n// Event handlers\nconst handleSubPlanClick = () => {\n  emit('sub-plan-selected', -1, props.subPlanIndex, props.subPlan)\n}\n\nconst handleSubPlanAgentClick = (agentIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleThinkActStepClick = (\n  agentIndex: number,\n  _stepIndex: number,\n  agent: AgentExecutionRecord\n) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleNestedSubPlanSelected = (\n  agentIndex: number,\n  subPlanIndex: number,\n  subPlan: PlanExecutionRecord\n) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleNestedStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.recursive-sub-plan {\n  background: rgba(102, 126, 234, 0.05);\n  border: 1px solid rgba(102, 126, 234, 0.1);\n  border-radius: 6px;\n  padding: 12px;\n  margin-bottom: 8px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    border-color: rgba(102, 126, 234, 0.2);\n  }\n\n  &.running {\n    border-color: rgba(102, 126, 234, 0.3);\n    background: rgba(102, 126, 234, 0.08);\n    box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n  }\n\n  &.completed {\n    border-color: rgba(34, 197, 94, 0.3);\n    background: rgba(34, 197, 94, 0.05);\n  }\n\n  &.pending {\n    opacity: 0.7;\n  }\n\n  // Nesting level styles\n  &.nesting-level-1 {\n    margin-left: 16px;\n    border-left: 3px solid rgba(102, 126, 234, 0.3);\n  }\n\n  &.nesting-level-2 {\n    margin-left: 32px;\n    border-left: 3px solid rgba(251, 191, 36, 0.3);\n  }\n\n  &.nesting-level-3 {\n    margin-left: 48px;\n    border-left: 3px solid rgba(34, 197, 94, 0.3);\n  }\n\n  .sub-plan-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n    cursor: pointer;\n\n    .sub-plan-info {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      flex: 1;\n\n      .sub-plan-status-icon {\n        font-size: 16px;\n\n        &.completed {\n          color: #22c55e;\n        }\n\n        &.running {\n          color: #667eea;\n        }\n\n        &.in-progress {\n          color: #fbbf24;\n        }\n\n        &.pending {\n          color: #9ca3af;\n        }\n      }\n\n      .sub-plan-details {\n        .sub-plan-title {\n          font-weight: 600;\n          color: #ffffff;\n          font-size: 13px;\n          margin-bottom: 2px;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n\n          .nesting-level {\n            color: #888888;\n            font-size: 10px;\n            font-weight: 400;\n            background: rgba(136, 136, 136, 0.2);\n            padding: 1px 4px;\n            border-radius: 3px;\n          }\n        }\n\n        .sub-plan-id {\n          color: #aaaaaa;\n          font-size: 11px;\n          font-family: monospace;\n        }\n      }\n    }\n\n    .sub-plan-meta {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n\n      .trigger-tool {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n        padding: 2px 6px;\n        background: rgba(102, 126, 234, 0.1);\n        border-radius: 4px;\n        font-size: 10px;\n\n        .trigger-icon {\n          font-size: 10px;\n          color: #667eea;\n        }\n\n        .trigger-text {\n          color: #cccccc;\n          font-weight: 500;\n        }\n      }\n    }\n\n    .sub-plan-status-badge {\n      padding: 2px 6px;\n      border-radius: 8px;\n      font-size: 10px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(34, 197, 94, 0.2);\n        color: #22c55e;\n      }\n\n      &.running {\n        background: rgba(102, 126, 234, 0.2);\n        color: #667eea;\n      }\n\n      &.in-progress {\n        background: rgba(251, 191, 36, 0.2);\n        color: #fbbf24;\n      }\n\n      &.pending {\n        background: rgba(156, 163, 175, 0.2);\n        color: #9ca3af;\n      }\n    }\n  }\n\n  .sub-plan-progress {\n    margin-bottom: 8px;\n\n    .progress-info {\n      .progress-text {\n        color: #aaaaaa;\n        font-size: 10px;\n        margin-bottom: 4px;\n      }\n\n      .progress-bar {\n        background: rgba(0, 0, 0, 0.2);\n        border-radius: 4px;\n        height: 4px;\n        overflow: hidden;\n\n        .progress-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #667eea, #764ba2);\n          transition: width 0.3s ease;\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .sub-plan-agents-steps {\n    .agents-steps-header {\n      color: #aaaaaa;\n      font-size: 11px;\n      margin-bottom: 6px;\n      font-weight: 500;\n    }\n\n    .agents-steps-list {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n\n      .agent-step-item {\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 6px;\n        padding: 8px;\n        background: rgba(0, 0, 0, 0.05);\n        cursor: pointer;\n        transition: all 0.2s;\n\n        &:hover {\n          background: rgba(0, 0, 0, 0.1);\n          border-color: rgba(255, 255, 255, 0.2);\n        }\n\n        &.completed {\n          border-color: rgba(34, 197, 94, 0.3);\n          background: rgba(34, 197, 94, 0.05);\n        }\n\n        &.running {\n          border-color: rgba(102, 126, 234, 0.3);\n          background: rgba(102, 126, 234, 0.08);\n        }\n\n        &.pending {\n          opacity: 0.7;\n        }\n\n        .agent-step-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n\n          .agent-icon {\n            font-size: 14px;\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-name {\n            color: #ffffff;\n            font-size: 13px;\n            font-weight: 500;\n            flex: 1;\n          }\n\n          .agent-status-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            font-weight: 500;\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n        }\n\n        .sub-agent-execution-info {\n          margin-left: 22px;\n\n          .agent-result,\n          .agent-error {\n            margin-bottom: 8px;\n\n            &:last-child {\n              margin-bottom: 0;\n            }\n\n            .result-header,\n            .error-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 4px;\n\n              .result-icon,\n              .error-icon {\n                font-size: 12px;\n              }\n\n              .result-icon {\n                color: #22c55e;\n              }\n\n              .error-icon {\n                color: #ef4444;\n              }\n\n              .result-label,\n              .error-label {\n                color: #ffffff;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .result-content,\n            .error-content {\n              margin: 0;\n              padding: 6px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 3px;\n              font-family: monospace;\n              font-size: 10px;\n              white-space: pre-wrap;\n              max-height: 80px;\n              overflow-y: auto;\n              color: #cccccc;\n              line-height: 1.3;\n            }\n          }\n\n          .think-act-preview {\n            margin-top: 8px;\n\n            .think-act-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 6px;\n\n              .think-act-icon {\n                font-size: 12px;\n                color: #667eea;\n              }\n\n              .think-act-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .think-act-steps-preview {\n              display: flex;\n              flex-direction: column;\n              gap: 3px;\n\n              .think-act-step-preview {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                padding: 4px 6px;\n                background: rgba(0, 0, 0, 0.1);\n                border-radius: 3px;\n                cursor: pointer;\n                transition: all 0.2s;\n                font-size: 10px;\n\n                &:hover {\n                  background: rgba(0, 0, 0, 0.2);\n                }\n\n                .step-number {\n                  color: #667eea;\n                  font-weight: 500;\n                  min-width: 20px;\n                }\n\n                .step-description {\n                  color: #cccccc;\n                  flex: 1;\n                  white-space: nowrap;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                }\n\n                .step-arrow {\n                  font-size: 10px;\n                  color: #888888;\n                }\n              }\n\n              .more-steps {\n                padding: 2px 6px;\n                color: #888888;\n                font-size: 9px;\n                font-style: italic;\n              }\n            }\n          }\n\n          .nested-sub-plans,\n          .direct-sub-plans {\n            margin-top: 12px;\n\n            .nested-sub-plans-header,\n            .direct-sub-plans-header {\n              display: flex;\n              align-items: center;\n              gap: 6px;\n              margin-bottom: 8px;\n\n              .nested-icon,\n              .direct-icon {\n                font-size: 12px;\n                color: #fbbf24;\n              }\n\n              .nested-label,\n              .direct-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .nested-sub-plans-list,\n            .direct-sub-plans-list {\n              display: flex;\n              flex-direction: column;\n              gap: 6px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"execution-details\">\n    <!-- Plan overview -->\n    <div class=\"plan-overview\" v-if=\"planExecution\">\n      <div class=\"plan-header\">\n        <h3 class=\"plan-title\">{{ planExecution.title || $t('chat.planExecution') }}</h3>\n        <div class=\"plan-status-badge\" :class=\"getPlanStatusClass()\">\n          {{ getPlanStatusText() }}\n        </div>\n      </div>\n\n      <!-- Parent tool call information for sub-plans -->\n      <div v-if=\"planExecution.parentActToolCall\" class=\"parent-tool-call\">\n        <div class=\"parent-tool-header\">\n          <Icon icon=\"carbon:flow\" class=\"tool-icon\" />\n          <span class=\"tool-label\">{{ $t('chat.triggeredByTool') }}:</span>\n          <span class=\"tool-name\">{{ planExecution.parentActToolCall.name }}</span>\n        </div>\n        <div v-if=\"planExecution.parentActToolCall.parameters\" class=\"tool-parameters\">\n          <span class=\"param-label\">{{ $t('common.parameters') }}:</span>\n          <pre class=\"param-content\">{{\n            formatToolParameters(planExecution.parentActToolCall.parameters)\n          }}</pre>\n        </div>\n      </div>\n    </div>\n\n    <!-- Agent execution sequence -->\n    <div\n      class=\"agent-execution-container\"\n      v-if=\"(planExecution?.agentExecutionSequence?.length ?? 0) > 0\"\n    >\n      <h4 class=\"section-title\">{{ $t('chat.agentExecutionSequence') }}</h4>\n\n      <div\n        v-for=\"(agentExecution, agentIndex) in planExecution?.agentExecutionSequence\"\n        :key=\"agentExecution.id || agentIndex\"\n        class=\"agent-execution-item\"\n        :class=\"getAgentStatusClass(agentExecution.status)\"\n      >\n        <!-- Agent execution header -->\n        <div class=\"agent-header\" @click=\"handleAgentClick(agentExecution)\">\n          <div class=\"agent-info\">\n            <Icon :icon=\"getAgentStatusIcon(agentExecution.status)\" class=\"agent-status-icon\" />\n            <div class=\"agent-details\">\n              <div class=\"agent-name\">\n                {{ agentExecution.agentName || $t('chat.unknownAgent') }}\n              </div>\n              <pre class=\"request-content\">{{ agentExecution.agentRequest }}</pre>\n            </div>\n          </div>\n          <div class=\"agent-controls\">\n            <div class=\"agent-status-badge\" :class=\"getAgentStatusClass(agentExecution.status)\">\n              {{ getAgentStatusText(agentExecution.status) }}\n            </div>\n            <Icon icon=\"carbon:arrow-right\" class=\"step-select-icon\" />\n          </div>\n        </div>\n\n        <!-- Agent execution info -->\n        <div class=\"agent-execution-info\">\n          <!-- Agent result -->\n          <div v-if=\"agentExecution.result\" class=\"agent-result\">\n            <div class=\"result-header\">\n              <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n              <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n            </div>\n            <pre class=\"result-content\">{{ agentExecution.result }}</pre>\n          </div>\n\n          <!-- Error message -->\n          <div v-if=\"agentExecution.errorMessage\" class=\"agent-error\">\n            <div class=\"error-header\">\n              <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n              <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n            </div>\n            <pre class=\"error-content\">{{ agentExecution.errorMessage }}</pre>\n          </div>\n        </div>\n\n        <!-- Sub-plan executions with nested support -->\n        <div v-if=\"agentExecution.subPlanExecutionRecords?.length\" class=\"sub-plans-container\">\n          <div class=\"sub-plans-header\">\n            <Icon icon=\"carbon:tree-view\" class=\"sub-plans-icon\" />\n            <span class=\"sub-plans-title\">\n              {{ $t('chat.subPlanExecutions') }} ({{\n                agentExecution.subPlanExecutionRecords.length\n              }})\n            </span>\n          </div>\n\n          <div class=\"sub-plans-list\">\n            <RecursiveSubPlan\n              v-for=\"(subPlan, subPlanIndex) in agentExecution.subPlanExecutionRecords\"\n              :key=\"subPlan.currentPlanId || subPlanIndex\"\n              :sub-plan=\"subPlan\"\n              :sub-plan-index=\"subPlanIndex\"\n              :nesting-level=\"0\"\n              :max-nesting-depth=\"3\"\n              :max-visible-steps=\"2\"\n              @sub-plan-selected=\"handleSubPlanClick\"\n              @step-selected=\"handleStepSelected\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type {\n  PlanExecutionRecord,\n  AgentExecutionRecord,\n  ExecutionStatus,\n} from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\nimport RecursiveSubPlan from './RecursiveSubPlan.vue'\n\ninterface Props {\n  planExecution: CompatiblePlanExecutionRecord\n}\n\ninterface Emits {\n  (\n    e: 'sub-plan-selected',\n    agentIndex: number,\n    subPlanIndex: number,\n    subPlan: PlanExecutionRecord\n  ): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Computed properties\nconst agentExecutionSequence = computed(() => props.planExecution.agentExecutionSequence ?? [])\n\n// Agent click handler\nconst handleAgentClick = (agentExecution: AgentExecutionRecord) => {\n  if (agentExecution.stepId) {\n    emit('step-selected', agentExecution.stepId)\n  } else {\n    console.warn('[ExecutionDetails] Agent execution has no stepId:', agentExecution)\n  }\n}\n\n// Plan status methods\nconst getPlanStatusClass = (): string => {\n  if (props.planExecution.completed) {\n    return 'completed'\n  }\n\n  const hasRunningAgent = agentExecutionSequence.value.some(agent => agent.status === 'RUNNING')\n  if (hasRunningAgent) {\n    return 'running'\n  }\n\n  const hasFinishedAgent = agentExecutionSequence.value.some(agent => agent.status === 'FINISHED')\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n\n  return 'pending'\n}\n\nconst getPlanStatusText = (): string => {\n  const statusClass = getPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\n// Agent status methods\nconst getAgentStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'running'\n    case 'FINISHED':\n      return 'completed'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\nconst getAgentStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\n// Note: Sub-plan status methods are now handled by RecursiveSubPlan component\n\n// Note: Agent preview status methods are now handled by RecursiveSubPlan component\n\n// Event handlers\nconst handleSubPlanClick = (\n  agentIndex: number,\n  subPlanIndex: number,\n  subPlan: PlanExecutionRecord\n) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n\n// Note: Sub-plan agent and think-act step handling is now done by RecursiveSubPlan component\n\n// Helper methods\n\nconst formatToolParameters = (parameters?: string): string => {\n  if (!parameters) return ''\n\n  try {\n    const parsed = JSON.parse(parameters)\n    return JSON.stringify(parsed, null, 2)\n  } catch {\n    return parameters\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.execution-details {\n  // Plan overview\n  .plan-overview {\n    margin-bottom: 20px;\n\n    .plan-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n\n      .plan-title {\n        margin: 0;\n        font-size: 16px;\n        font-weight: 600;\n        color: #ffffff;\n      }\n\n      .plan-status-badge {\n        padding: 4px 12px;\n        border-radius: 12px;\n        font-size: 12px;\n        font-weight: 500;\n\n        &.completed {\n          background: rgba(34, 197, 94, 0.2);\n          color: #22c55e;\n        }\n\n        &.running {\n          background: rgba(102, 126, 234, 0.2);\n          color: #667eea;\n        }\n\n        &.in-progress {\n          background: rgba(251, 191, 36, 0.2);\n          color: #fbbf24;\n        }\n\n        &.pending {\n          background: rgba(156, 163, 175, 0.2);\n          color: #9ca3af;\n        }\n      }\n    }\n\n    .parent-tool-call {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.2);\n      border-radius: 8px;\n      padding: 12px;\n\n      .parent-tool-header {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 8px;\n\n        .tool-icon {\n          font-size: 16px;\n          color: #667eea;\n        }\n\n        .tool-label {\n          color: #aaaaaa;\n          font-size: 13px;\n        }\n\n        .tool-name {\n          color: #ffffff;\n          font-weight: 600;\n          font-size: 14px;\n        }\n      }\n\n      .tool-parameters {\n        .param-label {\n          color: #aaaaaa;\n          font-size: 12px;\n          margin-bottom: 4px;\n          display: block;\n        }\n\n        .param-content {\n          margin: 0;\n          padding: 8px;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 11px;\n          color: #cccccc;\n          white-space: pre-wrap;\n          max-height: 120px;\n          overflow-y: auto;\n        }\n      }\n    }\n  }\n\n  // Agent execution container\n  .agent-execution-container {\n    .section-title {\n      margin: 0 0 16px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n      padding-bottom: 8px;\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    }\n\n    .agent-execution-item {\n      margin-bottom: 16px;\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 8px;\n      overflow: hidden;\n      transition: all 0.2s ease;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      &.running {\n        border-color: rgba(102, 126, 234, 0.4);\n        box-shadow: 0 0 8px rgba(102, 126, 234, 0.2);\n      }\n\n      &.completed {\n        border-color: rgba(34, 197, 94, 0.3);\n      }\n\n      &.pending {\n        opacity: 0.8;\n      }\n\n      .agent-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 16px;\n        background: rgba(255, 255, 255, 0.02);\n        cursor: pointer;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: rgba(255, 255, 255, 0.05);\n        }\n\n        .agent-info {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n\n          .agent-status-icon {\n            font-size: 18px;\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-details {\n            .agent-name {\n              font-weight: 600;\n              color: #ffffff;\n              font-size: 14px;\n              margin-bottom: 2px;\n            }\n\n            .request-content {\n              margin: 4px 0 0 0;\n              padding: 8px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 4px;\n              font-family: monospace;\n              font-size: 14px;\n              color: #cccccc;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              word-break: break-word;\n              overflow-wrap: break-word;\n              max-height: 120px;\n              overflow-y: auto;\n              line-height: 1.4;\n            }\n          }\n        }\n\n        .agent-controls {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n\n          .agent-status-badge {\n            padding: 3px 8px;\n            border-radius: 10px;\n            font-size: 11px;\n            font-weight: 500;\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n\n          .step-select-icon {\n            font-size: 16px;\n            color: #667eea;\n            transition: transform 0.2s ease;\n          }\n        }\n      }\n\n      .agent-execution-info {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        margin-bottom: 16px;\n\n        .agent-result,\n        .agent-error {\n          margin-bottom: 12px;\n\n          &:last-child {\n            margin-bottom: 0;\n          }\n\n          .result-header,\n          .error-header {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            margin-bottom: 6px;\n\n            .result-icon,\n            .error-icon {\n              font-size: 14px;\n            }\n\n            .result-icon {\n              color: #22c55e;\n            }\n\n            .error-icon {\n              color: #ef4444;\n            }\n\n            .result-label,\n            .error-label {\n              color: #ffffff;\n              font-size: 13px;\n              font-weight: 500;\n            }\n          }\n\n          .result-content,\n          .error-content {\n            margin: 0;\n            padding: 8px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 12px;\n            white-space: pre-wrap;\n            max-height: 150px;\n            overflow-y: auto;\n            color: #cccccc;\n          }\n\n          .error-content {\n            color: #ff9999;\n            border: 1px solid rgba(239, 68, 68, 0.2);\n          }\n        }\n      }\n\n      .sub-plans-container {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n\n        .sub-plans-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 12px;\n\n          .sub-plans-icon {\n            font-size: 16px;\n            color: #667eea;\n          }\n\n          .sub-plans-title {\n            color: #ffffff;\n            font-weight: 600;\n            font-size: 14px;\n          }\n        }\n\n        .sub-plans-list {\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n\n          .sub-plan-item {\n            background: rgba(102, 126, 234, 0.05);\n            border: 1px solid rgba(102, 126, 234, 0.1);\n            border-radius: 6px;\n            padding: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n\n            &:hover {\n              background: rgba(102, 126, 234, 0.1);\n              border-color: rgba(102, 126, 234, 0.2);\n            }\n\n            &.running {\n              border-color: rgba(102, 126, 234, 0.3);\n              background: rgba(102, 126, 234, 0.08);\n              box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n            }\n\n            &.completed {\n              border-color: rgba(34, 197, 94, 0.3);\n              background: rgba(34, 197, 94, 0.05);\n            }\n\n            &.pending {\n              opacity: 0.7;\n            }\n\n            .sub-plan-header {\n              display: flex;\n              align-items: center;\n              justify-content: space-between;\n              margin-bottom: 8px;\n\n              .sub-plan-info {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                flex: 1;\n\n                .sub-plan-status-icon {\n                  font-size: 16px;\n\n                  &.completed {\n                    color: #22c55e;\n                  }\n\n                  &.running {\n                    color: #667eea;\n                  }\n\n                  &.in-progress {\n                    color: #fbbf24;\n                  }\n\n                  &.pending {\n                    color: #9ca3af;\n                  }\n                }\n\n                .sub-plan-details {\n                  .sub-plan-title {\n                    font-weight: 600;\n                    color: #ffffff;\n                    font-size: 13px;\n                    margin-bottom: 2px;\n                  }\n\n                  .sub-plan-id {\n                    color: #aaaaaa;\n                    font-size: 11px;\n                    font-family: monospace;\n                  }\n                }\n              }\n\n              .sub-plan-meta {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n\n                .trigger-tool {\n                  display: flex;\n                  align-items: center;\n                  gap: 4px;\n                  padding: 2px 6px;\n                  background: rgba(102, 126, 234, 0.1);\n                  border-radius: 4px;\n                  font-size: 10px;\n\n                  .trigger-icon {\n                    font-size: 10px;\n                    color: #667eea;\n                  }\n\n                  .trigger-text {\n                    color: #cccccc;\n                    font-weight: 500;\n                  }\n                }\n              }\n\n              .sub-plan-status-badge {\n                padding: 2px 6px;\n                border-radius: 8px;\n                font-size: 10px;\n                font-weight: 500;\n\n                &.completed {\n                  background: rgba(34, 197, 94, 0.2);\n                  color: #22c55e;\n                }\n\n                &.running {\n                  background: rgba(102, 126, 234, 0.2);\n                  color: #667eea;\n                }\n\n                &.in-progress {\n                  background: rgba(251, 191, 36, 0.2);\n                  color: #fbbf24;\n                }\n\n                &.pending {\n                  background: rgba(156, 163, 175, 0.2);\n                  color: #9ca3af;\n                }\n              }\n            }\n\n            .sub-plan-progress {\n              margin-bottom: 8px;\n\n              .progress-info {\n                .progress-text {\n                  color: #aaaaaa;\n                  font-size: 10px;\n                  margin-bottom: 4px;\n                }\n\n                .progress-bar {\n                  background: rgba(0, 0, 0, 0.2);\n                  border-radius: 4px;\n                  height: 4px;\n                  overflow: hidden;\n\n                  .progress-fill {\n                    height: 100%;\n                    background: linear-gradient(90deg, #667eea, #764ba2);\n                    transition: width 0.3s ease;\n                    border-radius: 4px;\n                  }\n                }\n              }\n            }\n\n            .sub-plan-agents-steps {\n              .agents-steps-header {\n                color: #aaaaaa;\n                font-size: 11px;\n                margin-bottom: 6px;\n                font-weight: 500;\n              }\n\n              .agents-steps-list {\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n\n                .agent-step-item {\n                  border: 1px solid rgba(255, 255, 255, 0.1);\n                  border-radius: 6px;\n                  padding: 8px;\n                  background: rgba(0, 0, 0, 0.05);\n                  cursor: pointer;\n                  transition: all 0.2s;\n\n                  &:hover {\n                    background: rgba(0, 0, 0, 0.1);\n                    border-color: rgba(255, 255, 255, 0.2);\n                  }\n\n                  &.completed {\n                    border-color: rgba(34, 197, 94, 0.3);\n                    background: rgba(34, 197, 94, 0.05);\n                  }\n\n                  &.running {\n                    border-color: rgba(102, 126, 234, 0.3);\n                    background: rgba(102, 126, 234, 0.08);\n                  }\n\n                  &.pending {\n                    opacity: 0.7;\n                  }\n\n                  .agent-step-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                    margin-bottom: 8px;\n\n                    .agent-icon {\n                      font-size: 14px;\n\n                      &.completed {\n                        color: #22c55e;\n                      }\n\n                      &.running {\n                        color: #667eea;\n                      }\n\n                      &.pending {\n                        color: #9ca3af;\n                      }\n                    }\n\n                    .agent-name {\n                      color: #ffffff;\n                      font-size: 13px;\n                      font-weight: 500;\n                      flex: 1;\n                    }\n\n                    .agent-status-badge {\n                      padding: 2px 6px;\n                      border-radius: 3px;\n                      font-size: 10px;\n                      font-weight: 500;\n\n                      &.completed {\n                        background: rgba(34, 197, 94, 0.2);\n                        color: #22c55e;\n                      }\n\n                      &.running {\n                        background: rgba(102, 126, 234, 0.2);\n                        color: #667eea;\n                      }\n\n                      &.pending {\n                        background: rgba(156, 163, 175, 0.2);\n                        color: #9ca3af;\n                      }\n                    }\n                  }\n\n                  .sub-agent-execution-info {\n                    margin-left: 22px;\n\n                    .agent-result,\n                    .agent-error {\n                      margin-bottom: 8px;\n\n                      &:last-child {\n                        margin-bottom: 0;\n                      }\n\n                      .result-header,\n                      .error-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 4px;\n\n                        .result-icon,\n                        .error-icon {\n                          font-size: 12px;\n                        }\n\n                        .result-icon {\n                          color: #22c55e;\n                        }\n\n                        .error-icon {\n                          color: #ef4444;\n                        }\n\n                        .result-label,\n                        .error-label {\n                          color: #ffffff;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n\n                      .result-content,\n                      .error-content {\n                        margin: 0;\n                        padding: 6px;\n                        background: rgba(0, 0, 0, 0.2);\n                        border-radius: 3px;\n                        font-family: monospace;\n                        font-size: 10px;\n                        white-space: pre-wrap;\n                        max-height: 80px;\n                        overflow-y: auto;\n                        color: #cccccc;\n                        line-height: 1.3;\n                      }\n                    }\n\n                    .think-act-preview {\n                      margin-top: 8px;\n\n                      .think-act-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 6px;\n\n                        .think-act-icon {\n                          font-size: 12px;\n                          color: #667eea;\n                        }\n\n                        .think-act-label {\n                          color: #aaaaaa;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n\n                      .think-act-steps-preview {\n                        display: flex;\n                        flex-direction: column;\n                        gap: 3px;\n\n                        .think-act-step-preview {\n                          display: flex;\n                          align-items: center;\n                          gap: 6px;\n                          padding: 4px 6px;\n                          background: rgba(0, 0, 0, 0.1);\n                          border-radius: 3px;\n                          cursor: pointer;\n                          transition: all 0.2s;\n                          font-size: 10px;\n\n                          &:hover {\n                            background: rgba(0, 0, 0, 0.2);\n                          }\n\n                          .step-number {\n                            color: #667eea;\n                            font-weight: 500;\n                            min-width: 20px;\n                          }\n\n                          .step-description {\n                            color: #cccccc;\n                            flex: 1;\n                            white-space: nowrap;\n                            overflow: hidden;\n                            text-overflow: ellipsis;\n                          }\n\n                          .step-arrow {\n                            font-size: 10px;\n                            color: #888888;\n                          }\n                        }\n\n                        .more-steps {\n                          padding: 2px 6px;\n                          color: #888888;\n                          font-size: 9px;\n                          font-style: italic;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"thinking-section\" v-if=\"shouldShowThinking\">\n    <div class=\"thinking-header\">\n      <div class=\"thinking-avatar\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n      </div>\n      <div class=\"thinking-label\">{{ $t('chat.thinkingLabel') }}</div>\n    </div>\n\n    <div class=\"thinking-content\">\n      <!-- Basic thinking state -->\n      <div v-if=\"thinking\" class=\"thinking\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n        <span>{{ thinking }}</span>\n      </div>\n\n      <!-- Execution Details Component -->\n      <ExecutionDetails\n        v-if=\"thinkingDetails || planExecution\"\n        :plan-execution=\"(thinkingDetails || planExecution)!\"\n        :step-actions=\"stepActions || []\"\n        :generic-input=\"genericInput || ''\"\n        @agent-selected=\"handleAgentSelected\"\n        @sub-plan-selected=\"handleSubPlanSelected\"\n        @user-input-submitted=\"handleUserInputSubmit\"\n        @step-selected=\"handleStepSelected\"\n      />\n\n      <!-- Display the default processing state only when there is no final content -->\n      <div v-else-if=\"!hasContent && thinking\" class=\"default-processing\">\n        <div class=\"processing-indicator\">\n          <div class=\"thinking-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span>{{ thinking || $t('chat.thinkingProcessing') }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\n\ninterface Props {\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: unknown[]\n  genericInput?: string\n  hasContent?: boolean\n}\n\ninterface Emits {\n  (e: 'agent-selected', agentIndex: number, agent: AgentExecutionRecord): void\n  (\n    e: 'sub-plan-selected',\n    agentIndex: number,\n    subPlanIndex: number,\n    subPlan: PlanExecutionRecord\n  ): void\n  (e: 'user-input-submitted', inputData: Record<string, unknown>): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Computed properties\nconst shouldShowThinking = computed(() => {\n  return (\n    (props.thinking ?? false) ||\n    (props.thinkingDetails?.agentExecutionSequence?.length ?? 0) > 0 ||\n    (props.planExecution?.agentExecutionSequence?.length ?? 0) > 0\n  )\n})\n\n// Event handlers\nconst handleAgentSelected = (agentIndex: number, agent: AgentExecutionRecord) => {\n  emit('agent-selected', agentIndex, agent)\n}\n\nconst handleSubPlanSelected = (\n  agentIndex: number,\n  subPlanIndex: number,\n  subPlan: PlanExecutionRecord\n) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleUserInputSubmit = (inputData: Record<string, unknown>) => {\n  emit('user-input-submitted', inputData)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.thinking-section {\n  margin-bottom: 16px;\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 12px;\n  background: rgba(102, 126, 234, 0.05);\n  overflow: hidden;\n\n  .thinking-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 16px;\n    background: rgba(102, 126, 234, 0.1);\n    border-bottom: 1px solid rgba(102, 126, 234, 0.15);\n\n    .thinking-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 50%;\n\n      .thinking-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n\n    .thinking-label {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n    }\n  }\n\n  .thinking-content {\n    padding: 16px;\n\n    .thinking {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      margin-bottom: 12px;\n      padding: 8px 12px;\n      background: rgba(102, 126, 234, 0.1);\n      border-radius: 8px;\n      font-size: 13px;\n      color: #ffffff;\n\n      .thinking-icon {\n        font-size: 14px;\n        color: #667eea;\n        flex-shrink: 0;\n      }\n\n      span {\n        line-height: 1.4;\n      }\n    }\n\n    .default-processing {\n      .processing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n\n        .thinking-dots {\n          display: flex;\n          gap: 4px;\n\n          span {\n            width: 6px;\n            height: 6px;\n            background: #667eea;\n            border-radius: 50%;\n            animation: thinking-pulse 1.5s ease-in-out infinite;\n\n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n\n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n\n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n@keyframes thinking-pulse {\n  0%,\n  80%,\n  100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .thinking-section {\n    .thinking-header {\n      padding: 10px 14px;\n\n      .thinking-avatar {\n        width: 28px;\n        height: 28px;\n\n        .thinking-icon {\n          font-size: 14px;\n        }\n      }\n\n      .thinking-label {\n        font-size: 13px;\n      }\n    }\n\n    .thinking-content {\n      padding: 14px;\n\n      .thinking {\n        padding: 6px 10px;\n        font-size: 12px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-input-form-container\">\n    <div class=\"user-input-header\">\n      <Icon icon=\"carbon:user\" class=\"user-icon\" />\n      <h4 class=\"user-input-title\">{{ $t('chat.userInputRequired') }}</h4>\n    </div>\n\n    <p class=\"user-input-message\">\n      {{ userInputWaitState?.title ?? $t('chat.userInput.message') }}\n    </p>\n\n    <p v-if=\"userInputWaitState?.formDescription\" class=\"form-description\">\n      {{ userInputWaitState?.formDescription }}\n    </p>\n\n    <form @submit.prevent=\"handleUserInputSubmit\" class=\"user-input-form\">\n      <template v-if=\"userInputWaitState?.formInputs && userInputWaitState.formInputs.length > 0\">\n        <div class=\"form-grid\">\n          <div\n            v-for=\"(input, inputIndex) in userInputWaitState?.formInputs\"\n            :key=\"inputIndex\"\n            class=\"form-group\"\n          >\n            <label :for=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\">\n              {{ input.label }}{{ isRequired(input.required) ? ' *' : '' }}:\n            </label>\n\n            <!-- Form input types -->\n            <input\n              v-if=\"!input.type || input.type === 'text'\"\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'email'\"\n              type=\"email\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'number'\"\n              type=\"number\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'password'\"\n              type=\"password\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <textarea\n              v-else-if=\"input.type === 'textarea'\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-textarea\"\n              rows=\"4\"\n            ></textarea>\n\n            <select\n              v-else-if=\"input.type === 'select' && input.options\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-select\"\n            >\n              <option value=\"\">{{ $t('selectCommon.pleaseSelect') }}</option>\n              <option\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                :value=\"option\"\n              >\n                {{ option }}\n              </option>\n            </select>\n\n            <div v-else-if=\"input.type === 'checkbox' && input.options\" class=\"checkbox-group\">\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"checkbox-item\"\n              >\n                <input\n                  type=\"checkbox\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-checkbox\"\n                />\n                <span class=\"checkbox-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <div v-else-if=\"input.type === 'radio' && input.options\" class=\"radio-group\">\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"radio-item\"\n              >\n                <input\n                  type=\"radio\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-radio\"\n                />\n                <span class=\"radio-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <input\n              v-else\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"form-group\">\n          <label for=\"form-input-genericInput\">{{ $t('common.input') }}:</label>\n          <input\n            type=\"text\"\n            id=\"form-input-genericInput\"\n            name=\"genericInput\"\n            v-model=\"genericInput\"\n            class=\"form-input\"\n          />\n        </div>\n      </template>\n\n      <button type=\"submit\" class=\"submit-user-input-btn\">\n        {{ $t('chat.userInput.submit') }}\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, watch, onMounted, onUnmounted } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { CommonApiService } from '@/api/common-api-service'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'user-input-submitted', inputData: Record<string, unknown>): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nuseI18n()\n\n// Local state\nconst formInputsStore = reactive<Record<number, string | string[]>>({})\nconst genericInput = ref(props.genericInput ?? '')\nconst isInitialized = ref(false)\nconst initializationTimeout = ref<ReturnType<typeof setTimeout> | null>(null)\n\n// Initialize form inputs based on type\nconst initializeFormInputs = () => {\n  const formInputs = props.userInputWaitState?.formInputs\n  if (formInputs && formInputs.length > 0) {\n    // Only initialize if not already initialized or if form structure changed\n    const needsInitialization =\n      !isInitialized.value || Object.keys(formInputsStore).length !== formInputs.length\n\n    if (needsInitialization) {\n      formInputs.forEach((input, index) => {\n        // Only initialize if this field doesn't exist or is empty\n        if (\n          !(index in formInputsStore) ||\n          (input.type === 'checkbox' && !Array.isArray(formInputsStore[index])) ||\n          (input.type !== 'checkbox' && formInputsStore[index] === '')\n        ) {\n          if (input.type === 'checkbox') {\n            formInputsStore[index] = []\n          } else {\n            formInputsStore[index] = ''\n          }\n        }\n      })\n      isInitialized.value = true\n    }\n  }\n}\n\n// Initialize on mount and when formInputs change\nonMounted(() => {\n  initializeFormInputs()\n})\n\nwatch(\n  () => props.userInputWaitState?.formInputs,\n  () => {\n    // Clear any existing timeout\n    if (initializationTimeout.value) {\n      clearTimeout(initializationTimeout.value)\n    }\n\n    // Debounce initialization to avoid frequent resets\n    initializationTimeout.value = setTimeout(() => {\n      // Reset initialization flag when form structure changes\n      isInitialized.value = false\n      initializeFormInputs()\n    }, 100) // 100ms debounce\n  },\n  { deep: true }\n)\n\n// Event handlers\nconst handleUserInputSubmit = async () => {\n  try {\n    const inputData: Record<string, unknown> = {}\n\n    const formInputs = props.userInputWaitState?.formInputs\n    if (formInputs && formInputs.length > 0) {\n      Object.entries(formInputsStore).forEach(([index, value]) => {\n        const numIndex = parseInt(index, 10)\n        const input = formInputs[numIndex]\n        const label = input.label || `input_${index}`\n        // Handle checkbox arrays - convert to string if it's an array\n        if (Array.isArray(value)) {\n          inputData[label] = value.join(', ')\n        } else {\n          inputData[label] = value\n        }\n      })\n    } else {\n      inputData.genericInput = genericInput.value\n    }\n\n    console.log('[UserInputForm] Submitting user input:', inputData, 'for planId:', props.planId)\n\n    // Submit user input to backend API\n    if (props.planId) {\n      await CommonApiService.submitFormInput(props.planId, inputData)\n      console.log('[UserInputForm] User input submitted successfully')\n    } else {\n      console.error('[UserInputForm] No planId available for user input submission')\n    }\n\n    emit('user-input-submitted', inputData)\n  } catch (error: unknown) {\n    console.error('[UserInputForm] User input submission failed:', error)\n  }\n}\n\n// Helper methods\nconst getOptionsArray = (options: string | string[] | undefined): string[] => {\n  if (!options) return []\n  if (Array.isArray(options)) return options\n  if (typeof options === 'string') {\n    return options\n      .split(',')\n      .map(opt => opt.trim())\n      .filter(opt => opt.length > 0)\n  }\n  return []\n}\n\nconst isRequired = (required: boolean | string | undefined): boolean => {\n  if (typeof required === 'boolean') return required\n  if (typeof required === 'string') return required === 'true'\n  return false\n}\n\n// Cleanup on unmount\nonUnmounted(() => {\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n})\n</script>\n\n<style lang=\"less\" scoped>\n.user-input-form-container {\n  margin-top: 20px;\n  padding: 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 8px;\n\n  .user-input-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    margin-bottom: 12px;\n\n    .user-icon {\n      font-size: 16px;\n      color: #667eea;\n    }\n\n    .user-input-title {\n      margin: 0;\n      color: #ffffff;\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n\n  .user-input-message {\n    margin-bottom: 12px;\n    font-weight: 500;\n    color: #ffffff;\n    font-size: 14px;\n  }\n\n  .form-description {\n    margin-bottom: 16px;\n    color: #aaaaaa;\n    font-size: 13px;\n    line-height: 1.4;\n  }\n\n  .user-input-form {\n    .form-grid {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      margin-bottom: 16px;\n\n      @media (max-width: 768px) {\n        gap: 12px;\n      }\n    }\n\n    .form-group {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n\n      label {\n        font-size: 13px;\n        font-weight: 500;\n        color: #ffffff;\n      }\n\n      .form-input {\n        padding: 8px 12px;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: #ffffff;\n        font-size: 14px;\n        transition: border-color 0.2s ease;\n\n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n\n        &::placeholder {\n          color: #888888;\n        }\n      }\n\n      .form-textarea {\n        resize: vertical;\n        min-height: 60px;\n        font-family: inherit;\n      }\n\n      .form-select {\n        cursor: pointer;\n\n        option {\n          background: #2d3748;\n          color: #ffffff;\n        }\n      }\n\n      .checkbox-group,\n      .radio-group {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n\n        .checkbox-item,\n        .radio-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          cursor: pointer;\n          padding: 4px 0;\n\n          .form-checkbox,\n          .form-radio {\n            width: 16px;\n            height: 16px;\n            margin: 0;\n            cursor: pointer;\n            accent-color: #667eea;\n          }\n\n          .checkbox-label,\n          .radio-label {\n            color: #ffffff;\n            font-size: 14px;\n            user-select: none;\n          }\n        }\n      }\n    }\n\n    .submit-user-input-btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      border: none;\n      padding: 10px 20px;\n      border-radius: 6px;\n      font-size: 14px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.2s ease;\n\n      &:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n      }\n\n      &:active {\n        transform: translateY(0);\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"response-section\">\n    <div class=\"response-header\">\n      <div class=\"response-avatar\">\n        <Icon icon=\"carbon:bot\" class=\"bot-icon\" />\n      </div>\n      <div class=\"response-name\">{{ $t('chat.botName') }}</div>\n\n      <!-- Response timestamp -->\n      <div v-if=\"timestamp\" class=\"response-timestamp\">\n        {{ formatTimestamp(timestamp) }}\n      </div>\n    </div>\n\n    <div class=\"response-content\">\n      <!-- User input form -->\n      <UserInputForm\n        v-if=\"userInputWaitState?.waiting\"\n        :user-input-wait-state=\"userInputWaitState\"\n        v-bind=\"planId ? { 'plan-id': planId } : {}\"\n        :generic-input=\"genericInput ?? ''\"\n        @user-input-submitted=\"handleUserInputSubmitted\"\n      />\n\n      <!-- Final response with content -->\n      <div v-if=\"content\" class=\"final-response\">\n        <div class=\"response-text\" v-html=\"formatResponseText(content)\"></div>\n\n        <!-- Response actions -->\n        <div class=\"response-actions\">\n          <button\n            class=\"action-btn copy-btn\"\n            @click=\"copyToClipboard\"\n            :title=\"$t('chat.copyResponse')\"\n          >\n            <Icon icon=\"carbon:copy\" />\n          </button>\n\n          <button\n            class=\"action-btn regenerate-btn\"\n            @click=\"handleRegenerate\"\n            :title=\"$t('chat.regenerateResponse')\"\n          >\n            <Icon icon=\"carbon:renew\" />\n          </button>\n        </div>\n      </div>\n\n      <!-- Loading/streaming state -->\n      <div v-else-if=\"isStreaming\" class=\"response-placeholder\">\n        <div class=\"typing-indicator\">\n          <div class=\"typing-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span class=\"typing-text\">{{ $t('chat.thinkingResponse') }}</span>\n        </div>\n      </div>\n\n      <!-- Error state -->\n      <div v-else-if=\"error\" class=\"response-error\">\n        <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n        <span class=\"error-text\">{{ error }}</span>\n        <button class=\"retry-btn\" @click=\"handleRetry\">\n          {{ $t('chat.retry') }}\n        </button>\n      </div>\n\n      <!-- Empty state -->\n      <div v-else class=\"response-empty\">\n        <span class=\"empty-text\">{{ $t('chat.waitingForResponse') }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport UserInputForm from './UserInputForm.vue'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  content?: string\n  isStreaming?: boolean\n  error?: string\n  timestamp?: Date\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'copy'): void\n  (e: 'regenerate'): void\n  (e: 'retry'): void\n  (e: 'user-input-submitted', inputData: Record<string, unknown>): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { formatResponseText, formatTimestamp } = useMessageFormatting()\n\n// Methods\nconst copyToClipboard = async () => {\n  if (!props.content) return\n\n  try {\n    // Strip HTML tags for clipboard\n    const plainText = props.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    emit('copy')\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error)\n  }\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate')\n}\n\nconst handleRetry = () => {\n  emit('retry')\n}\n\nconst handleUserInputSubmitted = (inputData: Record<string, unknown>) => {\n  console.log('[ResponseSection] User input submitted:', inputData)\n  emit('user-input-submitted', inputData)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.response-section {\n  .response-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 12px;\n\n    .response-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);\n      border-radius: 50%;\n      flex-shrink: 0;\n\n      .bot-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n\n    .response-name {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n      flex: 1;\n    }\n\n    .response-timestamp {\n      font-size: 11px;\n      color: #aaaaaa;\n    }\n  }\n\n  .response-content {\n    .final-response {\n      position: relative;\n\n      .response-text {\n        background: rgba(255, 255, 255, 0.05);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 12px;\n        padding: 16px;\n        color: #ffffff;\n        line-height: 1.6;\n        font-size: 14px;\n\n        :deep(strong) {\n          font-weight: 600;\n          color: #ffffff;\n        }\n\n        :deep(em) {\n          font-style: italic;\n          color: #cccccc;\n        }\n\n        :deep(code) {\n          background: rgba(0, 0, 0, 0.3);\n          padding: 2px 6px;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', monospace;\n          font-size: 13px;\n          color: #8be9fd;\n        }\n\n        :deep(pre) {\n          background: rgba(0, 0, 0, 0.4);\n          padding: 12px;\n          border-radius: 8px;\n          overflow-x: auto;\n          margin: 8px 0;\n\n          code {\n            background: none;\n            padding: 0;\n            color: #f8f8f2;\n            font-size: 12px;\n          }\n        }\n      }\n\n      .response-actions {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        opacity: 0;\n        transition: opacity 0.2s ease;\n\n        .action-btn {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 28px;\n          height: 28px;\n          background: rgba(255, 255, 255, 0.1);\n          border: none;\n          border-radius: 6px;\n          color: #aaaaaa;\n          cursor: pointer;\n          transition: all 0.2s ease;\n\n          &:hover {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n          }\n\n          svg {\n            font-size: 14px;\n          }\n        }\n      }\n\n      &:hover .response-actions {\n        opacity: 1;\n      }\n    }\n\n    .response-placeholder {\n      .typing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n\n        .typing-dots {\n          display: flex;\n          gap: 4px;\n\n          span {\n            width: 6px;\n            height: 6px;\n            background: #4f46e5;\n            border-radius: 50%;\n            animation: typing-pulse 1.5s ease-in-out infinite;\n\n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n\n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n\n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n\n        .typing-text {\n          font-style: italic;\n        }\n      }\n    }\n\n    .response-error {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 12px 16px;\n      background: rgba(239, 68, 68, 0.1);\n      border: 1px solid rgba(239, 68, 68, 0.2);\n      border-radius: 8px;\n      color: #ff9999;\n      font-size: 13px;\n\n      .error-icon {\n        font-size: 16px;\n        color: #ef4444;\n        flex-shrink: 0;\n      }\n\n      .error-text {\n        flex: 1;\n      }\n\n      .retry-btn {\n        background: rgba(239, 68, 68, 0.2);\n        border: none;\n        padding: 4px 8px;\n        border-radius: 4px;\n        color: #ffffff;\n        font-size: 12px;\n        cursor: pointer;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: rgba(239, 68, 68, 0.3);\n        }\n      }\n    }\n\n    .response-empty {\n      padding: 16px;\n      text-align: center;\n      color: #888888;\n      font-style: italic;\n      font-size: 13px;\n    }\n  }\n}\n\n@keyframes typing-pulse {\n  0%,\n  80%,\n  100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .response-section {\n    .response-header {\n      gap: 10px;\n\n      .response-avatar {\n        width: 28px;\n        height: 28px;\n\n        .bot-icon {\n          font-size: 14px;\n        }\n      }\n\n      .response-name {\n        font-size: 13px;\n      }\n    }\n\n    .response-content {\n      .final-response {\n        .response-text {\n          padding: 14px;\n          font-size: 13px;\n        }\n\n        .response-actions {\n          margin-top: 6px;\n\n          .action-btn {\n            width: 26px;\n            height: 26px;\n\n            svg {\n              font-size: 12px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assistant-message\">\n    <!-- Thinking section (when available) -->\n    <ThinkingSection\n      v-if=\"message.thinkingDetails\"\n      :thinking-details=\"message.thinkingDetails\"\n      @step-selected=\"handleStepSelected\"\n    />\n\n    <!-- Plan execution section (when available) -->\n    <ExecutionDetails\n      v-if=\"message.planExecution\"\n      :plan-execution=\"message.planExecution\"\n      :step-actions=\"message.stepActions || []\"\n      :generic-input=\"message.genericInput || ''\"\n      @step-selected=\"handleStepSelected\"\n    />\n\n    <!-- Response section -->\n    <ResponseSection\n      v-if=\"\n        message.content ||\n        message.error ||\n        isStreaming ||\n        message.planExecution?.userInputWaitState?.waiting\n      \"\n      :content=\"message.content || ''\"\n      :is-streaming=\"isStreaming || false\"\n      v-bind=\"{\n        ...(message.error ? { error: message.error } : {}),\n        ...(message.planExecution?.userInputWaitState\n          ? { userInputWaitState: message.planExecution.userInputWaitState }\n          : {}),\n        ...(message.planExecution?.currentPlanId\n          ? { planId: message.planExecution.currentPlanId }\n          : {}),\n      }\"\n      :timestamp=\"message.timestamp\"\n      :generic-input=\"message.genericInput || ''\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @user-input-submitted=\"\n        (inputData: Record<string, unknown>) => handleUserInputSubmit(message, inputData)\n      \"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport ThinkingSection from './ThinkingSection.vue'\nimport ResponseSection from './ResponseSection.vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Event handlers\nconst handleCopy = () => {\n  emit('copy', props.message.id)\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate', props.message.id)\n}\n\nconst handleRetry = () => {\n  emit('retry', props.message.id)\n}\n\n// Plan execution event handlers\n\nconst handleUserInputSubmit = (message: ChatMessage, inputData: Record<string, unknown>) => {\n  console.log('[AssistantMessage] User input submitted:', inputData, 'for message:', message.id)\n  // Handle user input submission - can be extended for more functionality\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[AssistantMessage] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.assistant-message {\n  margin-bottom: 24px;\n\n  // Add spacing between thinking and response sections\n  > * + * {\n    margin-top: 16px;\n  }\n}\n\n@media (max-width: 768px) {\n  .assistant-message {\n    margin-bottom: 20px;\n\n    > * + * {\n      margin-top: 12px;\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-message\" :class=\"messageClasses\">\n    <!-- User message -->\n    <UserMessage v-if=\"message.type === 'user'\" :message=\"message\" />\n\n    <!-- Assistant message -->\n    <AssistantMessage\n      v-else-if=\"message.type === 'assistant'\"\n      :message=\"message\"\n      :is-streaming=\"isStreaming || false\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @step-selected=\"handleStepSelected\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport UserMessage from './UserMessage.vue'\nimport AssistantMessage from './AssistantMessage.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { getMessageClasses } = useMessageFormatting()\n\n// Computed properties\nconst messageClasses = computed(() => {\n  return getMessageClasses(props.message)\n})\n\n// Event handlers\nconst handleCopy = (messageId: string) => {\n  emit('copy', messageId)\n}\n\nconst handleRegenerate = (messageId: string) => {\n  emit('regenerate', messageId)\n}\n\nconst handleRetry = (messageId: string) => {\n  emit('retry', messageId)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.chat-message {\n  width: 100%;\n\n  &.streaming {\n    position: relative;\n\n    &::after {\n      content: '';\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background: linear-gradient(90deg, transparent, #4f46e5, transparent);\n      animation: streaming-pulse 2s ease-in-out infinite;\n    }\n  }\n}\n\n@keyframes streaming-pulse {\n  0% {\n    transform: translateX(-100%);\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, computed, readonly } from 'vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\n\n// Local interface to handle readonly compatibility issues\nexport interface CompatiblePlanExecutionRecord\n  extends Omit<PlanExecutionRecord, 'agentExecutionSequence'> {\n  agentExecutionSequence?: AgentExecutionRecord[]\n}\n\n// Message interface\nexport interface ChatMessage {\n  id: string\n  type: 'user' | 'assistant'\n  content: string\n  timestamp: Date\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: unknown[]\n  genericInput?: string\n  isStreaming?: boolean\n  error?: string\n  attachments?: File[]\n}\n\n// Input message interface\nexport interface InputMessage {\n  input: string\n  attachments?: File[]\n}\n\n/**\n * Utility type to convert readonly arrays to mutable ones\n */\ntype MakeMutable<T> = T extends readonly (infer U)[] ? U[] : T\n\n/**\n * Convert readonly PlanExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertPlanExecutionRecord<T extends Record<string, unknown>>(\n  record: T\n): CompatiblePlanExecutionRecord {\n  const converted = { ...record } as unknown as CompatiblePlanExecutionRecord\n\n  if ('agentExecutionSequence' in record && Array.isArray(record.agentExecutionSequence)) {\n    converted.agentExecutionSequence = record.agentExecutionSequence.map((agent: unknown) =>\n      convertAgentExecutionRecord(agent as Record<string, unknown>)\n    )\n  }\n\n  return converted\n}\n\n/**\n * Convert readonly AgentExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertAgentExecutionRecord<T extends Record<string, unknown>>(\n  record: T\n): AgentExecutionRecord {\n  const converted = { ...record } as unknown as AgentExecutionRecord\n\n  if ('subPlanExecutionRecords' in record && Array.isArray(record.subPlanExecutionRecords)) {\n    converted.subPlanExecutionRecords = record.subPlanExecutionRecords.map((subPlan: unknown) =>\n      convertPlanExecutionRecord(subPlan as Record<string, unknown>)\n    )\n  }\n\n  return converted\n}\n\n/**\n * Convert a message with potentially readonly arrays to a fully mutable version\n */\nexport function convertMessageToCompatible<T extends Record<string, unknown>>(\n  message: T\n): ChatMessage {\n  const converted = { ...message } as unknown as ChatMessage\n\n  if ('thinkingDetails' in message && message.thinkingDetails) {\n    converted.thinkingDetails = convertPlanExecutionRecord(\n      message.thinkingDetails as Record<string, unknown>\n    )\n  }\n\n  if ('planExecution' in message && message.planExecution) {\n    converted.planExecution = convertPlanExecutionRecord(\n      message.planExecution as Record<string, unknown>\n    )\n  }\n\n  if ('attachments' in message && Array.isArray(message.attachments)) {\n    converted.attachments = [...message.attachments] as MakeMutable<typeof message.attachments>\n  }\n\n  return converted\n}\n\n/**\n * Chat messages state management\n */\nexport function useChatMessages() {\n  // State\n  const messages = ref<ChatMessage[]>([])\n  const isLoading = ref(false)\n  const streamingMessageId = ref<string | null>(null)\n  const activeMessageId = ref<string | null>(null)\n\n  // Computed properties\n  const lastMessage = computed(() => {\n    return messages.value.length > 0 ? messages.value[messages.value.length - 1] : null\n  })\n\n  const isStreaming = computed(() => {\n    return streamingMessageId.value !== null\n  })\n\n  const hasMessages = computed(() => {\n    return messages.value.length > 0\n  })\n\n  // Methods\n  const addMessage = (\n    type: 'user' | 'assistant',\n    content: string,\n    options?: Partial<ChatMessage>\n  ): ChatMessage => {\n    const message: ChatMessage = {\n      id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      content,\n      timestamp: new Date(),\n      isStreaming: false,\n      ...options,\n    }\n\n    messages.value.push(message)\n    return message\n  }\n\n  const updateMessage = (id: string, updates: Partial<ChatMessage>) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value[index] = { ...messages.value[index], ...updates }\n    }\n  }\n\n  const removeMessage = (id: string) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value.splice(index, 1)\n    }\n  }\n\n  const clearMessages = () => {\n    messages.value = []\n    streamingMessageId.value = null\n    activeMessageId.value = null\n  }\n\n  const startStreaming = (messageId: string) => {\n    streamingMessageId.value = messageId\n    updateMessage(messageId, { isStreaming: true })\n  }\n\n  const stopStreaming = (messageId?: string) => {\n    if (messageId) {\n      updateMessage(messageId, { isStreaming: false })\n    }\n    if (streamingMessageId.value === messageId) {\n      streamingMessageId.value = null\n    }\n  }\n\n  const setActiveMessage = (id: string | null) => {\n    activeMessageId.value = id\n  }\n\n  const appendToMessage = (id: string, content: string, field: keyof ChatMessage = 'content') => {\n    const message = messages.value.find(m => m.id === id)\n    if (message && typeof message[field] === 'string') {\n      updateMessage(id, { [field]: (message[field] as string) + content })\n    }\n  }\n\n  const updateMessageThinkingDetails = (id: string, thinkingDetails: PlanExecutionRecord) => {\n    updateMessage(id, { thinkingDetails })\n  }\n\n  const updateMessageThinking = (id: string, thinking: string) => {\n    updateMessage(id, { thinking })\n  }\n\n  const updateMessagePlanExecution = (id: string, planExecution: PlanExecutionRecord) => {\n    updateMessage(id, { planExecution })\n  }\n\n  const findMessage = (id: string): ChatMessage | undefined => {\n    return messages.value.find(m => m.id === id)\n  }\n\n  const getMessageIndex = (id: string): number => {\n    return messages.value.findIndex(m => m.id === id)\n  }\n\n  return {\n    // State\n    messages: readonly(messages),\n    isLoading,\n    streamingMessageId: readonly(streamingMessageId),\n    activeMessageId: readonly(activeMessageId),\n\n    // Computed\n    lastMessage,\n    isStreaming,\n    hasMessages,\n\n    // Methods\n    addMessage,\n    updateMessage,\n    removeMessage,\n    clearMessages,\n    startStreaming,\n    stopStreaming,\n    setActiveMessage,\n    appendToMessage,\n    updateMessageThinking,\n    updateMessageThinkingDetails,\n    updateMessagePlanExecution,\n    findMessage,\n    getMessageIndex,\n  }\n}\n\n// Message utilities\nexport const createUserMessage = (content: string): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'user',\n  content,\n  isStreaming: false,\n})\n\nexport const createAssistantMessage = (\n  options?: Partial<ChatMessage>\n): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'assistant',\n  content: '',\n  thinking: '',\n  isStreaming: true,\n  ...options,\n})\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, nextTick, onMounted, onUnmounted, readonly } from 'vue'\nimport type { Ref } from 'vue'\n\n/**\n * Scroll behavior management for chat messages\n */\nexport function useScrollBehavior(containerRef: Ref<HTMLElement | null>) {\n  const showScrollToBottom = ref(false)\n  const isAutoScrollEnabled = ref(true)\n  const scrollThreshold = 150 // pixels from bottom to show scroll button\n\n  /**\n   * Scroll to bottom of container\n   */\n  const scrollToBottom = async (smooth = true) => {\n    if (!containerRef.value) return\n\n    await nextTick()\n\n    containerRef.value.scrollTo({\n      top: containerRef.value.scrollHeight,\n      behavior: smooth ? 'smooth' : 'auto',\n    })\n  }\n\n  /**\n   * Check if user is near bottom of container\n   */\n  const isNearBottom = (): boolean => {\n    if (!containerRef.value) return false\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    return scrollHeight - scrollTop - clientHeight < scrollThreshold\n  }\n\n  /**\n   * Check scroll position and update scroll button visibility\n   */\n  const checkScrollPosition = () => {\n    if (!containerRef.value) return\n\n    const nearBottom = isNearBottom()\n    showScrollToBottom.value =\n      !nearBottom && containerRef.value.scrollHeight > containerRef.value.clientHeight\n\n    // Enable auto-scroll when user scrolls to bottom\n    if (nearBottom) {\n      isAutoScrollEnabled.value = true\n    }\n  }\n\n  /**\n   * Handle scroll event\n   */\n  const handleScroll = () => {\n    checkScrollPosition()\n\n    // Disable auto-scroll when user manually scrolls up\n    if (!isNearBottom()) {\n      isAutoScrollEnabled.value = false\n    }\n  }\n\n  /**\n   * Auto scroll to bottom when new messages arrive\n   */\n  const autoScrollToBottom = async () => {\n    if (isAutoScrollEnabled.value) {\n      await scrollToBottom()\n    }\n  }\n\n  /**\n   * Force scroll to bottom and enable auto-scroll\n   */\n  const forceScrollToBottom = async () => {\n    isAutoScrollEnabled.value = true\n    await scrollToBottom()\n  }\n\n  /**\n   * Scroll to a specific message element\n   */\n  const scrollToMessage = (messageId: string, smooth = true) => {\n    if (!containerRef.value) return\n\n    const messageElement = containerRef.value.querySelector(`[data-message-id=\"${messageId}\"]`)\n    if (messageElement) {\n      messageElement.scrollIntoView({\n        behavior: smooth ? 'smooth' : 'auto',\n        block: 'center',\n      })\n    }\n  }\n\n  /**\n   * Get scroll position info\n   */\n  const getScrollInfo = () => {\n    if (!containerRef.value) {\n      return {\n        scrollTop: 0,\n        scrollHeight: 0,\n        clientHeight: 0,\n        isAtTop: true,\n        isAtBottom: true,\n        scrollPercentage: 0,\n      }\n    }\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    const isAtTop = scrollTop === 0\n    const isAtBottom = scrollTop + clientHeight >= scrollHeight - 5\n    const scrollPercentage =\n      scrollHeight > clientHeight ? (scrollTop / (scrollHeight - clientHeight)) * 100 : 100\n\n    return {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n      isAtTop,\n      isAtBottom,\n      scrollPercentage,\n    }\n  }\n\n  /**\n   * Add scroll event listener\n   */\n  const addScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.addEventListener('scroll', handleScroll, { passive: true })\n    }\n  }\n\n  /**\n   * Remove scroll event listener\n   */\n  const removeScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.removeEventListener('scroll', handleScroll)\n    }\n  }\n\n  /**\n   * Initialize scroll behavior\n   */\n  const initializeScrollBehavior = () => {\n    addScrollListener()\n    checkScrollPosition()\n  }\n\n  /**\n   * Clean up scroll behavior\n   */\n  const cleanupScrollBehavior = () => {\n    removeScrollListener()\n  }\n\n  // Auto-initialize on mount\n  onMounted(() => {\n    nextTick(() => {\n      initializeScrollBehavior()\n    })\n  })\n\n  // Cleanup on unmount\n  onUnmounted(() => {\n    cleanupScrollBehavior()\n  })\n\n  return {\n    // State\n    showScrollToBottom: readonly(showScrollToBottom),\n    isAutoScrollEnabled: readonly(isAutoScrollEnabled),\n\n    // Methods\n    scrollToBottom,\n    autoScrollToBottom,\n    forceScrollToBottom,\n    scrollToMessage,\n    isNearBottom,\n    checkScrollPosition,\n    getScrollInfo,\n    addScrollListener,\n    removeScrollListener,\n    initializeScrollBehavior,\n    cleanupScrollBehavior,\n  }\n}\n\n/**\n * Smooth scroll behavior with easing\n */\nexport function useSmoothScroll() {\n  const scrollWithEasing = (\n    element: HTMLElement,\n    targetPosition: number,\n    duration: number = 300\n  ) => {\n    const startPosition = element.scrollTop\n    const distance = targetPosition - startPosition\n    let startTime: number | null = null\n\n    const animation = (currentTime: number) => {\n      if (startTime === null) startTime = currentTime\n      const timeElapsed = currentTime - startTime\n      const run = easeInOutQuad(timeElapsed, startPosition, distance, duration)\n\n      element.scrollTop = run\n\n      if (timeElapsed < duration) {\n        requestAnimationFrame(animation)\n      }\n    }\n\n    requestAnimationFrame(animation)\n  }\n\n  // Easing function\n  const easeInOutQuad = (t: number, b: number, c: number, d: number): number => {\n    t /= d / 2\n    if (t < 1) return (c / 2) * t * t + b\n    t--\n    return (-c / 2) * (t * (t - 2) - 1) + b\n  }\n\n  return {\n    scrollWithEasing,\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonApiService } from '@/api/common-api-service'\nimport { DirectApiService } from '@/api/direct-api-service'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { useTaskStore } from '@/stores/task'\nimport type { UIStateData } from '@/types/cache-data'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { reactive } from 'vue'\n\n// Define event callback interface\ninterface EventCallbacks {\n  onPlanUpdate?: (rootPlanId: string) => void\n  onPlanCompleted?: (rootPlanId: string) => void\n  onDialogRoundStart?: (rootPlanId: string) => void\n  onChatInputUpdateState?: (rootPlanId: string) => void\n  onChatInputClear?: () => void\n  onPlanError?: (message: string) => void\n}\n\ninterface ExecutionState {\n  activePlanId: string | null\n  lastSequenceSize: number\n  isPolling: boolean\n  pollTimer: number | null\n}\n\nexport class PlanExecutionManager {\n  private static instance: PlanExecutionManager | null = null\n  private readonly POLL_INTERVAL = 5000\n\n  // Reactive state\n  private state = reactive<ExecutionState>({\n    activePlanId: null,\n    lastSequenceSize: 0,\n    isPolling: false,\n    pollTimer: null,\n  })\n\n  // Event callbacks\n  private callbacks: EventCallbacks = {}\n\n  // Cache for PlanExecutionRecord by rootPlanId\n  private planExecutionCache = new Map<string, PlanExecutionRecord>()\n\n  // Cache for UI state by rootPlanId\n  private uiStateCache = new Map<string, UIStateData>()\n\n  /**\n   * Get cached plan execution record by rootPlanId\n   */\n  getCachedPlanRecord(rootPlanId: string): PlanExecutionRecord | undefined {\n    return this.planExecutionCache.get(rootPlanId)\n  }\n\n  /**\n   * Get cached UI state by rootPlanId\n   */\n  getCachedUIState(rootPlanId: string): UIStateData | undefined {\n    return this.uiStateCache.get(rootPlanId)\n  }\n\n  /**\n   * Set cached UI state by rootPlanId\n   */\n  setCachedUIState(rootPlanId: string, uiState: UIStateData): void {\n    this.uiStateCache.set(rootPlanId, uiState)\n    console.log(`[PlanExecutionManager] Cached UI state for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Get all cached plan execution records\n   */\n  getAllCachedRecords(): Map<string, PlanExecutionRecord> {\n    return new Map(this.planExecutionCache)\n  }\n\n  /**\n   * Check if a plan execution record exists in cache\n   */\n  hasCachedPlanRecord(rootPlanId: string): boolean {\n    return this.planExecutionCache.has(rootPlanId)\n  }\n\n  /**\n   * Set cached plan execution record by rootPlanId\n   */\n  setCachedPlanRecord(rootPlanId: string, record: PlanExecutionRecord): void {\n    this.planExecutionCache.set(rootPlanId, record)\n    console.log(`[PlanExecutionManager] Cached plan execution record for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Clear cached plan execution record by rootPlanId\n   */\n  clearCachedPlanRecord(rootPlanId: string): boolean {\n    const deleted = this.planExecutionCache.delete(rootPlanId)\n    if (deleted) {\n      console.log(\n        `[PlanExecutionManager] Cleared cached plan execution record for rootPlanId: ${rootPlanId}`\n      )\n    }\n    return deleted\n  }\n\n  /**\n   * Clear all cached plan execution records\n   */\n  clearAllCachedRecords(): void {\n    const planCacheSize = this.planExecutionCache.size\n    const uiStateCacheSize = this.uiStateCache.size\n\n    this.planExecutionCache.clear()\n    this.uiStateCache.clear()\n\n    console.log(\n      `[PlanExecutionManager] Cleared all caches - Plans: ${planCacheSize}, UI States: ${uiStateCacheSize}`\n    )\n  }\n\n  private constructor() {\n    // Remove window event listener initialization\n    console.log('[PlanExecutionManager] Initialized with callback-based event system')\n  }\n\n  /**\n   * Get singleton instance\n   */\n  public static getInstance(): PlanExecutionManager {\n    if (!PlanExecutionManager.instance) {\n      PlanExecutionManager.instance = new PlanExecutionManager()\n    }\n    return PlanExecutionManager.instance\n  }\n\n  /**\n   * Get current active plan ID\n   */\n  public getActivePlanId(): string | null {\n    return this.state.activePlanId\n  }\n\n  /**\n   * Get current state (reactive)\n   */\n  public getState() {\n    return this.state\n  }\n\n  /**\n   * Set event callbacks\n   */\n  public setEventCallbacks(callbacks: EventCallbacks): void {\n    this.callbacks = { ...this.callbacks, ...callbacks }\n    console.log('[PlanExecutionManager] Event callbacks set:', Object.keys(callbacks))\n  }\n\n  /**\n   * Handle user message send request\n   */\n  public async handleUserMessageSendRequested(query: string): Promise<void> {\n    if (!this.validateAndPrepareUIForNewRequest(query)) {\n      return\n    }\n\n    try {\n      await this.sendUserMessageAndSetPlanId(query)\n\n      if (this.state.activePlanId) {\n        this.initiatePlanExecutionSequence(query, this.state.activePlanId)\n      } else {\n        throw new Error('Failed to get valid plan ID')\n      }\n    } catch (error: unknown) {\n      console.error('[PlanExecutionManager] Failed to send user message:', error)\n      // Set UI state to enabled for error recovery\n      const errorPlanId = this.state.activePlanId ?? 'error'\n      this.setCachedUIState(errorPlanId, { enabled: true })\n\n      this.emitChatInputUpdateState(errorPlanId)\n      this.state.activePlanId = null\n    }\n  }\n\n  /**\n   * Handle plan execution request\n   */\n  public handlePlanExecutionRequested(planId: string, query?: string): void {\n    console.log('[PlanExecutionManager] Received plan execution request:', { planId, query })\n\n    if (planId) {\n      this.state.activePlanId = planId\n      this.initiatePlanExecutionSequence(query ?? 'Execute Plan', planId)\n    } else {\n      console.error('[PlanExecutionManager] Invalid plan execution request: missing planId')\n    }\n  }\n\n  /**\n   * Handle plan execution request with cache lookup by rootPlanId\n   */\n  public handleCachedPlanExecution(rootPlanId: string, query?: string): boolean {\n    const cachedRecord = this.getCachedPlanRecord(rootPlanId)\n\n    if (cachedRecord?.currentPlanId) {\n      console.log(\n        `[PlanExecutionManager] Found cached plan execution record for rootPlanId: ${rootPlanId}`\n      )\n      this.handlePlanExecutionRequested(cachedRecord.currentPlanId, query)\n      return true\n    } else {\n      console.log(\n        `[PlanExecutionManager] No cached plan execution record found for rootPlanId: ${rootPlanId}`\n      )\n      return false\n    }\n  }\n\n  /**\n   * Validate request and prepare UI\n   */\n  private validateAndPrepareUIForNewRequest(query: string): boolean {\n    if (!query) {\n      console.warn('[PlanExecutionManager] Query is empty')\n      return false\n    }\n\n    if (this.state.activePlanId) {\n      // There is already an active plan, cannot start new request\n      return false\n    }\n\n    // Clear input and set to disabled state\n    this.emitChatInputClear()\n\n    // Cache UI state data first\n    const uiStatePlanId = this.state.activePlanId ?? 'ui-state'\n    this.setCachedUIState(uiStatePlanId, { enabled: false, placeholder: 'Processing...' })\n    this.emitChatInputUpdateState(uiStatePlanId)\n\n    return true\n  }\n\n  /**\n   * Send user message and set plan ID\n   */\n  private async sendUserMessageAndSetPlanId(query: string): Promise<unknown> {\n    try {\n      // Use direct execution mode API to send message\n      const response = (await DirectApiService.sendMessage({\n        input: query,\n      })) as Record<string, unknown>\n\n      if (response?.planId) {\n        this.state.activePlanId = response.planId as string\n        return response\n      } else if (response?.planTemplateId) {\n        // If response contains planTemplateId instead of planId\n        this.state.activePlanId = response.planTemplateId as string\n        return { ...response, planId: response.planTemplateId }\n      }\n\n      console.error('[PlanExecutionManager] Failed to get planId from response:', response)\n      throw new Error('Failed to get valid planId from API response')\n    } catch (error: unknown) {\n      console.error('[PlanExecutionManager] API call failed:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Start plan execution sequence\n   */\n  public initiatePlanExecutionSequence(query: string, planId: string): void {\n    console.log(\n      `[PlanExecutionManager] Starting plan execution sequence for query: \"${query}\", planId: ${planId}`\n    )\n\n    // Use planId as rootPlanId for now (assume they are the same initially)\n    const rootPlanId = planId\n\n    // Mark task as running in task store\n    const taskStore = useTaskStore()\n    taskStore.setTaskRunning(planId)\n    console.log('[PlanExecutionManager] Task marked as running with planId:', planId)\n\n    // Try to emit dialog start\n    this.emitDialogRoundStart(rootPlanId)\n\n    this.startPolling()\n  }\n\n  /**\n   * Handle plan completion common logic\n   */\n  private handlePlanCompletion(details: PlanExecutionRecord): void {\n    this.emitPlanCompleted(details.rootPlanId ?? '')\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    const taskStore = useTaskStore()\n    if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n      taskStore.currentTask.isRunning = false\n      console.log('[PlanExecutionManager] Task marked as completed')\n    }\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(\n              `[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`\n            )\n          } catch (error: unknown) {\n            const message = error instanceof Error ? error.message : 'Unknown error'\n            console.log(`Delete plan execution record failed: ${message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: unknown) {\n      const message = error instanceof Error ? error.message : 'Unknown error'\n      console.log(`Delete plan execution record failed: ${message}`)\n    }\n\n    if (details.completed) {\n      this.state.activePlanId = null\n      this.emitChatInputUpdateState(details.rootPlanId ?? '')\n    }\n  }\n\n  private handlePlanError(details: PlanExecutionRecord): void {\n    this.emitPlanError(details.message ?? '')\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    const taskStore = useTaskStore()\n    if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n      taskStore.currentTask.isRunning = false\n      console.log('[PlanExecutionManager] Task marked as stopped due to error')\n    }\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(\n              `[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`\n            )\n          } catch (error: unknown) {\n            const message = error instanceof Error ? error.message : 'Unknown error'\n            console.log(`Delete plan execution record failed: ${message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: unknown) {\n      const message = error instanceof Error ? error.message : 'Unknown error'\n      console.log(`Delete plan execution record failed: ${message}`)\n    }\n  }\n\n  /**\n   * Poll plan execution status\n   */\n  private async pollPlanStatus(): Promise<void> {\n    if (!this.state.activePlanId) return\n\n    if (this.state.isPolling) {\n      console.log('[PlanExecutionManager] Previous polling still in progress, skipping')\n      return\n    }\n\n    try {\n      this.state.isPolling = true\n\n      // Here we need to implement the API call to get plan details\n      // Since the original code calls ManusAPI.getDetails, we need to use the existing API services\n      // For now, we'll use the relevant methods of PlanActApiService\n      const details = await this.getPlanDetails(this.state.activePlanId)\n\n      if (!details) {\n        console.warn(\n          '[PlanExecutionManager] No details received from API - this might be a temporary network issue'\n        )\n        return\n      }\n\n      // Only handle actual plan execution failures, not network errors\n      if (\n        details.status &&\n        details.status === 'failed' &&\n        details.message &&\n        !details.message.includes('Failed to get detailed information')\n      ) {\n        this.handlePlanError(details)\n        return\n      }\n\n      // Update cache with latest plan details if rootPlanId exists\n      if (details.rootPlanId) {\n        this.setCachedPlanRecord(details.rootPlanId, details)\n      }\n\n      this.emitPlanUpdate(details.rootPlanId ?? '')\n\n      if (details.completed) {\n        this.handlePlanCompletion(details)\n      }\n    } catch (error: unknown) {\n      console.error('[PlanExecutionManager] Failed to poll plan status:', error)\n    } finally {\n      this.state.isPolling = false\n    }\n  }\n\n  /**\n   * Get plan details (needs to be adjusted based on actual API)\n   */\n  private async getPlanDetails(planId: string): Promise<PlanExecutionRecord | null> {\n    try {\n      // Use CommonApiService's getDetails method\n      const details = await CommonApiService.getDetails(planId)\n\n      // Cache the plan execution record by rootPlanId if it exists\n      if (details?.rootPlanId) {\n        this.planExecutionCache.set(details.rootPlanId, details)\n        console.log(\n          `[PlanExecutionManager] Cached plan execution record for rootPlanId: ${details.rootPlanId}`\n        )\n      }\n\n      return details\n    } catch (error: unknown) {\n      console.error('[PlanExecutionManager] Failed to get plan details:', error)\n      const message = error instanceof Error ? error.message : 'Failed to get plan'\n      return {\n        currentPlanId: planId,\n        status: 'failed',\n        message: message,\n      }\n    }\n  }\n\n  /**\n   * Start polling plan execution status\n   */\n  public startPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n    }\n\n    this.state.pollTimer = window.setInterval(() => {\n      this.pollPlanStatus()\n    }, this.POLL_INTERVAL)\n\n    console.log('[PlanExecutionManager] Started polling')\n  }\n\n  /**\n   * Immediately poll plan execution status (for manual refresh trigger)\n   */\n  public async pollPlanStatusImmediately(): Promise<void> {\n    console.log('[PlanExecutionManager] Polling plan status immediately')\n    await this.pollPlanStatus()\n  }\n\n  /**\n   * Stop polling\n   */\n  public stopPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n      this.state.pollTimer = null\n    }\n    console.log('[PlanExecutionManager] Stopped polling')\n  }\n\n  /**\n   * Clean up resources\n   */\n  public cleanup(): void {\n    this.stopPolling()\n    this.state.activePlanId = null\n    this.state.lastSequenceSize = 0\n    this.state.isPolling = false\n\n    // Clear all cached plan execution records\n    this.clearAllCachedRecords()\n  }\n\n  // Event emission helpers - Use callback functions instead of window events\n  private emitChatInputClear(): void {\n    if (this.callbacks.onChatInputClear) {\n      this.callbacks.onChatInputClear()\n    }\n  }\n\n  private emitChatInputUpdateState(rootPlanId: string): void {\n    if (this.callbacks.onChatInputUpdateState) {\n      this.callbacks.onChatInputUpdateState(rootPlanId)\n    }\n  }\n\n  private emitDialogRoundStart(rootPlanId: string): void {\n    if (this.callbacks.onDialogRoundStart) {\n      this.callbacks.onDialogRoundStart(rootPlanId)\n    }\n  }\n\n  private emitPlanUpdate(rootPlanId: string): void {\n    if (this.callbacks.onPlanUpdate) {\n      this.callbacks.onPlanUpdate(rootPlanId)\n    }\n  }\n\n  private emitPlanCompleted(rootPlanId: string): void {\n    if (this.callbacks.onPlanCompleted) {\n      this.callbacks.onPlanCompleted(rootPlanId)\n    }\n  }\n\n  private emitPlanError(message: string): void {\n    if (this.callbacks.onPlanError) {\n      this.callbacks.onPlanError(message)\n    }\n  }\n}\n\n// Export singleton instance\nexport const planExecutionManager = PlanExecutionManager.getInstance()\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-container\">\n    <!-- Messages container -->\n    <div\n      class=\"messages\"\n      ref=\"messagesRef\"\n      @scroll=\"handleScroll\"\n      @click=\"handleMessageContainerClick\"\n    >\n      <!-- Message list -->\n      <ChatMessage\n        v-for=\"message in compatibleMessages\"\n        :key=\"message.id\"\n        :message=\"message\"\n        :is-streaming=\"isMessageStreaming(message.id)\"\n        @copy=\"handleCopyMessage\"\n        @regenerate=\"handleRegenerateMessage\"\n        @retry=\"handleRetryMessage\"\n        @step-selected=\"handleStepSelected\"\n      />\n\n      <!-- Loading indicator -->\n      <div v-if=\"isLoading\" class=\"loading-message\">\n        <div class=\"loading-content\">\n          <Icon icon=\"carbon:circle-dash\" class=\"loading-icon\" />\n          <span>{{ $t('chat.processing') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Scroll to bottom button -->\n    <Transition name=\"scroll-button\">\n      <button\n        v-if=\"showScrollToBottom\"\n        class=\"scroll-to-bottom\"\n        @click=\"() => scrollToBottom()\"\n        :title=\"$t('chat.scrollToBottom')\"\n      >\n        <Icon icon=\"carbon:chevron-down\" />\n      </button>\n    </Transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\n// Import new modular components\nimport ChatMessage from './ChatMessage.vue'\n\n// Import composables\nimport {\n  convertMessageToCompatible,\n  useChatMessages,\n  type ChatMessage as ChatMessageType,\n} from './composables/useChatMessages'\nimport { useScrollBehavior } from './composables/useScrollBehavior'\n\n// Import plan execution manager\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\n\ninterface Emits {\n  (e: 'step-selected', stepId: string): void\n}\n\n// InputMessage interface removed - not needed in display component\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\ninterface Props {}\n\ndefineProps<Props>()\n\nconst emit = defineEmits<Emits>()\n\n// Initialize composables\nconst { t } = useI18n()\n\n// Chat messages state\nconst {\n  messages,\n  isLoading,\n  streamingMessageId,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming,\n  findMessage,\n} = useChatMessages()\n\n// Scroll behavior\nconst messagesRef = ref<HTMLElement | null>(null)\nconst { scrollToBottom, autoScrollToBottom, showScrollToBottom } = useScrollBehavior(messagesRef)\n\n// Local state\nconst pollingInterval = ref<number>()\n\n// Computed properties\nconst isMessageStreaming = (messageId: string) => {\n  return streamingMessageId.value === messageId\n}\n\n// Convert messages to compatible format for ChatMessage component\nconst compatibleMessages = computed(() => {\n  return messages.value.map(convertMessageToCompatible)\n})\n\n// Event handlers\nconst handleScroll = () => {\n  // Scroll behavior is handled by useScrollBehavior composable\n}\n\nconst handleMessageContainerClick = (event: Event) => {\n  // Handle markdown copy buttons and other click events\n  const target = event.target as HTMLElement\n\n  if (target.classList.contains('md-copy-btn')) {\n    const rawText = target.getAttribute('data-raw')\n    if (rawText) {\n      const text = decodeURIComponent(rawText)\n      navigator.clipboard.writeText(text).then(() => {\n        // Show copy feedback\n        target.textContent = t('chat.copied')\n        setTimeout(() => {\n          target.textContent = t('chat.copy')\n        }, 1000)\n      })\n    }\n  }\n}\n\nconst handleCopyMessage = async (messageId: string) => {\n  const message = findMessage(messageId)\n  if (!message) return\n\n  try {\n    // Strip HTML tags for clipboard\n    const plainText = message.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    // Could add toast notification here\n  } catch (error) {\n    console.error('Failed to copy message:', error)\n  }\n}\n\nconst handleRegenerateMessage = (messageId: string) => {\n  // Implementation for regenerating assistant response\n  const message = findMessage(messageId)\n  if (message && message.type === 'assistant') {\n    // Reset message content and restart generation\n    updateMessage(messageId, {\n      content: '',\n    })\n    startStreaming(messageId)\n    // Trigger regeneration logic here\n  }\n}\n\nconst handleRetryMessage = (messageId: string) => {\n  // Implementation for retrying failed message\n  const message = findMessage(messageId)\n  if (message) {\n    updateMessage(messageId, {\n      content: '',\n    })\n    startStreaming(messageId)\n    // Trigger retry logic here\n  }\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[ChatContainer] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n\n// Message handling methods removed - ChatContainer is now a pure display component\n\n// Plan execution handlers\nconst handlePlanUpdate = (rootPlanId: string) => {\n  console.log('[ChatContainer] Plan update received:', rootPlanId)\n\n  // Get the PlanExecutionRecord from the cache\n  const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n\n  if (!planDetails) {\n    console.warn('[ChatContainer] No cached plan data found for rootPlanId:', rootPlanId)\n    return\n  }\n\n  console.log('[ChatContainer] Retrieved plan details from cache:', planDetails)\n\n  // Find the corresponding message\n  const messageIndex = messages.value.findIndex(\n    m => m.planExecution?.currentPlanId === planDetails.currentPlanId && m.type === 'assistant'\n  )\n\n  if (messageIndex !== -1) {\n    const message = messages.value[messageIndex]\n\n    // Update planExecution data using updateMessage\n    const updates: Partial<ChatMessageType> = {\n      planExecution: JSON.parse(JSON.stringify(planDetails)),\n    }\n\n    // Handle simple responses (cases without agent execution sequence)\n    if (!planDetails.agentExecutionSequence || planDetails.agentExecutionSequence.length === 0) {\n      console.log('[ChatContainer] Handling simple response without agent execution sequence')\n\n      if (planDetails.completed) {\n        // Clear thinking state and set final response\n        updates.thinking = ''\n        const finalResponse =\n          planDetails.summary ?? planDetails.result ?? planDetails.message ?? 'Execution completed'\n        updates.content = finalResponse\n        console.log('[ChatContainer] Set simple response content:', finalResponse)\n      }\n    } else {\n      console.log('[ChatContainer] Handling detailed plan with agent execution sequence')\n      // This is a detailed plan with execution steps, keep the plan execution display\n    }\n\n    // Update the message\n    updateMessage(message.id, updates)\n  }\n}\n\nconst handlePlanCompleted = (planDetails: unknown) => {\n  console.log('[ChatContainer] Plan completed:', planDetails)\n\n  if (\n    planDetails &&\n    typeof planDetails === 'object' &&\n    'rootPlanId' in planDetails &&\n    planDetails.rootPlanId\n  ) {\n    const planDetailsObj = planDetails as Record<string, unknown>\n    const rootPlanId = planDetailsObj.rootPlanId as string\n    const messageIndex = messages.value.findIndex(\n      m => m.planExecution?.currentPlanId === rootPlanId\n    )\n\n    if (messageIndex !== -1) {\n      const message = messages.value[messageIndex]\n\n      const summary =\n        (planDetailsObj.summary as string) ??\n        (planDetailsObj.result as string) ??\n        'Execution completed'\n      updateMessage(message.id, {\n        thinking: '',\n        content: summary,\n      })\n      console.log('[ChatContainer] Updated completed message:', summary)\n    }\n  }\n}\n\nconst handleDialogRoundStart = (planId: string) => {\n  console.log('[ChatContainer] Dialog round start:', planId)\n  // This method can be used to initialize plan execution state\n}\n\nconst handlePlanError = (message: string) => {\n  console.log('[ChatContainer] Plan error:', message)\n\n  // Show error message\n  addMessage('assistant', `Error: ${message}`)\n  console.error('[ChatContainer] Plan execution error:', message)\n}\n\n// Scroll handlers (remove unused function)\n\n// Lifecycle\nonMounted(() => {\n  // Initial prompt processing removed - handled by parent component\n\n  // Auto-scroll to bottom when new messages are added\n  watch(\n    messages,\n    () => {\n      nextTick(() => {\n        autoScrollToBottom()\n      })\n    },\n    { deep: true }\n  )\n\n  // Register plan execution callbacks\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: handlePlanUpdate,\n    onPlanCompleted: handlePlanCompleted,\n    onDialogRoundStart: handleDialogRoundStart,\n    onPlanError: handlePlanError,\n  })\n})\n\nonUnmounted(() => {\n  if (pollingInterval.value) {\n    clearInterval(pollingInterval.value)\n  }\n})\n\n// Expose methods for parent components\ndefineExpose({\n  scrollToBottom,\n  handlePlanUpdate,\n  handlePlanCompleted,\n  handleDialogRoundStart,\n  handlePlanError,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n  background: #1a1a1a;\n\n  .messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    scroll-behavior: smooth;\n\n    // Custom scrollbar\n    &::-webkit-scrollbar {\n      width: 6px;\n    }\n\n    &::-webkit-scrollbar-track {\n      background: rgba(255, 255, 255, 0.1);\n      border-radius: 3px;\n    }\n\n    &::-webkit-scrollbar-thumb {\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 3px;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.5);\n      }\n    }\n  }\n\n  .loading-message {\n    display: flex;\n    justify-content: center;\n    padding: 20px;\n\n    .loading-content {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      color: #aaaaaa;\n      font-size: 14px;\n\n      .loading-icon {\n        font-size: 16px;\n        animation: spin 1s linear infinite;\n      }\n    }\n  }\n\n  .scroll-to-bottom {\n    position: absolute;\n    bottom: 30px;\n    right: 30px;\n    width: 40px;\n    height: 40px;\n    background: rgba(79, 70, 229, 0.9);\n    border: none;\n    border-radius: 50%;\n    color: #ffffff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n    z-index: 10;\n\n    &:hover {\n      background: rgba(79, 70, 229, 1);\n      transform: scale(1.1);\n    }\n\n    svg {\n      font-size: 20px;\n    }\n  }\n}\n\n// Transitions\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@media (max-width: 768px) {\n  .chat-container {\n    .messages {\n      padding: 16px;\n    }\n\n    .scroll-to-bottom {\n      bottom: 20px;\n      right: 20px;\n      width: 36px;\n      height: 36px;\n\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * File information interface matching FileUploadResult.FileInfo from Java\n */\nexport interface FileInfo {\n  originalName: string\n  size: number\n  type: string\n  uploadTime: string\n  success: boolean\n  error?: string\n}\n\n/**\n * File upload result interface matching FileUploadResult from Java\n */\nexport interface FileUploadResult {\n  success: boolean\n  message: string\n  uploadKey: string\n  uploadedFiles: FileInfo[]\n  totalFiles: number\n  successfulFiles: number\n  failedFiles: number\n}\n\n/**\n * Get uploaded files response interface\n */\nexport interface GetUploadedFilesResponse {\n  success: boolean\n  uploadKey: string\n  files: FileInfo[]\n  totalCount: number\n}\n\n/**\n * Delete file response interface\n */\nexport interface DeleteFileResponse {\n  success: boolean\n  message?: string\n  error?: string\n  uploadKey: string\n  fileName: string\n}\n\n/**\n * Upload configuration interface\n */\nexport interface UploadConfig {\n  success: boolean\n  maxFileSize: string\n  maxFiles: number\n  allowedTypes: string[]\n}\n\nexport class FileUploadApiService {\n  /**\n   * Upload files\n   * @param files Files to upload\n   * @returns FileUploadResult with upload information\n   */\n  public static async uploadFiles(files: File[]): Promise<FileUploadResult> {\n    try {\n      console.log('[FileUploadApiService] Uploading files:', files.length)\n\n      const formData = new FormData()\n      files.forEach(file => {\n        formData.append('files', file)\n      })\n\n      const response = await fetch('/api/file-upload/upload', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: FileUploadResult = await response.json()\n      console.log(\n        '[FileUploadApiService] Files uploaded successfully:',\n        result.successfulFiles,\n        'uploadKey:',\n        result.uploadKey\n      )\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error uploading files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get uploaded files for a specific upload key\n   * @param uploadKey Upload key to get files for\n   * @returns GetUploadedFilesResponse with file information\n   */\n  public static async getUploadedFiles(uploadKey: string): Promise<GetUploadedFilesResponse> {\n    try {\n      console.log('[FileUploadApiService] Getting uploaded files for uploadKey:', uploadKey)\n\n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}`)\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: GetUploadedFilesResponse = await response.json()\n      console.log(\n        '[FileUploadApiService] Got uploaded files:',\n        result.totalCount,\n        'for uploadKey:',\n        uploadKey\n      )\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting uploaded files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete an uploaded file from a specific upload key directory\n   * @param uploadKey Upload key directory\n   * @param fileName File name to delete\n   * @returns DeleteFileResponse with deletion result\n   */\n  public static async deleteFile(uploadKey: string, fileName: string): Promise<DeleteFileResponse> {\n    try {\n      console.log('[FileUploadApiService] Deleting file:', fileName, 'from uploadKey:', uploadKey)\n\n      const response = await fetch(\n        `/api/file-upload/files/${encodeURIComponent(uploadKey)}/${encodeURIComponent(fileName)}`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: DeleteFileResponse = await response.json()\n      console.log('[FileUploadApiService] File deleted successfully:', result.success)\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error deleting file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get upload configuration and limits\n   * @returns UploadConfig with configuration information\n   */\n  public static async getUploadConfig(): Promise<UploadConfig> {\n    try {\n      console.log('[FileUploadApiService] Getting upload configuration')\n\n      const response = await fetch('/api/file-upload/config')\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: UploadConfig = await response.json()\n      console.log('[FileUploadApiService] Got upload configuration:', result)\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting upload configuration:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"file-upload-component\">\n    <!-- Hidden file input -->\n    <input\n      ref=\"fileInputRef\"\n      type=\"file\"\n      multiple\n      style=\"display: none\"\n      @change=\"handleFileChange\"\n      :accept=\"acceptedFileTypes || ''\"\n    />\n\n    <!-- Uploaded files display with integrated upload button -->\n    <div class=\"uploaded-files\" :class=\"{ 'has-files': uploadedFiles.length > 0 }\">\n      <div class=\"files-header\" @click=\"handleFileUpload\">\n        <Icon icon=\"carbon:attachment\" />\n        <span v-if=\"uploadedFiles.length === 0\">{{ t('input.attachFile') }}</span>\n        <span v-else>{{ t('input.attachedFiles') }} ({{ uploadedFiles.length }})</span>\n      </div>\n      <div v-if=\"uploadedFiles.length > 0\" class=\"files-list\">\n        <div v-for=\"file in uploadedFiles\" :key=\"file.originalName\" class=\"file-item\">\n          <Icon icon=\"carbon:document\" class=\"file-icon\" />\n          <span class=\"file-name\">{{ file.originalName }}</span>\n          <span class=\"file-size\">({{ formatFileSize(file.size) }})</span>\n          <button @click=\"removeFile(file)\" class=\"remove-btn\" :title=\"t('input.removeFile')\">\n            <Icon icon=\"carbon:close\" />\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Upload progress indicator -->\n    <div v-if=\"isUploading\" class=\"upload-progress\">\n      <Icon icon=\"carbon:rotate--clockwise\" class=\"loading-icon\" />\n      <span>{{ t('input.uploading') }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport {\n  FileInfo,\n  FileUploadApiService,\n  type DeleteFileResponse,\n  type FileUploadResult,\n} from '@/api/file-upload-api-service'\n\nconst { t } = useI18n()\n\ntype FileUploadProps = {\n  acceptedFileTypes?: string\n  disabled?: boolean\n}\n\ninterface Emits {\n  (e: 'files-uploaded', files: FileInfo[], uploadKey: string | null): void\n  (e: 'files-removed', files: FileInfo[]): void\n  (e: 'upload-key-changed', uploadKey: string | null): void\n  (e: 'upload-started'): void\n  (e: 'upload-completed'): void\n  (e: 'upload-error', error: unknown): void\n}\n\nconst props = withDefaults(defineProps<FileUploadProps>(), {\n  acceptedFileTypes:\n    '.pdf,.txt,.md,.doc,.docx,.csv,.xlsx,.xls,.json,.xml,.html,.htm,.log,.java,.py,.js,.ts,.sql,.sh,.bat,.yaml,.yml,.properties,.conf,.ini,.jpg,.jpeg,.png,.gif',\n  disabled: false,\n})\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst fileInputRef = ref<HTMLInputElement>()\nconst uploadedFiles = ref<FileInfo[]>([])\nconst isUploading = ref(false)\nconst uploadKey = ref<string | null>(null)\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  uploadedFiles.value = []\n  uploadKey.value = null\n  emit('upload-key-changed', null)\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n\n// Watch for file changes to emit events\nwatch(\n  () => uploadedFiles.value,\n  newFiles => {\n    emit('files-removed', newFiles)\n  },\n  { deep: true }\n)\n\n// File upload handlers\nconst handleFileUpload = () => {\n  if (props.disabled) return\n  if (fileInputRef.value) {\n    fileInputRef.value.click()\n  }\n}\n\nconst handleFileChange = async (event: Event) => {\n  const target = event.target as HTMLInputElement\n  const files = target.files\n\n  if (!files || files.length === 0) return\n\n  // Convert FileList to Array and add to pending files (for batch upload)\n  const fileArray = Array.from(files)\n  console.log(\n    '[FileUpload] Selected files for upload:',\n    fileArray.map(f => f.name)\n  )\n\n  // Immediately upload all selected files\n  await uploadFiles(fileArray)\n\n  // Reset file input\n  target.value = ''\n}\n\nconst uploadFiles = async (files: File[]) => {\n  if (files.length === 0) return\n\n  isUploading.value = true\n  emit('upload-started')\n\n  try {\n    // Upload files using the new API service\n    const result: FileUploadResult = await FileUploadApiService.uploadFiles(files)\n\n    if (result.success) {\n      // Set uploadKey for file management\n      if (!uploadKey.value && result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[FileUpload] Set uploadKey:', uploadKey.value)\n        // New upload session - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      } else if (uploadKey.value) {\n        console.log('[FileUpload] Using existing uploadKey:', uploadKey.value)\n        // Existing upload session - append to existing files\n        uploadedFiles.value = [...uploadedFiles.value, ...result.uploadedFiles]\n      } else {\n        console.warn('[FileUpload] No uploadKey returned from upload')\n        // Fallback - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      }\n\n      // Save uploadKey locally\n      if (result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[Input] Saved uploadKey locally:', result.uploadKey)\n        emit('upload-key-changed', uploadKey.value)\n      }\n\n      console.log('[Input] Updated global uploadedFiles state:', uploadedFiles.value)\n\n      // Emit files uploaded event\n      emit('files-uploaded', uploadedFiles.value, uploadKey.value)\n    }\n\n    // Show success message or update UI as needed\n    console.log('Files uploaded successfully:', result)\n    emit('upload-completed')\n  } catch (error) {\n    console.error('File upload error:', error)\n    emit('upload-error', error)\n  } finally {\n    isUploading.value = false\n  }\n}\n\n// File management functions\nconst removeFile = async (fileToRemove: FileInfo) => {\n  try {\n    console.log(' Removing file:', fileToRemove.originalName, 'from uploadKey:', uploadKey)\n\n    // Call backend API to delete the file from the server\n    if (uploadKey.value) {\n      const result: DeleteFileResponse = await FileUploadApiService.deleteFile(\n        uploadKey.value,\n        fileToRemove.originalName\n      )\n      if (result.success) {\n        console.log(' File deleted from server successfully')\n      } else {\n        console.error(' Failed to delete file from server:', result.error)\n      }\n    }\n\n    // Update frontend state\n    uploadedFiles.value = uploadedFiles.value.filter(\n      file => file.originalName !== fileToRemove.originalName\n    )\n\n    // Clear uploadKey to force new plan for new files if no files remain\n    if (uploadedFiles.value.length === 0) {\n      console.log('[FileUpload]  Clearing uploadKey to force new plan for new files')\n      uploadKey.value = null\n      emit('upload-key-changed', null)\n    }\n\n    console.log(' File removal completed, remaining files:', uploadedFiles.value.length)\n  } catch (error) {\n    console.error(' Error removing file:', error)\n    emit('upload-error', error)\n  }\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// Expose methods and state to parent component\ndefineExpose({\n  uploadedFiles,\n  uploadKey,\n  resetSession,\n  uploadFiles,\n  removeFile,\n  isUploading,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.file-upload-component {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n/* File upload styles */\n.uploaded-files {\n  padding: 8px;\n  border-radius: 8px;\n  transition: all 0.2s ease;\n  width: 100%;\n  box-sizing: border-box;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n\n  &.has-files {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.15);\n  }\n}\n\n.files-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  font-weight: 500;\n  cursor: pointer;\n  padding: 4px 2px;\n  transition: all 0.2s ease;\n  user-select: none;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #007acc;\n  }\n\n  &:active {\n    transform: translateY(1px);\n  }\n}\n\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.file-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.file-icon {\n  font-size: 14px;\n  color: #007acc;\n  flex-shrink: 0;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #ffffff;\n  font-weight: 500;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.file-size {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  flex-shrink: 0;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  padding: 2px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.5);\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  flex-shrink: 0;\n\n  &:hover {\n    color: #ff6b6b;\n    background: rgba(255, 107, 107, 0.1);\n  }\n}\n\n.upload-progress {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: rgba(0, 122, 204, 0.1);\n  border-radius: 6px;\n  border: 1px solid rgba(0, 122, 204, 0.2);\n  font-size: 12px;\n  color: #007acc;\n}\n\n.loading-icon {\n  font-size: 14px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2024-2026 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { reactive } from 'vue'\n\nexport interface MemoryEmits {\n  (e: 'memory-selected'): void\n}\n\nexport interface InputMessage {\n  input: string\n  memoryId?: string\n  uploadedFiles?: string[]\n  uploadKey?: string\n}\n\nexport class MemoryStore {\n  // Basic state\n  isCollapsed = false\n  selectMemoryId = ''\n  loadMessages = () => {}\n  intervalId: number | undefined = undefined\n\n  toggleSidebar() {\n    this.isCollapsed = !this.isCollapsed\n    if (this.isCollapsed) {\n      this.loadMessages()\n      this.intervalId = window.setInterval(() => {\n        this.loadMessages()\n      }, 3000)\n    } else {\n      clearInterval(this.intervalId)\n    }\n  }\n\n  selectMemory(memoryId: string) {\n    this.toggleSidebar()\n    this.selectMemoryId = memoryId\n  }\n\n  setMemory(memoryId: string) {\n    this.selectMemoryId = memoryId\n  }\n\n  defaultMemoryId() {\n    this.selectMemoryId = this.generateRandomId()\n  }\n\n  clearMemoryId() {\n    this.selectMemoryId = ''\n  }\n\n  generateRandomId(): string {\n    return Math.random().toString(36).substring(2, 10)\n  }\n\n  setLoadMessages(messages: () => void) {\n    this.loadMessages = messages\n  }\n}\n\nexport const memoryStore = reactive(new MemoryStore())\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"input-area\">\n    <!-- File upload component at the top, full width -->\n    <FileUploadComponent\n      ref=\"fileUploadRef\"\n      :disabled=\"isDisabled\"\n      @files-uploaded=\"handleFilesUploaded\"\n      @files-removed=\"handleFilesRemoved\"\n      @upload-key-changed=\"handleUploadKeyChanged\"\n      @upload-started=\"handleUploadStarted\"\n      @upload-completed=\"handleUploadCompleted\"\n      @upload-error=\"handleUploadError\"\n    />\n\n    <div class=\"input-container\">\n      <!-- First line: User input form -->\n      <div class=\"input-row-first\">\n        <textarea\n          v-model=\"currentInput\"\n          ref=\"inputRef\"\n          class=\"chat-input\"\n          :placeholder=\"currentPlaceholder\"\n          :disabled=\"isDisabled\"\n          @keydown=\"handleKeydown\"\n          @input=\"adjustInputHeight\"\n        ></textarea>\n      </div>\n\n      <!-- Second line: Selection input, Func-Agent mode and send button -->\n      <div class=\"input-row-second\">\n        <select\n          v-model=\"selectedOption\"\n          class=\"selection-input\"\n          :title=\"$t('input.selectionTitle')\"\n          :disabled=\"isLoadingTools || isDisabled\"\n        >\n          <option value=\"\">{{ $t('input.defaultFuncAgent') }}</option>\n          <option v-for=\"option in selectionOptions\" :key=\"option.value\" :value=\"option.value\">\n            {{ option.label }}\n          </option>\n        </select>\n        <button class=\"plan-mode-btn\" :title=\"$t('input.planMode')\" @click=\"handlePlanModeClick\">\n          <Icon icon=\"carbon:document\" />\n          {{ $t('input.planMode') }}\n        </button>\n        <button\n          v-if=\"!isTaskRunning\"\n          class=\"send-button\"\n          :disabled=\"!currentInput.trim() || isDisabled\"\n          @click=\"handleSend\"\n          :title=\"$t('input.send')\"\n        >\n          <Icon icon=\"carbon:send-alt\" />\n          {{ $t('input.send') }}\n        </button>\n        <button\n          v-else\n          class=\"send-button stop-button\"\n          @click=\"handleStop\"\n          :title=\"$t('input.stop')\"\n        >\n          <Icon icon=\"carbon:stop-filled\" />\n          {{ $t('input.stop') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { CoordinatorToolApiService } from '@/api/coordinator-tool-api-service'\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport type { InputMessage } from '@/stores/memory'\nimport { memoryStore } from '@/stores/memory'\nimport { useTaskStore } from '@/stores/task'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\nconst taskStore = useTaskStore()\n\n// Track if task is running\nconst isTaskRunning = computed(() => taskStore.hasRunningTask())\n\ninterface Props {\n  placeholder?: string\n  disabled?: boolean\n  initialValue?: string\n  selectionOptions?: Array<{ value: string; label: string }>\n}\n\ninterface InnerToolOption {\n  value: string\n  label: string\n  toolName: string\n  planTemplateId: string\n  paramName: string\n}\n\ninterface Emits {\n  (e: 'send', message: InputMessage): void\n  (e: 'clear'): void\n  (e: 'update-state', enabled: boolean, placeholder?: string): void\n  (e: 'plan-mode-clicked'): void\n  (e: 'selection-changed', value: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: '',\n  disabled: false,\n  initialValue: '',\n  selectionOptions: () => [],\n})\n\nconst emit = defineEmits<Emits>()\n\nconst inputRef = ref<HTMLTextAreaElement>()\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst currentInput = ref('')\nconst defaultPlaceholder = computed(() => props.placeholder || t('input.placeholder'))\nconst currentPlaceholder = ref(defaultPlaceholder.value)\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\nconst selectedOption = ref('')\nconst innerToolOptions = ref<InnerToolOption[]>([])\nconst isLoadingTools = ref(false)\n\n// Load inner tools with single parameter\nconst loadInnerTools = async () => {\n  isLoadingTools.value = true\n  try {\n    console.log('[InputArea] Loading inner tools...')\n    const allTools = await CoordinatorToolApiService.getAllCoordinatorTools()\n\n    // Filter tools: enableInternalToolcall=true and exactly one parameter\n    const filteredTools: InnerToolOption[] = []\n\n    for (const tool of allTools) {\n      // Check if it's an internal toolcall\n      if (!tool.enableInternalToolcall) {\n        continue\n      }\n\n      // Parse inputSchema to count parameters\n      try {\n        const inputSchema = JSON.parse(tool.inputSchema || '[]')\n        if (Array.isArray(inputSchema) && inputSchema.length === 1) {\n          // Exactly one parameter\n          const param = inputSchema[0]\n          filteredTools.push({\n            value: tool.planTemplateId,\n            label: `${tool.toolName} (${param.name})`,\n            toolName: tool.toolName,\n            planTemplateId: tool.planTemplateId,\n            paramName: param.name,\n          })\n        }\n      } catch (e) {\n        console.warn('[InputArea] Failed to parse inputSchema for tool:', tool.toolName, e)\n      }\n    }\n\n    innerToolOptions.value = filteredTools\n    console.log('[InputArea] Loaded', filteredTools.length, 'inner tools with single parameter')\n\n    // Restore selected tool from localStorage and validate it still exists\n    const savedTool = localStorage.getItem('inputAreaSelectedTool')\n    if (savedTool) {\n      const toolExists = filteredTools.some(tool => tool.value === savedTool)\n      if (toolExists) {\n        selectedOption.value = savedTool\n        console.log('[InputArea] Restored selected tool from localStorage:', savedTool)\n      } else {\n        console.log('[InputArea] Saved tool no longer available, clearing selection')\n        localStorage.removeItem('inputAreaSelectedTool')\n        selectedOption.value = ''\n      }\n    }\n  } catch (error) {\n    console.error('[InputArea] Failed to load inner tools:', error)\n    innerToolOptions.value = []\n  } finally {\n    isLoadingTools.value = false\n  }\n}\n\n// Computed property for selection options (use inner tools if available, otherwise use props)\nconst selectionOptions = computed(() => {\n  if (innerToolOptions.value.length > 0) {\n    return innerToolOptions.value.map(tool => ({\n      value: tool.value,\n      label: tool.label,\n    }))\n  }\n  return props.selectionOptions\n})\n\n// Watch for selection changes and persist to localStorage\nwatch(selectedOption, newValue => {\n  emit('selection-changed', newValue)\n  // Save to localStorage\n  localStorage.setItem('inputAreaSelectedTool', newValue || '')\n})\n\n// Load inner tools on mount\nonMounted(() => {\n  loadInnerTools()\n})\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  fileUploadRef.value?.resetSession()\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[InputArea] Files uploaded:', files.length, 'uploadKey:', key)\n\n  // Update placeholder to show files are attached\n  if (uploadedFiles.value.length > 0) {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[InputArea] Files removed, remaining:', files.length)\n\n  // Update placeholder\n  if (uploadedFiles.value.length === 0) {\n    currentPlaceholder.value = defaultPlaceholder.value\n  } else {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[InputArea] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[InputArea] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[InputArea] Upload completed')\n}\n\nconst handleUploadError = (error: unknown) => {\n  console.error('[InputArea] Upload error:', error)\n}\n\n// Computed property to ensure 'disabled' is a boolean type\nconst isDisabled = computed(() => Boolean(props.disabled))\n\nconst adjustInputHeight = () => {\n  nextTick(() => {\n    if (inputRef.value) {\n      inputRef.value.style.height = 'auto'\n      inputRef.value.style.height = Math.min(inputRef.value.scrollHeight, 120) + 'px'\n    }\n  })\n}\n\nconst handleKeydown = (event: KeyboardEvent) => {\n  if (event.key === 'Enter' && !event.shiftKey) {\n    event.preventDefault()\n    handleSend()\n  }\n}\n\nconst handleSend = async () => {\n  if (!currentInput.value.trim() || isDisabled.value) return\n\n  const finalInput = currentInput.value.trim()\n\n  // Prepare query with tool information if selected\n  const query: InputMessage = {\n    input: finalInput,\n    memoryId: memoryStore.selectMemoryId,\n    uploadedFiles: uploadedFiles.value,\n  }\n\n  // Add uploadKey if it exists\n  if (uploadKey.value) {\n    query.uploadKey = uploadKey.value\n    console.log('[InputArea] Including uploadKey in message:', uploadKey.value)\n  } else {\n    console.log('[InputArea] No uploadKey available for message')\n  }\n\n  // Check if a tool is selected\n  if (selectedOption.value) {\n    const selectedTool = innerToolOptions.value.find(tool => tool.value === selectedOption.value)\n\n    if (selectedTool) {\n      // Add tool information to query for backend processing\n      // This will be handled by handleChatSendMessage which will call executeByToolName\n      const extendedQuery = query as InputMessage & {\n        toolName?: string\n        replacementParams?: Record<string, string>\n      }\n      extendedQuery.toolName = selectedTool.planTemplateId\n      extendedQuery.replacementParams = {\n        [selectedTool.paramName]: finalInput,\n      }\n      console.log('[InputArea] Sending message with tool:', selectedTool.toolName)\n    }\n  }\n\n  // Use Vue's emit to send a message (this will trigger handleChatSendMessage which shows assistant message)\n  emit('send', query)\n\n  // Clear the input but keep uploaded files and uploadKey for follow-up conversations\n  clearInput()\n}\n\nconst handlePlanModeClick = () => {\n  // Trigger the plan mode toggle event\n  emit('plan-mode-clicked')\n}\n\nconst handleStop = async () => {\n  console.log('[InputArea] Stop button clicked')\n  const success = await taskStore.stopCurrentTask()\n  if (success) {\n    console.log('[InputArea] Task stopped successfully')\n  } else {\n    console.error('[InputArea] Failed to stop task')\n  }\n}\n\n/**\n * Clear the input box\n */\nconst clearInput = () => {\n  currentInput.value = ''\n  adjustInputHeight()\n  emit('clear')\n}\n\n/**\n * Update the state of the input area (enable/disable)\n * @param {boolean} enabled - Whether to enable input\n * @param {string} [placeholder] - Placeholder text when enabled\n */\nconst updateState = (enabled: boolean, placeholder?: string) => {\n  if (placeholder) {\n    currentPlaceholder.value = enabled ? placeholder : t('input.waiting')\n  }\n  emit('update-state', enabled, placeholder)\n}\n\n/**\n * Set the input value without triggering send\n * @param {string} value - The value to set\n */\nconst setInputValue = (value: string) => {\n  currentInput.value = value\n  adjustInputHeight()\n}\n\n/**\n * Get the current value of the input box\n * @returns {string} The text value of the current input box (trimmed)\n */\nconst getQuery = () => {\n  return currentInput.value.trim()\n}\n\n// Watch for initialValue changes\nwatch(\n  () => props.initialValue,\n  newValue => {\n    if (newValue.trim()) {\n      currentInput.value = newValue\n      adjustInputHeight()\n    }\n  },\n  { immediate: true }\n)\n\n// Expose methods to the parent component\ndefineExpose({\n  clearInput,\n  updateState,\n  setInputValue,\n  getQuery,\n  resetSession,\n  focus: () => inputRef.value?.focus(),\n  get uploadedFiles() {\n    return fileUploadRef.value?.uploadedFiles?.map(f => f.originalName) || []\n  },\n  get uploadKey() {\n    return fileUploadRef.value?.uploadKey || null\n  },\n})\n\nonMounted(() => {\n  // Initialization logic after component mounting\n})\n\nonUnmounted(() => {\n  // Cleanup logic before component unmounting\n})\n</script>\n\n<style lang=\"less\" scoped>\n.input-area {\n  min-height: 112px;\n  padding: 10px 12px;\n  border-top: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n  /* Ensure the input area is always at the bottom */\n  flex-shrink: 0; /* Won't be compressed */\n  position: sticky; /* Fixed at the bottom */\n  bottom: 0;\n  z-index: 100;\n  /* Add a slight shadow to distinguish the message area */\n  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);\n  backdrop-filter: blur(20px);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.input-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 12px 16px;\n\n  &:focus-within {\n    border-color: #667eea;\n  }\n}\n\n.input-row-first {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.input-row-second {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n.selection-input {\n  flex-shrink: 0;\n  padding: 6px 8px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  outline: none;\n  width: 24ch;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.3);\n  }\n\n  &:focus {\n    border-color: #667eea;\n    background: rgba(255, 255, 255, 0.08);\n  }\n\n  option {\n    background: #1a1a1a;\n    color: #ffffff;\n    white-space: normal;\n    padding: 4px 8px;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n}\n\n.chat-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 1.5;\n  resize: none;\n  min-height: 20px;\n  max-height: 120px;\n\n  &::placeholder {\n    color: #666666;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n\n    &::placeholder {\n      color: #444444;\n    }\n  }\n}\n\n.plan-mode-btn {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: #667eea;\n    transform: translateY(-1px);\n  }\n}\n\n.send-button {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 6px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    transform: translateY(-1px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  &.stop-button {\n    background: linear-gradient(135deg, #f56565 0%, #c53030 100%);\n\n    &:hover {\n      background: linear-gradient(135deg, #fc8181 0%, #e53e3e 100%);\n    }\n  }\n}\n\n.clear-memory-btn {\n  width: 1.5em;\n  height: 1.5em;\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Memory {\n  id: number\n  conversation_id: string\n  memory_name: string\n  create_time: string\n  messages?: MessageBubble[]\n}\n\nexport interface MemoryResponse {\n  success: boolean\n  message: string\n  data?: Memory\n  memories?: Memory[]\n  total_count?: number\n  response_time: string\n}\n\nexport interface MessageBubble {\n  messageType: string\n  text: string\n}\n\nexport class MemoryApiService {\n  private static readonly BASE_URL = '/api/memories'\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  static async getMemories(): Promise<Memory[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      return data.memories ?? []\n    } catch (error) {\n      console.error('Failed to get memory list:', error)\n      throw error\n    }\n  }\n\n  static async getMemory(conversationId: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/single?conversationId=${conversationId}`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Memory not found')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to get memory:', error)\n      throw error\n    }\n  }\n\n  static async createMemory(conversationId: string, memoryName: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          conversation_id: conversationId,\n          memory_name: memoryName,\n        }),\n      })\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to create memory')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to create memory:', error)\n      throw error\n    }\n  }\n\n  static async updateMemory(conversationId: string, memoryName: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          conversation_id: conversationId,\n          memory_name: memoryName,\n        }),\n      })\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to update memory')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to update memory:', error)\n      throw error\n    }\n  }\n\n  static async deleteMemory(conversationId: string): Promise<void> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${conversationId}`, {\n        method: 'DELETE',\n      })\n      await this.handleResponse(response)\n    } catch (error) {\n      console.error('Failed to delete memory:', error)\n      throw error\n    }\n  }\n\n  static async generateConversationId(): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/generate-id`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to generate conversation ID')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to generate conversation ID:', error)\n      throw error\n    }\n  }\n}\n","<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div class=\"app-container\" v-if=\"memoryStore.isCollapsed\">\n        <div class=\"app-content\">\n          <div class=\"header\">\n            <div class=\"relative\">\n              <div class=\"title-edit-group\">\n                <h1 id=\"main-title\" class=\"main-title\">\n                  <span>{{ $t('memory.title') }}</span>\n                </h1>\n              </div>\n\n              <div\n                id=\"title-edit-container\"\n                class=\"title-edit-container\"\n                v-if=\"showTitleEdit\"\n              ></div>\n            </div>\n            <button class=\"close-btn\" @click=\"memoryStore.toggleSidebar()\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n\n          <div class=\"search-bar\">\n            <div class=\"search-container\">\n              <Icon class=\"search-container-icon\" icon=\"carbon:search\" />\n              <input\n                type=\"text\"\n                :placeholder=\"$t('memory.searchPlaceholder')\"\n                class=\"search-input\"\n                v-model=\"searchQuery\"\n                @input=\"handleSearch\"\n              />\n            </div>\n          </div>\n\n          <div class=\"message-list\" id=\"message-list\">\n            <div>\n              <div\n                class=\"message-item\"\n                v-for=\"message in filteredMessages\"\n                :key=\"message.conversation_id\"\n                :class=\"{ expanded: message.expanded }\"\n              >\n                <div class=\"message-header\">\n                  <div class=\"message-content\">\n                    <div class=\"sender-info\">\n                      <div class=\"sender-div\" @click.stop=\"selectMemory(message.conversation_id)\">\n                        <h3 class=\"sender-name\">\n                          {{ message.memory_name }}\n                        </h3>\n                      </div>\n\n                      <div\n                        class=\"toggle-container\"\n                        @click.stop=\"\n                          showNameEditModal(message.conversation_id, message.memory_name)\n                        \"\n                      >\n                        <Icon icon=\"carbon:edit\" class=\"edit-btn\"> </Icon>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                          class=\"delete-btn\"\n                          @click.stop=\"toggleMessage(message.conversation_id)\"\n                        >\n                          <Icon\n                            :id=\"'toggle-' + message.conversation_id\"\n                            icon=\"carbon:chevron-down\"\n                            class=\"down-btn\"\n                          ></Icon>\n                        </button>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                          class=\"delete-btn\"\n                          @click.stop=\"showDeleteConfirm(message.conversation_id)\"\n                        >\n                          <Icon icon=\"carbon:delete\"></Icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <div class=\"message-preview\">\n                      <p class=\"preview-line\">\n                        {{\n                          message.messages && message.messages.length > 0\n                            ? message.messages[0].text\n                            : 'none message'\n                        }}\n                      </p>\n                      <p\n                        class=\"preview-line\"\n                        style=\"opacity: 0.8\"\n                        v-if=\"message.messages && message.messages.length > 1\"\n                      >\n                        {{ message.messages[1].text }}\n                      </p>\n                    </div>\n\n                    <div class=\"message-meta\">\n                      <span class=\"message-id\">ID: {{ message.conversation_id }}</span>\n                      <div class=\"meta-right\">\n                        <span\n                          class=\"unread-count\"\n                          v-if=\"message.messages && message.messages.length > 0\"\n                        >\n                          {{ message.messages.length }} {{ $t('memory.size') }}\n                        </span>\n                        <span class=\"message-time\">{{ formatTimestamp(message.create_time) }}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                  :id=\"'content-' + message.conversation_id\"\n                  class=\"expanded-content\"\n                  v-if=\"message.expanded\"\n                >\n                  <div style=\"display: flex; flex-direction: column; gap: 0.75rem\">\n                    <div\n                      class=\"message-bubble\"\n                      v-for=\"(bubble, idx) in message.messages\"\n                      :key=\"idx\"\n                    >\n                      <div class=\"bubble-avatar\">\n                        {{ bubble.messageType }}\n                      </div>\n                      <div class=\"bubble-content\">\n                        <p class=\"bubble-text\">{{ bubble.text }}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div v-if=\"filteredMessages.length === 0 && searchQuery\" class=\"empty-state\">\n              <p class=\"state-text\">none message</p>\n            </div>\n          </div>\n\n          <div\n            id=\"name-edit-modal\"\n            class=\"modal-overlay\"\n            v-if=\"showNameModal\"\n            @click.self=\"closeNameModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{ $t('memory.changeName') }}</h3>\n                <input\n                  type=\"text\"\n                  v-model=\"nameInput\"\n                  class=\"edit-input\"\n                  :placeholder=\"$t('memory.newNamePlaceholder')\"\n                />\n                <span\n                  id=\"name-char-count\"\n                  class=\"char-count\"\n                  style=\"text-align: right; display: block; margin-top: 0.25rem\"\n                >\n                  {{ nameInput.length }}\n                </span>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button id=\"cancel-name\" class=\"modal-btn cancel-btn\" @click=\"closeNameModal\">\n                  {{ $t('memory.cancel') }}\n                </button>\n                <button id=\"save-name\" class=\"modal-btn confirm-btn\" @click=\"saveName\">\n                  {{ $t('memory.save') }}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div\n            id=\"delete-modal\"\n            class=\"modal-overlay\"\n            v-if=\"showDeleteModal\"\n            @click.self=\"closeDeleteModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{ $t('memory.deleteHint') }}</h3>\n                <p class=\"state-text\" id=\"delete-message\">\n                  {{ $t('memory.deleteHintPrefix') }} {{ currentDeleteId }}\n                  {{ $t('memory.deleteHintSuffix') }}\n                </p>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button id=\"cancel-delete\" class=\"modal-btn cancel-btn\" @click=\"closeDeleteModal\">\n                  {{ $t('memory.cancel') }}\n                </button>\n                <button\n                  id=\"confirm-delete\"\n                  class=\"modal-btn delete-btn-confirm\"\n                  @click=\"confirmDelete\"\n                >\n                  {{ $t('memory.delete') }}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'MemoryPanel',\n})\nimport { onMounted, onUnmounted, ref } from 'vue'\nimport { MemoryApiService } from '@/api/memory-api-service'\nimport type { Memory } from '@/api/memory-api-service'\n\n// Extended interface for UI state\ninterface MemoryWithExpanded extends Memory {\n  expanded: boolean\n}\nimport { Icon } from '@iconify/vue'\nimport { memoryStore } from '@/stores/memory'\nimport type { MemoryEmits } from '@/stores/memory'\n\nconst showTitleEdit = ref(false)\nconst searchQuery = ref('')\nconst messages = ref<MemoryWithExpanded[]>([])\nconst filteredMessages = ref<MemoryWithExpanded[]>([])\n\nconst showNameModal = ref(false)\nconst currentEditMessageId = ref<string | null>(null)\nconst nameInput = ref('')\n\nconst showDeleteModal = ref(false)\nconst currentDeleteId = ref<string | null>(null)\nconst expandedMap = new Map()\nconst emit = defineEmits<MemoryEmits>()\n\n// Handle ESC key to close modals\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape') {\n    if (showDeleteModal.value) {\n      closeDeleteModal()\n    } else if (showNameModal.value) {\n      closeNameModal()\n    }\n  }\n}\n\nonMounted(() => {\n  memoryStore.setLoadMessages(loadMessages)\n  document.addEventListener('keydown', handleEscKey)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('keydown', handleEscKey)\n})\n\nconst loadMessages = async () => {\n  try {\n    const mes = await MemoryApiService.getMemories()\n    messages.value = mes.map(\n      (mesMsg: Memory): MemoryWithExpanded => ({\n        ...mesMsg,\n        expanded: expandedMap.has(mesMsg.conversation_id)\n          ? expandedMap.get(mesMsg.conversation_id)\n          : false,\n      })\n    )\n    filteredMessages.value = [...messages.value]\n    handleSearch()\n  } catch (e) {\n    console.error('error:', e)\n    messages.value = []\n\n    filteredMessages.value = []\n  }\n}\n\nconst selectMemory = (conversationId: string) => {\n  memoryStore.selectMemory(conversationId)\n  emit('memory-selected')\n}\n\nconst formatTimestamp = (timestamp: number | string): string => {\n  const timestampNum = typeof timestamp === 'string' ? parseInt(timestamp, 10) : timestamp\n  if (isNaN(timestampNum) || timestampNum <= 0) {\n    return 'unknow time'\n  }\n  const date = new Date(timestampNum.toString().length === 13 ? timestampNum : timestampNum * 1000)\n\n  return date\n    .toLocaleString('zh-CN', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n      hour12: false,\n    })\n    .replace(',', ' ')\n}\n\nconst handleSearch = () => {\n  const query = searchQuery.value.toLowerCase().trim()\n\n  if (!query) {\n    filteredMessages.value = [...messages.value]\n    return\n  }\n\n  filteredMessages.value = messages.value.filter(message => {\n    const matchesName = message.memory_name.toLowerCase().includes(query)\n    const matchesId = message.conversation_id.toLowerCase().includes(query)\n    const matchesContent =\n      message.messages?.some(bubble => bubble.text.toLowerCase().includes(query)) ?? false\n    return matchesName || matchesId || matchesContent\n  })\n}\n\nconst showNameEditModal = (messageId: string, currentName: string) => {\n  currentEditMessageId.value = messageId\n  nameInput.value = currentName\n  showNameModal.value = true\n}\n\nconst closeNameModal = () => {\n  showNameModal.value = false\n  currentEditMessageId.value = null\n}\n\nconst saveName = async () => {\n  if (!currentEditMessageId.value) return\n  const newName = nameInput.value.trim() || 'unknow name'\n  const messageIndex = messages.value.findIndex(\n    msg => msg.conversation_id === currentEditMessageId.value\n  )\n  if (messageIndex !== -1) {\n    const currentMessage = messages.value[messageIndex]\n    try {\n      const returnMemory = await MemoryApiService.updateMemory(\n        currentMessage.conversation_id,\n        newName\n      )\n      if (!returnMemory.messages) {\n        returnMemory.messages = []\n      }\n      messages.value[messageIndex] = {\n        ...returnMemory,\n        expanded: currentMessage.expanded,\n      } as MemoryWithExpanded\n      handleSearch()\n      showNameModal.value = false\n    } catch (error) {\n      console.error('error:', error)\n    }\n  }\n}\n\nconst toggleMessage = (id: string) => {\n  const message = messages.value.find(msg => msg.conversation_id === id)\n  if (message) {\n    message.expanded = !message.expanded\n    expandedMap.set(id, message.expanded)\n    const filteredIndex = filteredMessages.value.findIndex(msg => msg.conversation_id === id)\n    if (filteredIndex !== -1) {\n      filteredMessages.value[filteredIndex] = { ...message }\n    }\n  }\n}\n\nconst showDeleteConfirm = (id: string) => {\n  currentDeleteId.value = id\n  showDeleteModal.value = true\n}\n\nconst closeDeleteModal = () => {\n  showDeleteModal.value = false\n  currentDeleteId.value = null\n}\n\nconst confirmDelete = async () => {\n  if (!currentDeleteId.value) return\n\n  try {\n    await MemoryApiService.deleteMemory(currentDeleteId.value)\n    messages.value = messages.value.filter(msg => msg.conversation_id !== currentDeleteId.value)\n    handleSearch()\n    if (messages.value.length === 0) {\n      memoryStore.clearMemoryId()\n    }\n    showDeleteModal.value = false\n    currentDeleteId.value = null\n  } catch (error) {\n    console.error('error:', error)\n  }\n}\n</script>\n\n<style scoped>\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n}\n\n.app-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.app-content {\n  position: relative;\n  transition: all 0.3s ease-in-out;\n  overflow-y: auto;\n  border-radius: 16px;\n  width: 90%;\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  max-width: 800px;\n  max-height: 80vh;\n  min-height: 500px;\n}\n\n.memory-wrapper-collapsed {\n  border-right: none;\n  width: 0;\n}\n\n.header {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.main-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  -webkit-background-clip: text;\n  background-clip: text;\n  color: transparent;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.main-title i {\n  margin-right: 0.5rem;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.search-bar {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n}\n\n.search-container {\n  position: relative;\n}\n.search-container-icon {\n  position: absolute;\n  top: 10px;\n  left: 8px;\n}\n\n.search-input {\n  width: 100%;\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.5rem 0.5rem 2.5rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.search-icon {\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #888888;\n}\n\n.message-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n.message-item {\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n  transition: all 0.2s ease;\n}\n\n.message-item:hover {\n  background-color: #333333;\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n.message-header {\n  cursor: text;\n  padding: 0.75rem;\n  align-items: center;\n  width: 100%;\n}\n\n.message-content {\n  flex: 1;\n  min-width: 0;\n  padding-right: 0.5rem;\n}\n.message.user .message-content {\n  flex: none !important;\n}\n\n.sender-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.25rem;\n}\n\n.sender-div {\n  display: flex;\n  align-items: center;\n  width: 85%;\n  cursor: pointer;\n}\n\n.sender-div:hover:not(:has(.edit-btn:hover, .down-btn:hover, .delete-btn:hover)) .sender-name {\n  color: #667eea;\n}\n\n.sender-name {\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.message-preview {\n  margin-bottom: 0.25rem;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.preview-line {\n  font-size: 0.875rem;\n  color: rgba(255, 255, 255, 0.7);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 0.125rem;\n}\n\n.message-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 0.25rem;\n}\n\n.meta-right {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.message-id {\n  font-size: 0.75rem;\n  color: #667eea;\n}\n\n.message-time {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n  white-space: nowrap;\n}\n\n.unread-count {\n  font-size: 0.75rem;\n  background-color: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  padding: 0.125rem 0.375rem;\n  margin-top: 2px;\n  border-radius: 1rem;\n}\n\n.toggle-container {\n  margin-left: auto;\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n}\n\n.action-buttons {\n  margin-left: 0.5rem;\n  transition: opacity 0.2s ease;\n}\n\n.message-item:hover .action-buttons {\n  opacity: 1;\n}\n\n.edit-btn {\n  margin-left: 10px;\n  cursor: pointer;\n}\n\n.edit-btn:hover {\n  color: #667eea;\n}\n\n.down-btn {\n  cursor: pointer;\n}\n\n.down-btn:hover {\n  color: #667eea;\n}\n\n.delete-btn {\n  color: rgba(255, 255, 255, 0.7);\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem 0;\n  font-size: 1rem;\n}\n\n.delete-btn:hover {\n  color: #ff6b6b;\n}\n\n.expanded-content {\n  background-color: #333333;\n  border-top: 1px solid #444444;\n  padding: 0.75rem;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.message-bubble {\n}\n\n.bubble-avatar {\n  width: 5rem;\n  overflow: hidden;\n  margin-right: 0.5rem;\n  flex-shrink: 0;\n  margin-bottom: 6px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 500;\n}\n\n.bubble-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.bubble-content {\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.bubble-text {\n  font-size: 12px;\n  margin-bottom: 0.25rem;\n}\n\n.state-text {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 50;\n}\n\n.modal-content {\n  background-color: #2d2d2d;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  width: 100%;\n  max-width: 28rem;\n  padding: 1.25rem;\n  transition: all 0.3s ease;\n}\n\n.modal-header {\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.modal-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n}\n\n.modal-btn {\n  flex: 1;\n  padding: 0.5rem;\n  border-radius: 0.25rem;\n  font-size: 0.875rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #333333;\n  border: 1px solid #444444;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.cancel-btn:hover {\n  background-color: #444444;\n}\n\n.confirm-btn {\n  background-color: #667eea;\n  color: #ffffff;\n}\n\n.confirm-btn:hover {\n  background-color: rgba(102, 126, 234, 0.9);\n}\n\n.delete-btn-confirm {\n  background-color: #ff6b6b;\n  color: #ffffff;\n}\n\n.delete-btn-confirm:hover {\n  background-color: #ff5252;\n}\n\n.edit-input {\n  width: 100%;\n  background-color: #333333;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.edit-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n}\n\n.char-count {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInOut {\n  0% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n  20% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  80% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  100% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n}\n\n@media (max-width: 640px) {\n  .main-title {\n    font-size: 1.125rem;\n  }\n\n  .message-id {\n    display: none;\n  }\n\n  .message-time {\n    font-size: 0.7rem;\n  }\n}\n</style>\n","import type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\n\nconst API_BASE_URL = '/api/executor'\n\n/**\n * Fetch detailed agent execution record by stepId\n * @param stepId The stepId to query\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function fetchAgentExecutionDetail(\n  stepId: string\n): Promise<AgentExecutionRecordDetail | null> {\n  try {\n    const response = await fetch(`${API_BASE_URL}/agent-execution/${stepId}`)\n\n    if (!response.ok) {\n      if (response.status === 404) {\n        console.warn(`Agent execution detail not found for stepId: ${stepId}`)\n        return null\n      }\n      throw new Error(`HTTP error! status: ${response.status}`)\n    }\n\n    const data = await response.json()\n    return data as AgentExecutionRecordDetail\n  } catch (error) {\n    console.error(`Error fetching agent execution detail for stepId: ${stepId}:`, error)\n    return null\n  }\n}\n\n/**\n * Refresh agent execution detail by stepId\n * This is a wrapper around fetchAgentExecutionDetail for explicit refresh operations\n * @param stepId The stepId to refresh\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function refreshAgentExecutionDetail(\n  stepId: string\n): Promise<AgentExecutionRecordDetail | null> {\n  console.log(`Refreshing agent execution detail for stepId: ${stepId}`)\n  return fetchAgentExecutionDetail(stepId)\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Define interface types\nexport interface FileNode {\n  name: string\n  path: string\n  type: 'file' | 'directory'\n  size: number\n  lastModified: string\n  children?: FileNode[]\n}\n\nexport interface FileContent {\n  content: string\n  mimeType: string\n  size: number\n}\n\nexport interface ApiResponse<T> {\n  success: boolean\n  data?: T\n  message?: string\n}\n\n/**\n * File Browser API service class\n * Responsible for interacting with backend FileBrowserController\n */\nexport class FileBrowserApiService {\n  private static readonly BASE_URL = '/api/file-browser'\n\n  /**\n   * Handle HTTP response\n   */\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message ?? `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  /**\n   * Get file tree for a specific plan ID\n   */\n  static async getFileTree(planId: string): Promise<FileNode> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/tree/${planId}`)\n      const result = await this.handleResponse(response)\n      const apiResponse: ApiResponse<FileNode> = await result.json()\n\n      if (!apiResponse.success) {\n        throw new Error(apiResponse.message ?? 'Failed to get file tree')\n      }\n\n      return apiResponse.data!\n    } catch (error) {\n      console.error('Failed to get file tree:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get file content\n   */\n  static async getFileContent(planId: string, filePath: string): Promise<FileContent> {\n    try {\n      const response = await fetch(\n        `${this.BASE_URL}/content/${planId}?path=${encodeURIComponent(filePath)}`\n      )\n      const result = await this.handleResponse(response)\n      const apiResponse: ApiResponse<FileContent> = await result.json()\n\n      if (!apiResponse.success) {\n        throw new Error(apiResponse.message ?? 'Failed to get file content')\n      }\n\n      return apiResponse.data!\n    } catch (error) {\n      console.error('Failed to get file content:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Download file\n   */\n  static async downloadFile(planId: string, filePath: string, fileName?: string): Promise<void> {\n    try {\n      const response = await fetch(\n        `${this.BASE_URL}/download/${planId}?path=${encodeURIComponent(filePath)}`\n      )\n      await this.handleResponse(response)\n\n      const blob = await response.blob()\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = fileName ?? filePath.split('/').pop() ?? 'download'\n      document.body.appendChild(a)\n      a.click()\n      window.URL.revokeObjectURL(url)\n      document.body.removeChild(a)\n    } catch (error) {\n      console.error('Failed to download file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Check if file is text-based (can be displayed in editor)\n   */\n  static isTextFile(mimeType: string, fileName: string): boolean {\n    const textMimeTypes = [\n      'text/',\n      'application/json',\n      'application/xml',\n      'application/javascript',\n      'application/typescript',\n    ]\n\n    const textExtensions = [\n      '.txt',\n      '.md',\n      '.json',\n      '.xml',\n      '.html',\n      '.css',\n      '.js',\n      '.ts',\n      '.vue',\n      '.jsx',\n      '.tsx',\n      '.py',\n      '.java',\n      '.cpp',\n      '.c',\n      '.h',\n      '.sh',\n      '.bat',\n      '.yml',\n      '.yaml',\n      '.properties',\n      '.conf',\n      '.cfg',\n    ]\n\n    // Check mime type\n    if (textMimeTypes.some(type => mimeType.startsWith(type))) {\n      return true\n    }\n\n    // Check file extension\n    const lowerFileName = fileName.toLowerCase()\n    return textExtensions.some(ext => lowerFileName.endsWith(ext))\n  }\n\n  /**\n   * Get file icon based on file type\n   */\n  static getFileIcon(node: FileNode): string {\n    if (node.type === 'directory') {\n      return 'carbon:folder'\n    }\n\n    const fileName = node.name.toLowerCase()\n\n    // Programming languages\n    if (fileName.endsWith('.js')) return 'vscode-icons:file-type-js'\n    if (fileName.endsWith('.ts')) return 'vscode-icons:file-type-typescript'\n    if (fileName.endsWith('.vue')) return 'vscode-icons:file-type-vue'\n    if (fileName.endsWith('.java')) return 'vscode-icons:file-type-java'\n    if (fileName.endsWith('.py')) return 'vscode-icons:file-type-python'\n    if (fileName.endsWith('.json')) return 'vscode-icons:file-type-json'\n    if (fileName.endsWith('.xml')) return 'vscode-icons:file-type-xml'\n    if (fileName.endsWith('.html')) return 'vscode-icons:file-type-html'\n    if (fileName.endsWith('.css')) return 'vscode-icons:file-type-css'\n    if (fileName.endsWith('.md')) return 'vscode-icons:file-type-markdown'\n    if (fileName.endsWith('.yml') || fileName.endsWith('.yaml'))\n      return 'vscode-icons:file-type-yaml'\n\n    // Documents\n    if (fileName.endsWith('.pdf')) return 'vscode-icons:file-type-pdf2'\n    if (fileName.endsWith('.doc') || fileName.endsWith('.docx'))\n      return 'vscode-icons:file-type-word'\n    if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx'))\n      return 'vscode-icons:file-type-excel'\n    if (fileName.endsWith('.ppt') || fileName.endsWith('.pptx'))\n      return 'vscode-icons:file-type-powerpoint'\n\n    // Images\n    if (fileName.match(/\\.(jpg|jpeg|png|gif|bmp|svg)$/)) return 'carbon:image'\n\n    // Archives\n    if (fileName.match(/\\.(zip|rar|7z|tar|gz)$/)) return 'carbon:archive'\n\n    // Default file icon\n    return 'carbon:document'\n  }\n}\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-tree-node\">\n    <div\n      class=\"node-content\"\n      :class=\"{\n        'is-directory': node.type === 'directory',\n        'is-file': node.type === 'file',\n        'is-expanded': isExpanded,\n      }\"\n      :style=\"{ paddingLeft: `${level * 16 + 12}px` }\"\n      @click=\"handleClick\"\n      @contextmenu.prevent=\"handleRightClick\"\n    >\n      <!-- Expand/Collapse Icon for directories -->\n      <div v-if=\"node.type === 'directory'\" class=\"expand-icon\" @click.stop=\"toggleExpanded\">\n        <Icon\n          :icon=\"isExpanded ? 'carbon:chevron-down' : 'carbon:chevron-right'\"\n          class=\"chevron-icon\"\n        />\n      </div>\n\n      <!-- File/Directory Icon -->\n      <div class=\"node-icon\">\n        <Icon :icon=\"getNodeIcon()\" />\n      </div>\n\n      <!-- Name -->\n      <span class=\"node-name\">{{ node.name }}</span>\n\n      <!-- File size for files -->\n      <span v-if=\"node.type === 'file'\" class=\"file-size\">\n        {{ formatFileSize(node.size) }}\n      </span>\n\n      <!-- Actions -->\n      <div class=\"node-actions\" v-if=\"showActions\">\n        <button\n          v-if=\"node.type === 'file'\"\n          @click.stop=\"$emit('download-file', node)\"\n          class=\"action-btn download-btn\"\n          title=\"Download\"\n        >\n          <Icon icon=\"carbon:download\" />\n        </button>\n      </div>\n    </div>\n\n    <!-- Children (for directories) -->\n    <div v-if=\"node.type === 'directory' && isExpanded && node.children\" class=\"children\">\n      <FileTreeNode\n        v-for=\"child in node.children\"\n        :key=\"child.path\"\n        :node=\"child\"\n        :level=\"level + 1\"\n        @file-selected=\"$emit('file-selected', $event)\"\n        @download-file=\"$emit('download-file', $event)\"\n      />\n    </div>\n\n    <!-- Context Menu -->\n    <div v-if=\"showContextMenu\" class=\"context-menu\" :style=\"contextMenuStyle\" @click.stop>\n      <div class=\"context-menu-item\" @click=\"handleFileSelect\">\n        <Icon icon=\"carbon:view\" />\n        <span>Open</span>\n      </div>\n      <div v-if=\"node.type === 'file'\" class=\"context-menu-item\" @click=\"handleDownload\">\n        <Icon icon=\"carbon:download\" />\n        <span>Download</span>\n      </div>\n      <div class=\"context-menu-divider\"></div>\n      <div class=\"context-menu-item\" @click=\"copyPath\">\n        <Icon icon=\"carbon:copy\" />\n        <span>Copy Path</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { FileBrowserApiService, type FileNode } from '@/api/file-browser-api-service'\n\ninterface Props {\n  node: FileNode\n  level: number\n}\n\ninterface Emits {\n  (e: 'file-selected', file: FileNode): void\n  (e: 'download-file', file: FileNode): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n// const { t } = useI18n()\n\n// State\nconst isExpanded = ref(props.level === 0) // Root directory expanded by default\nconst showActions = ref(false)\nconst showContextMenu = ref(false)\nconst contextMenuStyle = ref({})\n\n// Computed\n// const hasChildren = computed(() => {\n//   return props.node.type === 'directory' && props.node.children && props.node.children.length > 0\n// })\n\n// Methods\nconst toggleExpanded = () => {\n  if (props.node.type === 'directory') {\n    isExpanded.value = !isExpanded.value\n  }\n}\n\nconst handleClick = () => {\n  if (props.node.type === 'directory') {\n    toggleExpanded()\n  } else {\n    handleFileSelect()\n  }\n}\n\nconst handleFileSelect = () => {\n  if (props.node.type === 'file') {\n    emit('file-selected', props.node)\n  }\n  hideContextMenu()\n}\n\nconst handleDownload = () => {\n  emit('download-file', props.node)\n  hideContextMenu()\n}\n\nconst handleRightClick = (event: MouseEvent) => {\n  event.preventDefault()\n  showContextMenu.value = true\n\n  // Position context menu\n  // const rect = (event.target as HTMLElement).getBoundingClientRect()\n  contextMenuStyle.value = {\n    position: 'fixed',\n    top: `${event.clientY}px`,\n    left: `${event.clientX}px`,\n    zIndex: 1000,\n  }\n\n  // Add click listener to hide context menu\n  setTimeout(() => {\n    document.addEventListener('click', hideContextMenu)\n  }, 0)\n}\n\nconst hideContextMenu = () => {\n  showContextMenu.value = false\n  document.removeEventListener('click', hideContextMenu)\n}\n\nconst copyPath = async () => {\n  try {\n    await navigator.clipboard.writeText(props.node.path)\n    // You could show a toast message here\n  } catch (err) {\n    console.error('Failed to copy path:', err)\n  }\n  hideContextMenu()\n}\n\nconst getNodeIcon = () => {\n  if (props.node.type === 'directory') {\n    return isExpanded.value ? 'carbon:folder-open' : 'carbon:folder'\n  }\n  return FileBrowserApiService.getFileIcon(props.node)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Lifecycle\nonUnmounted(() => {\n  document.removeEventListener('click', hideContextMenu)\n})\n</script>\n\n<style scoped>\n.file-tree-node {\n  position: relative;\n}\n\n.node-content {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 6px;\n  margin: 1px 8px;\n  position: relative;\n}\n\n.node-content:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.node-content.is-directory {\n  font-weight: 500;\n}\n\n.expand-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.7);\n  transition: color 0.2s ease;\n}\n\n.expand-icon:hover {\n  color: #ffffff;\n}\n\n.chevron-icon {\n  font-size: 12px;\n  transition: transform 0.2s ease;\n}\n\n.node-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.node-icon .iconify {\n  font-size: 16px;\n}\n\n.node-name {\n  flex: 1;\n  color: #ffffff;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 11px;\n  white-space: nowrap;\n}\n\n.node-actions {\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.node-content:hover .node-actions {\n  opacity: 1;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  color: #ffffff;\n}\n\n.action-btn .iconify {\n  font-size: 12px;\n}\n\n.children {\n  overflow: hidden;\n}\n\n.context-menu {\n  background: rgba(20, 20, 20, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(20px);\n  padding: 6px;\n  min-width: 160px;\n}\n\n.context-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  cursor: pointer;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 13px;\n  transition: background-color 0.2s ease;\n}\n\n.context-menu-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.context-menu-item .iconify {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.context-menu-divider {\n  height: 1px;\n  background: rgba(255, 255, 255, 0.1);\n  margin: 4px 0;\n}\n\n/* Directory specific styles */\n.node-content.is-directory .node-name {\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.node-content.is-directory.is-expanded .node-icon {\n  color: #677eea;\n}\n\n/* File specific styles */\n.node-content.is-file .node-name {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n/* Animation for expanding/collapsing */\n.children {\n  animation: slideDown 0.2s ease-out;\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-browser\">\n    <div class=\"file-browser-header\">\n      <h3>{{ $t('fileBrowser.title') }}</h3>\n      <div class=\"header-actions\">\n        <button\n          class=\"refresh-btn\"\n          @click=\"refreshFileTree\"\n          :disabled=\"loading\"\n          :title=\"$t('fileBrowser.refresh')\"\n        >\n          <Icon\n            icon=\"carbon:refresh\"\n            :class=\"{ rotating: loading }\"\n            :style=\"{ color: '#ffffff', fontSize: '18px', width: '18px', height: '18px' }\"\n          />\n        </button>\n      </div>\n    </div>\n\n    <div class=\"file-browser-content\">\n      <!-- File Tree -->\n      <div class=\"file-tree-panel\">\n        <div v-if=\"loading\" class=\"loading-state\">\n          <Icon icon=\"carbon:loading\" class=\"rotating\" />\n          <span>{{ $t('fileBrowser.loading') }}</span>\n        </div>\n\n        <div v-else-if=\"error\" class=\"error-state\">\n          <div v-if=\"isPlanDirectoryNotFound\" class=\"waiting-for-files\">\n            <Icon icon=\"carbon:time\" class=\"rotating\" />\n            <div class=\"message-content\">\n              <h3>{{ $t('fileBrowser.waitingForGeneration') }}</h3>\n              <p>{{ $t('fileBrowser.planExecuting') }}</p>\n              <div class=\"tips\">\n                <Icon icon=\"carbon:information\" />\n                <span>{{ $t('fileBrowser.filesTip') }}</span>\n              </div>\n            </div>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\" :disabled=\"loading\">\n              <Icon icon=\"carbon:refresh\" :class=\"{ rotating: loading }\" />\n              {{ loading ? $t('fileBrowser.checking') : $t('fileBrowser.checkNow') }}\n            </button>\n          </div>\n          <div v-else class=\"actual-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ error }}</span>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\">\n              {{ $t('fileBrowser.retry') }}\n            </button>\n          </div>\n        </div>\n\n        <div v-else-if=\"!fileTree\" class=\"empty-state\">\n          <Icon icon=\"carbon:folder-off\" />\n          <span>{{ $t('fileBrowser.noFiles') }}</span>\n        </div>\n\n        <div v-else class=\"file-tree\">\n          <FileTreeNode\n            :node=\"fileTree\"\n            :level=\"0\"\n            @file-selected=\"handleFileSelected\"\n            @download-file=\"handleDownloadFile\"\n          />\n        </div>\n      </div>\n\n      <!-- File Content Viewer -->\n      <div class=\"file-content-panel\" v-if=\"selectedFile\">\n        <div class=\"file-content-header\">\n          <div class=\"file-info\">\n            <Icon :icon=\"getFileIcon(selectedFile)\" />\n            <span class=\"file-name\">{{ selectedFile.name }}</span>\n            <span class=\"file-size\">({{ formatFileSize(selectedFile.size) }})</span>\n          </div>\n          <div class=\"file-actions\">\n            <button\n              @click=\"handleDownloadFile(selectedFile)\"\n              class=\"download-btn\"\n              :title=\"$t('fileBrowser.download')\"\n            >\n              <Icon icon=\"carbon:download\" />\n            </button>\n            <button @click=\"closeFileViewer\" class=\"close-btn\" :title=\"$t('common.close')\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"file-content-body\">\n          <div v-if=\"loadingContent\" class=\"loading-content\">\n            <Icon icon=\"carbon:loading\" class=\"rotating\" />\n            <span>{{ $t('fileBrowser.loadingContent') }}</span>\n          </div>\n\n          <div v-else-if=\"contentError\" class=\"content-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ contentError }}</span>\n          </div>\n\n          <div v-else-if=\"fileContent\" class=\"file-content\">\n            <div v-if=\"isTextFile\" class=\"text-content\">\n              <pre><code>{{ fileContent.content }}</code></pre>\n            </div>\n            <div v-else class=\"binary-content\">\n              <Icon icon=\"carbon:document-unknown\" />\n              <p>{{ $t('fileBrowser.binaryFile') }}</p>\n              <button @click=\"handleDownloadFile(selectedFile)\" class=\"download-btn-large\">\n                <Icon icon=\"carbon:download\" />\n                {{ $t('fileBrowser.downloadToView') }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'FileBrowser',\n})\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport FileTreeNode from './FileTreeNode.vue'\nimport {\n  FileBrowserApiService,\n  type FileNode,\n  type FileContent,\n} from '@/api/file-browser-api-service'\n\ninterface Props {\n  planId: string\n}\n\nconst props = defineProps<Props>()\nconst { t } = useI18n()\n\n// State\nconst loading = ref(false)\nconst error = ref<string | null>(null)\nconst fileTree = ref<FileNode | null>(null)\nconst selectedFile = ref<FileNode | null>(null)\nconst fileContent = ref<FileContent | null>(null)\nconst loadingContent = ref(false)\nconst contentError = ref<string | null>(null)\nconst autoRefreshTimer = ref<number | null>(null)\n\n// Computed\nconst isTextFile = computed(() => {\n  if (!fileContent.value || !selectedFile.value) return false\n  return FileBrowserApiService.isTextFile(fileContent.value.mimeType, selectedFile.value.name)\n})\n\nconst isPlanDirectoryNotFound = computed(() => {\n  return (\n    error.value &&\n    (error.value.includes('Plan directory not found') || error.value.includes('not found'))\n  )\n})\n\n// Methods\nconst clearAutoRefresh = () => {\n  if (autoRefreshTimer.value) {\n    clearTimeout(autoRefreshTimer.value)\n    autoRefreshTimer.value = null\n  }\n}\n\nconst startAutoRefresh = () => {\n  clearAutoRefresh()\n  // Auto refresh every 5 seconds when plan directory is not found\n  autoRefreshTimer.value = window.setTimeout(() => {\n    if (isPlanDirectoryNotFound.value) {\n      refreshFileTree()\n    }\n  }, 5000)\n}\n\nconst refreshFileTree = async () => {\n  if (!props.planId) return\n\n  loading.value = true\n  error.value = null\n  clearAutoRefresh()\n\n  try {\n    fileTree.value = await FileBrowserApiService.getFileTree(props.planId)\n    // Success - no need to auto refresh\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : t('fileBrowser.loadError')\n    console.error('Failed to load file tree:', err)\n\n    // Start auto refresh if it's a \"directory not found\" error\n    const errorMessage = err instanceof Error ? err.message : ''\n    if (errorMessage.includes('Plan directory not found') || errorMessage.includes('not found')) {\n      startAutoRefresh()\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleFileSelected = async (file: FileNode) => {\n  if (file.type === 'directory') return\n\n  selectedFile.value = file\n  fileContent.value = null\n  loadingContent.value = true\n  contentError.value = null\n\n  try {\n    fileContent.value = await FileBrowserApiService.getFileContent(props.planId, file.path)\n  } catch (err) {\n    contentError.value = err instanceof Error ? err.message : t('fileBrowser.contentLoadError')\n    console.error('Failed to load file content:', err)\n  } finally {\n    loadingContent.value = false\n  }\n}\n\nconst handleDownloadFile = async (file: FileNode) => {\n  try {\n    await FileBrowserApiService.downloadFile(props.planId, file.path, file.name)\n  } catch (err) {\n    console.error('Failed to download file:', err)\n    // You could show a toast message here\n  }\n}\n\nconst closeFileViewer = () => {\n  selectedFile.value = null\n  fileContent.value = null\n  contentError.value = null\n}\n\nconst getFileIcon = (file: FileNode) => {\n  return FileBrowserApiService.getFileIcon(file)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Watch for plan ID changes\nwatch(\n  () => props.planId,\n  newPlanId => {\n    if (newPlanId) {\n      selectedFile.value = null\n      fileContent.value = null\n      refreshFileTree()\n    }\n  },\n  { immediate: true }\n)\n\n// Lifecycle\nonMounted(() => {\n  if (props.planId) {\n    refreshFileTree()\n  }\n})\n\nonUnmounted(() => {\n  clearAutoRefresh()\n})\n</script>\n\n<style scoped>\n.file-browser {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  overflow: hidden;\n}\n\n.file-browser-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-browser-header h3 {\n  margin: 0;\n  color: #ffffff;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.header-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.refresh-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  background: rgba(255, 255, 255, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  border-radius: 8px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 18px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n\n.refresh-btn .iconify {\n  color: #ffffff !important;\n  font-size: 18px !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn svg {\n  fill: #ffffff !important;\n  color: #ffffff !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.25);\n  border-color: rgba(255, 255, 255, 0.4);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n}\n\n.refresh-btn:hover:not(:disabled) .iconify,\n.refresh-btn:hover:not(:disabled) svg {\n  color: #ffffff !important;\n  fill: #ffffff !important;\n}\n\n.refresh-btn:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.refresh-btn:disabled .iconify,\n.refresh-btn:disabled svg {\n  color: rgba(255, 255, 255, 0.4) !important;\n  fill: rgba(255, 255, 255, 0.4) !important;\n}\n\n.file-browser-content {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n}\n\n.file-tree-panel {\n  flex: 0 0 300px;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  overflow-y: auto;\n}\n\n.file-content-panel {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n\n.loading-state,\n.error-state,\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.loading-state .iconify,\n.error-state .iconify,\n.empty-state .iconify {\n  font-size: 32px;\n}\n\n.retry-btn {\n  padding: 8px 16px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 6px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.retry-btn:hover {\n  background: rgba(103, 126, 234, 0.3);\n}\n\n.retry-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.waiting-for-files {\n  color: #74c0fc;\n}\n\n.waiting-for-files .iconify {\n  font-size: 48px;\n  margin-bottom: 20px;\n  opacity: 0.8;\n}\n\n.waiting-for-files .message-content {\n  margin-bottom: 24px;\n  text-align: center;\n}\n\n.waiting-for-files h3 {\n  margin: 0 0 8px 0;\n  color: #ffffff;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.waiting-for-files p {\n  margin: 0 0 16px 0;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.waiting-for-files .tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(116, 192, 252, 0.1);\n  border: 1px solid rgba(116, 192, 252, 0.2);\n  border-radius: 8px;\n  color: #74c0fc;\n  font-size: 13px;\n}\n\n.waiting-for-files .tips .iconify {\n  font-size: 16px;\n  margin: 0;\n}\n\n.actual-error {\n  color: #ff6b6b;\n}\n\n.file-tree {\n  padding: 8px 0;\n}\n\n.file-content-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #ffffff;\n}\n\n.file-info .iconify {\n  font-size: 18px;\n}\n\n.file-name {\n  font-weight: 600;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 12px;\n}\n\n.file-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.download-btn,\n.close-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.download-btn:hover,\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.file-content-body {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.loading-content,\n.content-error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.file-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n.text-content {\n  height: 100%;\n  overflow: auto;\n  padding: 20px;\n}\n\n.text-content pre {\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  color: #ffffff;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n.binary-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 16px;\n}\n\n.binary-content .iconify {\n  font-size: 48px;\n}\n\n.download-btn-large {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 24px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n}\n\n.download-btn-large:hover {\n  background: rgba(103, 126, 234, 0.3);\n  transform: translateY(-1px);\n}\n\n.rotating {\n  animation: rotate 1s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Scrollbar styling */\n.file-tree-panel::-webkit-scrollbar,\n.text-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.file-tree-panel::-webkit-scrollbar-track,\n.text-content::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb,\n.text-content::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 3px;\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb:hover,\n.text-content::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"right-panel\">\n    <div class=\"preview-header\">\n      <div class=\"preview-tabs\">\n        <!-- Step Execution Details tab -->\n        <div\n          class=\"tab-item\"\n          :class=\"{ active: activeTab === 'details' }\"\n          @click=\"activeTab = 'details'\"\n        >\n          <Icon icon=\"carbon:events\" />\n          <span>{{ t('rightPanel.stepExecutionDetails') }}</span>\n        </div>\n        <!-- File Browser tab -->\n        <div\n          class=\"tab-item\"\n          :class=\"{ active: activeTab === 'files' }\"\n          @click=\"activeTab = 'files'\"\n        >\n          <Icon icon=\"carbon:folder\" />\n          <span>{{ t('fileBrowser.title') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"preview-content\">\n      <!-- Step Execution Details -->\n      <div v-if=\"activeTab === 'details'\" class=\"step-details\">\n        <!-- Step basic information -->\n        <div v-if=\"selectedStep\" class=\"step-info\">\n          <h3>\n            {{\n              selectedStep.title ||\n              selectedStep.description ||\n              t('rightPanel.defaultStepTitle', { number: 1 })\n            }}\n          </h3>\n\n          <div class=\"agent-info\" v-if=\"selectedStep.agentExecution\">\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executingAgent') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.agentName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.callingModel') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.modelName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n              <span\n                class=\"value\"\n                :class=\"{ success: selectedStep.agentExecution.status === 'FINISHED' }\"\n              >\n                {{ selectedStep.agentExecution.status || t('rightPanel.executing') }}\n              </span>\n            </div>\n          </div>\n\n          <div class=\"execution-status\">\n            <div class=\"status-item\">\n              <Icon\n                icon=\"carbon:checkmark-filled\"\n                v-if=\"selectedStep.completed\"\n                class=\"status-icon success\"\n              />\n              <Icon\n                icon=\"carbon:in-progress\"\n                v-else-if=\"selectedStep.current\"\n                class=\"status-icon progress\"\n              />\n              <Icon icon=\"carbon:time\" v-else class=\"status-icon pending\" />\n              <span class=\"status-text\">\n                {{ stepStatusText }}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <!-- Scrollable detailed content area -->\n        <div ref=\"scrollContainer\" class=\"step-details-scroll-container\" @scroll=\"checkScrollState\">\n          <div v-if=\"selectedStep\">\n            <!-- Think and action steps -->\n            <div\n              class=\"think-act-steps\"\n              v-if=\"\n                selectedStep.agentExecution?.thinkActSteps &&\n                selectedStep.agentExecution.thinkActSteps.length > 0\n              \"\n            >\n              <h4>{{ t('rightPanel.thinkAndActionSteps') }}</h4>\n              <div class=\"steps-container\">\n                <div\n                  v-for=\"(tas, index) in selectedStep.agentExecution.thinkActSteps\"\n                  :key=\"index\"\n                  class=\"think-act-step\"\n                >\n                  <div class=\"step-header\">\n                    <span class=\"step-number\">#{{ index + 1 }}</span>\n                    <span class=\"step-status\" :class=\"tas.status\">{{\n                      tas.status || t('rightPanel.executing')\n                    }}</span>\n                  </div>\n\n                  <!-- Think section - strictly follow right-sidebar.js logic -->\n                  <div class=\"think-section\">\n                    <h5>\n                      <Icon icon=\"carbon:thinking\" />\n                      {{ t('rightPanel.thinking') }}\n                    </h5>\n                    <div class=\"think-content\">\n                      <div class=\"input\">\n                        <span class=\"label\">{{ t('rightPanel.input') }}:</span>\n                        <pre>{{ formatJson(tas.thinkInput) }}</pre>\n                      </div>\n                      <div class=\"output\">\n                        <span class=\"label\">{{ t('rightPanel.output') }}:</span>\n                        <pre>{{ formatJson(tas.thinkOutput) }}</pre>\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Action section - strictly follow right-sidebar.js logic -->\n                  <div v-if=\"tas.actionNeeded\" class=\"action-section\">\n                    <h5>\n                      <Icon icon=\"carbon:play\" />\n                      {{ t('rightPanel.action') }}\n                    </h5>\n                    <div class=\"action-content\">\n                      <div v-for=\"(actToolInfo, index) in tas.actToolInfoList\" :key=\"index\">\n                        <div class=\"tool-info\">\n                          <span class=\"label\">{{ t('rightPanel.tool') }}:</span>\n                          <span class=\"value\">{{ actToolInfo.name || '' }}</span>\n                        </div>\n                        <div class=\"input\">\n                          <span class=\"label\">{{ t('rightPanel.toolParameters') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.parameters) }}</pre>\n                        </div>\n                        <div class=\"output\">\n                          <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.result) }}</pre>\n                        </div>\n                      </div>\n                    </div>\n\n                    <!-- Sub execution plan section - new feature -->\n                    <div v-if=\"tas.subPlanExecutionRecord\" class=\"sub-plan-section\">\n                      <h5>\n                        <Icon icon=\"carbon:tree-view\" />\n                        {{ t('rightPanel.subPlan') }}\n                      </h5>\n                      <div class=\"sub-plan-content\">\n                        <div class=\"sub-plan-header\">\n                          <div class=\"sub-plan-info\">\n                            <span class=\"label\">{{ $t('rightPanel.subPlanId') }}:</span>\n                            <span class=\"value\">{{\n                              tas.subPlanExecutionRecord.currentPlanId\n                            }}</span>\n                          </div>\n                          <div class=\"sub-plan-info\" v-if=\"tas.subPlanExecutionRecord.title\">\n                            <span class=\"label\">{{ $t('rightPanel.title') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.title }}</span>\n                          </div>\n                          <div class=\"sub-plan-status\">\n                            <Icon\n                              icon=\"carbon:checkmark-filled\"\n                              v-if=\"tas.subPlanExecutionRecord.completed\"\n                              class=\"status-icon success\"\n                            />\n                            <Icon icon=\"carbon:in-progress\" v-else class=\"status-icon progress\" />\n                            <span class=\"status-text\">\n                              {{\n                                tas.subPlanExecutionRecord.completed\n                                  ? $t('rightPanel.status.completed')\n                                  : $t('rightPanel.status.executing')\n                              }}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div\n                v-if=\"\n                  selectedStep.agentExecution && !selectedStep.agentExecution.thinkActSteps?.length\n                \"\n                class=\"no-steps-message\"\n              >\n                <p>{{ t('rightPanel.noStepDetails') }}</p>\n              </div>\n\n              <!-- Handle no agentExecution case -->\n              <div v-else-if=\"!selectedStep.agentExecution\" class=\"no-execution-message\">\n                <Icon icon=\"carbon:information\" class=\"info-icon\" />\n                <h4>{{ t('rightPanel.stepInfo') }}</h4>\n                <div class=\"step-basic-info\">\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ t('rightPanel.stepName') }}:</span>\n                    <span class=\"value\">{{\n                      selectedStep.title || selectedStep.description || selectedStep.stepId\n                    }}</span>\n                  </div>\n                  <div class=\"info-item\" v-if=\"selectedStep.description\">\n                    <span class=\"label\">{{ $t('rightPanel.description') }}:</span>\n                    <span class=\"value\">{{ selectedStep.description }}</span>\n                  </div>\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ $t('rightPanel.status.label') }}:</span>\n                    <span\n                      class=\"value\"\n                      :class=\"{\n                        'status-completed': selectedStep.completed,\n                        'status-current': selectedStep.current,\n                        'status-pending': !selectedStep.completed && !selectedStep.current,\n                      }\"\n                    >\n                      {{\n                        selectedStep.completed\n                          ? $t('rightPanel.status.completed')\n                          : selectedStep.current\n                            ? $t('rightPanel.status.executing')\n                            : $t('rightPanel.status.pending')\n                      }}\n                    </span>\n                  </div>\n                </div>\n                <p class=\"no-execution-hint\">{{ t('rightPanel.noExecutionInfo') }}</p>\n              </div>\n\n              <!-- Dynamic effect during execution -->\n              <div\n                v-if=\"selectedStep.current && !selectedStep.completed\"\n                class=\"execution-indicator\"\n              >\n                <div class=\"execution-waves\">\n                  <div class=\"wave wave-1\"></div>\n                  <div class=\"wave wave-2\"></div>\n                  <div class=\"wave wave-3\"></div>\n                </div>\n                <p class=\"execution-text\">\n                  <Icon icon=\"carbon:in-progress\" class=\"rotating-icon\" />\n                  {{ t('rightPanel.stepExecuting') }}\n                </p>\n              </div>\n            </div>\n\n            <div v-else class=\"no-selection\">\n              <Icon icon=\"carbon:events\" class=\"empty-icon\" />\n              <h3>{{ t('rightPanel.noStepSelected') }}</h3>\n              <p>{{ t('rightPanel.selectStepHint') }}</p>\n            </div>\n          </div>\n\n          <!-- Scroll to bottom button -->\n          <Transition name=\"scroll-button\">\n            <button\n              v-if=\"showScrollToBottomButton\"\n              @click=\"scrollToBottom\"\n              class=\"scroll-to-bottom-btn\"\n              :title=\"t('rightPanel.scrollToBottom')\"\n            >\n              <Icon icon=\"carbon:chevron-down\" />\n            </button>\n          </Transition>\n        </div>\n      </div>\n\n      <!-- File Browser -->\n      <div v-if=\"activeTab === 'files'\" class=\"file-browser-container\">\n        <FileBrowser v-if=\"fileBrowserPlanId\" :plan-id=\"fileBrowserPlanId\" />\n        <div v-else-if=\"shouldShowNoTaskMessage\" class=\"no-plan-message\">\n          <Icon icon=\"carbon:folder-off\" />\n          <div class=\"message-content\">\n            <h3>{{ t('fileBrowser.noFilesYet') }}</h3>\n            <p>{{ t('fileBrowser.noPlanExecuting') }}</p>\n            <div class=\"tips\">\n              <Icon icon=\"carbon:information\" />\n              <span>{{ t('fileBrowser.startTaskTip') }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted, nextTick, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { fetchAgentExecutionDetail, refreshAgentExecutionDetail } from '@/api/agent-execution'\nimport type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\nimport FileBrowser from '@/components/file-browser/index.vue'\n\n// Define props interface\ninterface Props {\n  currentRootPlanId?: string | null\n  selectedStepId?: string | null\n}\n\nconst props = defineProps<Props>()\n\n// Define selected step interface\ninterface SelectedStep {\n  stepId: string\n  title: string\n  description: string\n  agentExecution?: AgentExecutionRecordDetail\n  completed: boolean\n  current: boolean\n}\n\nconst { t } = useI18n()\n\n// DOM element reference\nconst scrollContainer = ref<HTMLElement>()\n\n// Local state\nconst selectedStep = ref<SelectedStep | null>()\nconst activeTab = ref<'details' | 'files'>('details')\n\n// Keep track of the last executed plan for file browser\nconst lastExecutedPlanId = ref<string | null>(localStorage.getItem('jmanus-last-plan-id'))\nconst hasExecutedAnyPlan = ref(localStorage.getItem('jmanus-has-executed-plan') === 'true')\n\n// Scroll-related state\nconst showScrollToBottomButton = ref(false)\nconst isNearBottom = ref(true)\nconst shouldAutoScrollToBottom = ref(true)\n\nconst stepStatusText = computed(() => {\n  if (!selectedStep.value) return ''\n  if (selectedStep.value.completed) return t('rightPanel.status.completed')\n  if (selectedStep.value.current) return t('rightPanel.status.executing')\n  return t('rightPanel.status.waiting')\n})\n\n// Computed property to determine which planId to show in file browser\nconst fileBrowserPlanId = computed(() => {\n  // If there's a current plan, use it\n  if (props.currentRootPlanId) {\n    return props.currentRootPlanId\n  }\n  // Otherwise, use the last executed plan if any\n  return lastExecutedPlanId.value\n})\n\n// Computed property to determine if we should show the \"no task\" message\nconst shouldShowNoTaskMessage = computed(() => {\n  return !fileBrowserPlanId.value && !hasExecutedAnyPlan.value\n})\n\n// Actions - Step selection and refresh control\n\n/**\n * Handle step selection by stepId\n * @param stepId - The step ID to display\n */\nconst handleStepSelected = async (stepId: string) => {\n  console.log('[RightPanel] Step selected:', { stepId })\n\n  if (!stepId) {\n    console.warn('[RightPanel] No stepId provided')\n    selectedStep.value = null\n    return\n  }\n\n  try {\n    // Fetch agent execution detail from API\n    const agentExecutionDetail = await fetchAgentExecutionDetail(stepId)\n\n    if (!agentExecutionDetail) {\n      console.warn('[RightPanel] Agent execution detail not found for stepId:', stepId)\n      selectedStep.value = null\n      return\n    }\n\n    // Create step data object\n    const stepData: SelectedStep = {\n      stepId: stepId,\n      title: agentExecutionDetail.agentName ?? `Step ${stepId}`,\n      description: agentExecutionDetail.agentDescription ?? '',\n      agentExecution: agentExecutionDetail,\n      completed: agentExecutionDetail.status === 'FINISHED',\n      current: agentExecutionDetail.status === 'RUNNING',\n    }\n\n    selectedStep.value = stepData\n    console.log('[RightPanel] Step details updated:', stepData)\n    console.log('[RightPanel] activeTab:', activeTab.value)\n    console.log('[RightPanel] selectedStep.value:', selectedStep.value)\n    console.log('[RightPanel] agentExecution:', selectedStep.value.agentExecution)\n    console.log('[RightPanel] thinkActSteps:', selectedStep.value.agentExecution?.thinkActSteps)\n    console.log(\n      '[RightPanel] thinkActSteps length:',\n      selectedStep.value.agentExecution?.thinkActSteps?.length\n    )\n\n    // Force reactivity update\n    await nextTick()\n    console.log('[RightPanel] After nextTick - selectedStep:', selectedStep.value)\n\n    // Delay scroll state check to ensure DOM is updated\n    setTimeout(() => {\n      checkScrollState()\n    }, 100)\n\n    // Auto-scroll to latest content if previously at bottom\n    autoScrollToBottomIfNeeded()\n  } catch (error) {\n    console.error('[RightPanel] Error fetching step details:', error)\n    selectedStep.value = null\n  }\n}\n\n/**\n * Refresh the currently selected step\n */\nconst refreshCurrentStep = async () => {\n  if (!selectedStep.value?.stepId) {\n    console.warn('[RightPanel] No step selected for refresh')\n    return\n  }\n\n  console.log('[RightPanel] Refreshing current step:', selectedStep.value.stepId)\n\n  try {\n    const agentExecutionDetail = await refreshAgentExecutionDetail(selectedStep.value.stepId)\n\n    if (agentExecutionDetail) {\n      // Update the existing step data\n      selectedStep.value.agentExecution = agentExecutionDetail\n      selectedStep.value.completed = agentExecutionDetail.status === 'FINISHED'\n      selectedStep.value.current = agentExecutionDetail.status === 'RUNNING'\n\n      console.log('[RightPanel] Step refreshed successfully')\n\n      // Auto-scroll to latest content if previously at bottom\n      autoScrollToBottomIfNeeded()\n    }\n  } catch (error) {\n    console.error('[RightPanel] Error refreshing step:', error)\n  }\n}\n\n// Watch for selectedStepId prop changes\nwatch(\n  () => props.selectedStepId,\n  async newStepId => {\n    if (newStepId) {\n      await handleStepSelected(newStepId)\n    } else {\n      selectedStep.value = null\n    }\n  },\n  { immediate: true }\n)\n\n// Actions - Scroll management\nconst setScrollContainer = (element: HTMLElement | null) => {\n  scrollContainer.value = element ?? undefined\n}\n\nconst checkScrollState = () => {\n  if (!scrollContainer.value) return\n\n  const { scrollTop, scrollHeight, clientHeight } = scrollContainer.value\n  const isAtBottom = scrollHeight - scrollTop - clientHeight < 50\n  const hasScrollableContent = scrollHeight > clientHeight\n\n  isNearBottom.value = isAtBottom\n  showScrollToBottomButton.value = hasScrollableContent && !isAtBottom\n\n  // Update auto-scroll flag: should auto-scroll if user scrolls to bottom\n  // If user actively scrolls up away from bottom, stop auto-scrolling\n  if (isAtBottom) {\n    shouldAutoScrollToBottom.value = true\n  } else if (scrollHeight - scrollTop - clientHeight > 100) {\n    // If user clearly scrolled up (more than 100px from bottom), stop auto-scrolling\n    shouldAutoScrollToBottom.value = false\n  }\n\n  console.log('[RightPanel] Scroll state check:', {\n    scrollTop,\n    scrollHeight,\n    clientHeight,\n    isAtBottom,\n    hasScrollableContent,\n    showButton: showScrollToBottomButton.value,\n    shouldAutoScroll: shouldAutoScrollToBottom.value,\n  })\n}\n\nconst scrollToBottom = () => {\n  if (!scrollContainer.value) return\n\n  scrollContainer.value.scrollTo({\n    top: scrollContainer.value.scrollHeight,\n    behavior: 'smooth',\n  })\n\n  // Reset state after scrolling\n  nextTick(() => {\n    shouldAutoScrollToBottom.value = true\n    checkScrollState()\n  })\n}\n\nconst autoScrollToBottomIfNeeded = () => {\n  if (!shouldAutoScrollToBottom.value || !scrollContainer.value) return\n\n  nextTick(() => {\n    if (scrollContainer.value) {\n      scrollContainer.value.scrollTop = scrollContainer.value.scrollHeight\n      console.log('[RightPanel] Auto scroll to bottom')\n    }\n  })\n}\n\n// Actions - Utility functions\nconst formatJson = (jsonData: unknown): string => {\n  if (jsonData === null || typeof jsonData === 'undefined' || jsonData === '') {\n    return 'N/A'\n  }\n  try {\n    const jsonObj = typeof jsonData === 'object' ? jsonData : JSON.parse(jsonData as string)\n    return JSON.stringify(jsonObj, null, 2)\n  } catch {\n    // If parsing fails, return string format directly (similar to _escapeHtml in right-sidebar.js)\n    return String(jsonData)\n  }\n}\n\n// Actions - Resource cleanup\nconst cleanup = () => {\n  selectedStep.value = null\n  shouldAutoScrollToBottom.value = true\n\n  if (scrollContainer.value) {\n    scrollContainer.value.removeEventListener('scroll', checkScrollState)\n  }\n}\n\n// Initialize scroll listener\nconst initScrollListener = () => {\n  const setupScrollListener = () => {\n    const element = scrollContainer.value\n    if (!element) {\n      console.log('[RightPanel] Scroll container not found, retrying...')\n      return false\n    }\n\n    // Set scroll container\n    setScrollContainer(element)\n\n    element.addEventListener('scroll', checkScrollState)\n    // Initial state check\n    shouldAutoScrollToBottom.value = true // Reset to auto scroll state\n    checkScrollState()\n    console.log('[RightPanel] Scroll listener initialized successfully')\n    return true\n  }\n\n  // Use nextTick to ensure DOM is updated\n  nextTick(() => {\n    if (!setupScrollListener()) {\n      // If first attempt fails, try again\n      setTimeout(() => {\n        setupScrollListener()\n      }, 100)\n    }\n  })\n}\n\n// Watch for currentRootPlanId changes to track execution history\nwatch(\n  () => props.currentRootPlanId,\n  (newPlanId, oldPlanId) => {\n    if (newPlanId && newPlanId !== oldPlanId) {\n      // A new plan has started executing\n      lastExecutedPlanId.value = newPlanId\n      hasExecutedAnyPlan.value = true\n\n      // Persist to localStorage\n      localStorage.setItem('jmanus-last-plan-id', newPlanId)\n      localStorage.setItem('jmanus-has-executed-plan', 'true')\n\n      console.log('[RightPanel] New plan started:', newPlanId)\n    } else if (!newPlanId && oldPlanId) {\n      // Plan execution finished, but keep the lastExecutedPlanId for file browser\n      console.log(\n        '[RightPanel] Plan execution finished, keeping last plan:',\n        lastExecutedPlanId.value\n      )\n    }\n  },\n  { immediate: true }\n)\n\n// Lifecycle - initialization on mount\nonMounted(() => {\n  console.log('[RightPanel] Component mounted')\n  // Use nextTick to ensure DOM is rendered\n  nextTick(() => {\n    initScrollListener()\n  })\n})\n\n// Lifecycle - cleanup on unmount\nonUnmounted(() => {\n  console.log('[RightPanel] Component unmounting, cleaning up...')\n  cleanup()\n})\n\n/**\n * Update displayed plan progress\n * This method is called when a plan is updated to refresh the display\n * @param rootPlanId - The root plan ID to update\n */\nconst updateDisplayedPlanProgress = (rootPlanId: string) => {\n  console.log('[RightPanel] updateDisplayedPlanProgress called with rootPlanId:', rootPlanId)\n\n  // Update the last executed plan ID for file browser\n  if (rootPlanId) {\n    lastExecutedPlanId.value = rootPlanId\n    hasExecutedAnyPlan.value = true\n\n    // Persist to localStorage\n    localStorage.setItem('jmanus-last-plan-id', rootPlanId)\n    localStorage.setItem('jmanus-has-executed-plan', 'true')\n\n    console.log('[RightPanel] Plan progress updated:', rootPlanId)\n  }\n}\n\n// Expose methods to parent component - only keep necessary interfaces\ndefineExpose({\n  handleStepSelected,\n  refreshCurrentStep,\n  updateDisplayedPlanProgress,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.right-panel {\n  width: 50%;\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n.preview-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n\n  .tab-button {\n    padding: 8px 16px;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 6px;\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);\n    border-color: #667eea;\n    color: #667eea;\n    cursor: default;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 14px;\n  }\n}\n\n.preview-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n/* Step details styles */\n.step-details {\n  flex: 1;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n}\n\n/* Step basic information */\n.step-info {\n  padding: 20px;\n  margin: 0 20px;\n  background: rgba(41, 42, 45, 0.8);\n  border-radius: 8px;\n  margin-bottom: 16px;\n  min-height: 100px; /* Ensure minimum height */\n\n  h3 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 18px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 2px solid #667eea;\n  }\n}\n\n.step-details-scroll-container {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0 20px 20px;\n  margin: 0 20px 20px;\n  background: rgba(255, 255, 255, 0.01);\n  border-radius: 8px;\n  min-height: 200px; /* Ensure minimum height */\n\n  /* Custom scrollbar styles */\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.1);\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.3);\n    border-radius: 3px;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.5);\n    }\n  }\n}\n\n/* Step information styles - for fixed top */\n.agent-info {\n  margin-bottom: 16px;\n\n  .info-item {\n    display: flex;\n    margin-bottom: 8px;\n    font-size: 14px;\n    line-height: 1.4;\n\n    .label {\n      min-width: 100px;\n      font-weight: 600;\n      color: #888888;\n      flex-shrink: 0;\n    }\n\n    .value {\n      flex: 1;\n      color: #cccccc;\n      word-break: break-word;\n\n      &.success {\n        color: #27ae60;\n      }\n    }\n  }\n}\n\n.execution-status {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n  .status-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .status-icon {\n      font-size: 16px;\n\n      &.success {\n        color: #27ae60;\n      }\n\n      &.progress {\n        color: #3498db;\n      }\n\n      &.pending {\n        color: #f39c12;\n      }\n    }\n\n    .status-text {\n      color: #cccccc;\n      font-weight: 500;\n    }\n  }\n}\n\n.no-steps-message {\n  text-align: center;\n  color: #666666;\n  font-style: italic;\n  margin-top: 16px;\n\n  p {\n    margin: 0;\n  }\n}\n\n.no-execution-message {\n  padding: 20px;\n  background: #f8f9fa;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-top: 16px;\n\n  .info-icon {\n    color: #6c757d;\n    font-size: 20px;\n    margin-bottom: 8px;\n  }\n\n  h4 {\n    margin: 0 0 16px 0;\n    color: #495057;\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .step-basic-info {\n    .info-item {\n      display: flex;\n      margin-bottom: 8px;\n      font-size: 14px;\n\n      .label {\n        font-weight: 500;\n        color: #6c757d;\n        min-width: 80px;\n        margin-right: 8px;\n      }\n\n      .value {\n        color: #333;\n        flex: 1;\n\n        &.status-completed {\n          color: #28a745;\n          font-weight: 500;\n        }\n\n        &.status-current {\n          color: #007bff;\n          font-weight: 500;\n        }\n\n        &.status-pending {\n          color: #6c757d;\n        }\n      }\n    }\n  }\n\n  .no-execution-hint {\n    margin: 16px 0 0 0;\n    color: #6c757d;\n    font-style: italic;\n    font-size: 13px;\n    text-align: center;\n  }\n}\n\n.execution-indicator {\n  margin-top: 20px;\n  padding: 20px;\n  background: rgba(74, 144, 226, 0.1);\n  border: 1px solid rgba(74, 144, 226, 0.3);\n  border-radius: 8px;\n  text-align: center;\n  position: relative;\n  overflow: hidden;\n}\n\n.execution-waves {\n  position: relative;\n  height: 4px;\n  margin-bottom: 16px;\n  background: rgba(74, 144, 226, 0.2);\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.wave {\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.6), transparent);\n  border-radius: 2px;\n}\n\n.wave-1 {\n  animation: wave-animation 2s ease-in-out infinite;\n}\n\n.wave-2 {\n  animation: wave-animation 2s ease-in-out infinite 0.6s;\n}\n\n.wave-3 {\n  animation: wave-animation 2s ease-in-out infinite 1.2s;\n}\n\n@keyframes wave-animation {\n  0% {\n    left: -100%;\n  }\n  50% {\n    left: 100%;\n  }\n  100% {\n    left: 100%;\n  }\n}\n\n.execution-text {\n  color: #4a90e2;\n  font-size: 14px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.rotating-icon {\n  animation: rotate-animation 1s linear infinite;\n}\n\n@keyframes rotate-animation {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.step-info {\n  h3 {\n    color: #ffffff;\n    margin: 0 0 20px 0;\n    font-size: 18px;\n    font-weight: 600;\n  }\n}\n\n.think-act-steps {\n  margin-top: 20px; /* Increase top spacing since there's no fixed header step info now */\n\n  h4 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n  }\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.think-act-step {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 16px;\n\n  .step-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n\n    .step-number {\n      font-weight: 600;\n      color: #667eea;\n      font-size: 14px;\n    }\n\n    .step-status {\n      padding: 4px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(39, 174, 96, 0.2);\n        color: #27ae60;\n      }\n\n      &.running {\n        background: rgba(52, 152, 219, 0.2);\n        color: #3498db;\n      }\n\n      &.pending {\n        background: rgba(243, 156, 18, 0.2);\n        color: #f39c12;\n      }\n    }\n  }\n\n  .think-section,\n  .action-section,\n  .sub-plan-section {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    h5 {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      margin: 0 0 12px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n    }\n  }\n\n  .think-content,\n  .action-content {\n    .input,\n    .output,\n    .tool-info {\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .label {\n        display: block;\n        font-weight: 600;\n        color: #888888;\n        margin-bottom: 4px;\n        font-size: 12px;\n      }\n\n      .value {\n        color: #cccccc;\n        font-size: 14px;\n      }\n\n      pre {\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 4px;\n        padding: 12px;\n        color: #cccccc;\n        font-size: 12px;\n        overflow-x: auto;\n        white-space: pre-wrap;\n        margin: 0;\n        line-height: 1.4;\n        max-height: 200px;\n        overflow-y: auto;\n      }\n    }\n  }\n\n  /* Sub plan styles */\n  .sub-plan-content {\n    .sub-plan-header {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.3);\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 12px;\n\n      .sub-plan-info {\n        display: flex;\n        margin-bottom: 8px;\n        font-size: 12px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n\n        .label {\n          min-width: 80px;\n          font-weight: 600;\n          color: #888888;\n          flex-shrink: 0;\n        }\n\n        .value {\n          flex: 1;\n          color: #cccccc;\n          word-break: break-word;\n        }\n      }\n\n      .sub-plan-status {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n        .status-icon {\n          font-size: 14px;\n\n          &.success {\n            color: #27ae60;\n          }\n\n          &.progress {\n            color: #3498db;\n          }\n        }\n\n        .status-text {\n          color: #cccccc;\n          font-size: 12px;\n          font-weight: 500;\n        }\n      }\n    }\n  }\n}\n\n.no-selection {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #666666;\n\n  .empty-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #444444;\n  }\n\n  h3 {\n    margin: 0 0 8px 0;\n    font-size: 18px;\n    color: #888888;\n  }\n\n  p {\n    margin: 0;\n    font-size: 14px;\n    text-align: center;\n    max-width: 300px;\n    line-height: 1.5;\n  }\n}\n\n/* Scroll to bottom button */\n.scroll-to-bottom-btn {\n  position: fixed;\n  bottom: 40px;\n  right: 40px;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: rgba(74, 144, 226, 0.9);\n  border: none;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  transition: all 0.3s ease;\n  z-index: 100;\n\n  &:hover {\n    background: rgba(74, 144, 226, 1);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n}\n\n/* Scroll button transition animation */\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n/* File Browser Container */\n.file-browser-container {\n  height: 100%;\n  padding: 0;\n  overflow: hidden;\n}\n\n.no-plan-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: rgba(255, 255, 255, 0.6);\n  gap: 24px;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-plan-message > .iconify {\n  font-size: 64px;\n  color: rgba(255, 255, 255, 0.3);\n}\n\n.message-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  max-width: 300px;\n}\n\n.message-content h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.message-content p {\n  margin: 0;\n  font-size: 14px;\n  line-height: 1.5;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(103, 126, 234, 0.1);\n  border: 1px solid rgba(103, 126, 234, 0.2);\n  border-radius: 8px;\n  font-size: 12px;\n  color: rgba(103, 126, 234, 0.9);\n}\n\n.tips .iconify {\n  font-size: 14px;\n  flex-shrink: 0;\n}\n\n/* Tab styles */\n.preview-tabs {\n  display: flex;\n  gap: 0;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 4px;\n}\n\n.tab-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 16px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n  font-weight: 500;\n  min-width: 0;\n  flex: 1;\n  justify-content: center;\n  position: relative;\n}\n\n.tab-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.tab-item.active {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.tab-item .iconify {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n.tab-item span {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n</style>\n","/**\n * Plan Parameter API Service\n * Handles API calls for plan parameter requirements\n */\n\nexport interface ParameterRequirements {\n  parameters: string[]\n  hasParameters: boolean\n  requirements: string\n}\n\nexport class PlanParameterApiService {\n  private static readonly BASE_URL = '/api/plan-template'\n\n  /**\n   * Get parameter requirements for a plan template\n   * @param planTemplateId The plan template ID\n   * @returns Parameter requirements\n   */\n  static async getParameterRequirements(planTemplateId: string): Promise<ParameterRequirements> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${planTemplateId}/parameters`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get parameter requirements: ${response.statusText}`)\n      }\n\n      const data = await response.json()\n      return data\n    } catch (error) {\n      console.error('Error getting parameter requirements:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal v-model=\"showModal\" :title=\"modalTitle\" @confirm=\"handlePublish\">\n    <div class=\"modal-form wide-modal\">\n      <!-- Tool Name -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolNameRequired') }}</label>\n          <input\n            type=\"text\"\n            v-model=\"formData.serviceName\"\n            :placeholder=\"t('mcpService.toolNamePlaceholder')\"\n            :class=\"{ error: !formData.serviceName || !formData.serviceName.trim() }\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolNameDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Tool Description -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolDescriptionRequired') }}</label>\n          <textarea\n            v-model=\"formData.userRequest\"\n            :placeholder=\"t('mcpService.toolDescriptionPlaceholder')\"\n            :class=\"{ error: !formData.userRequest || !formData.userRequest.trim() }\"\n            class=\"description-field\"\n            rows=\"4\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolDescriptionDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Service Group -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.serviceGroup') }}</label>\n          <div class=\"service-group-autocomplete\">\n            <input\n              type=\"text\"\n              v-model=\"formData.serviceGroup\"\n              @input=\"handleServiceGroupInput\"\n              @focus=\"showGroupSuggestions = true\"\n              @blur=\"handleServiceGroupBlur\"\n              :placeholder=\"t('mcpService.serviceGroupPlaceholder')\"\n              :class=\"{ error: !formData.serviceGroup || !formData.serviceGroup.trim() }\"\n              required\n            />\n            <!-- Filtered group suggestions dropdown -->\n            <div\n              v-if=\"showGroupSuggestions && filteredServiceGroups.length > 0\"\n              class=\"service-group-dropdown\"\n            >\n              <div\n                v-for=\"group in filteredServiceGroups\"\n                :key=\"group\"\n                class=\"service-group-option\"\n                @mousedown=\"selectServiceGroup(group)\"\n              >\n                {{ group }}\n              </div>\n            </div>\n          </div>\n          <div class=\"field-description\">{{ t('mcpService.serviceGroupDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Parameter Configuration -->\n      <div class=\"form-section\">\n        <div class=\"section-title\">{{ t('mcpService.parameterConfig') }}</div>\n\n        <!-- Parameter Requirements Help Text -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <div class=\"parameter-table\">\n          <table>\n            <thead>\n              <tr>\n                <th>{{ t('mcpService.parameterName') }}</th>\n                <th>{{ t('mcpService.parameterDescription') }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(param, index) in formData.parameters\" :key=\"index\">\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.name\"\n                    :placeholder=\"t('mcpService.parameterName')\"\n                    class=\"parameter-input\"\n                    :readonly=\"parameterRequirements.hasParameters\"\n                    :class=\"{ 'readonly-input': parameterRequirements.hasParameters }\"\n                    required\n                  />\n                </td>\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.description\"\n                    :placeholder=\"t('mcpService.parameterDescription')\"\n                    class=\"parameter-input\"\n                    required\n                  />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Service Publishing Options -->\n      <div class=\"form-section\">\n        <div class=\"service-publish-options\">\n          <!-- Internal Toolcall Publishing Option -->\n          <div class=\"internal-toolcall-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsInternalToolcall\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsInternalToolcall') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsInternalToolcallDescription') }}\n            </div>\n          </div>\n\n          <!-- HTTP POST Service Publishing Option -->\n          <div class=\"http-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsHttpService\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsHttpService') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsHttpServiceDescription') }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <template #footer>\n      <div class=\"button-container\">\n        <!-- Delete Button - Only shown when saved -->\n        <button\n          v-if=\"isSaved && currentTool?.id\"\n          class=\"action-btn danger\"\n          @click=\"handleDelete\"\n          :disabled=\"deleting\"\n        >\n          <Icon icon=\"carbon:loading\" v-if=\"deleting\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:trash-can\" v-else />\n          {{ deleting ? t('mcpService.deleting') : t('mcpService.delete') }}\n        </button>\n\n        <!-- Publish as Service Button - Always shown -->\n        <button class=\"action-btn primary\" @click=\"handlePublish\" :disabled=\"publishing\">\n          <Icon icon=\"carbon:loading\" v-if=\"publishing\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:cloud-upload\" v-else />\n          {{ publishing ? t('mcpService.publishing') : t('mcpService.publishAsService') }}\n        </button>\n      </div>\n    </template>\n  </Modal>\n\n  <!-- Error Toast -->\n  <div v-if=\"error\" class=\"error-toast\" @click=\"error = ''\">\n    <Icon icon=\"carbon:error\" />\n    {{ error }}\n  </div>\n\n  <!-- Success Toast -->\n  <div v-if=\"success\" class=\"success-toast\" @click=\"success = ''\">\n    <Icon icon=\"carbon:checkmark\" />\n    {{ success }}\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  CoordinatorToolApiService,\n  type CoordinatorToolVO,\n} from '@/api/coordinator-tool-api-service'\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport { ToolApiService } from '@/api/tool-api-service'\nimport Modal from '@/components/modal/index.vue'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, reactive, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\n\n// Props\ninterface Props {\n  modelValue: boolean\n  planTemplateId?: string\n  planDescription?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  modelValue: false,\n  planTemplateId: '',\n  planDescription: '',\n})\n\n// Emits\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n  published: [tool: CoordinatorToolVO | null]\n}>()\n\n// Reactive data\nconst showModal = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst error = ref('')\nconst success = ref('')\nconst publishing = ref(false)\nconst deleting = ref(false)\n\n// Current tool data, used to determine whether to create or update\nconst currentTool = ref<CoordinatorToolVO | null>(null)\n\n// Publishing status\nconst isSaved = ref(false)\n\n// Service publishing options\nconst publishAsHttpService = ref(false)\nconst publishAsInternalToolcall = ref(true) // Default to true\n\n// Parameter requirements from plan template\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst isLoadingParameters = ref(false)\n\n// Service group autocomplete state\nconst showGroupSuggestions = ref(false)\nconst availableServiceGroups = ref<string[]>([])\nconst isLoadingGroups = ref(false)\n\n// Form data\nconst formData = reactive({\n  serviceName: '',\n  userRequest: '',\n  endpoint: '',\n  serviceGroup: '',\n  parameters: [] as Array<{ name: string; description: string }>,\n})\n\n// Filtered service groups based on input (reusing filtering pattern from ToolSelectionModal)\nconst filteredServiceGroups = computed(() => {\n  const trimmedGroup = formData.serviceGroup.trim()\n  if (!trimmedGroup) {\n    return availableServiceGroups.value\n  }\n\n  const query = trimmedGroup.toLowerCase()\n  return availableServiceGroups.value.filter(group => group.toLowerCase().includes(query))\n})\n\n// Calculate modal title\nconst modalTitle = computed(() => {\n  const isUpdate = currentTool.value?.id\n  return isUpdate ? t('mcpService.updateService') : t('mcpService.createService')\n})\n\n// Initialize form data\nconst initializeFormData = () => {\n  formData.serviceName = '' // Show empty when no entity\n  formData.userRequest = props.planDescription || ''\n  formData.endpoint = ''\n  formData.serviceGroup = ''\n  // Only reset parameters when not loaded from plan template\n  if (!parameterRequirements.value.hasParameters) {\n    formData.parameters = []\n  }\n  currentTool.value = null\n  isSaved.value = false\n}\n\n// Watch tool description and copy to tool name when description changes\nwatch(\n  () => formData.userRequest,\n  newDescription => {\n    // Copy description to tool name when description is entered\n    const trimmedDescription = newDescription.trim()\n    if (trimmedDescription) {\n      // Only copy if tool name is empty to avoid overwriting user input\n      if (!formData.serviceName.trim()) {\n        formData.serviceName = trimmedDescription\n      }\n    }\n  }\n)\n\n// Load available service groups from tools (reusing logic from ToolSelectionModal)\nconst loadAvailableServiceGroups = async () => {\n  if (isLoadingGroups.value) {\n    return\n  }\n\n  isLoadingGroups.value = true\n  try {\n    const tools = await ToolApiService.getAvailableTools()\n    // Extract unique service groups (same pattern as groupedTools in ToolSelectionModal)\n    const groupsSet = new Set<string>()\n    tools.forEach(tool => {\n      if (tool.serviceGroup) {\n        groupsSet.add(tool.serviceGroup)\n      }\n    })\n    availableServiceGroups.value = Array.from(groupsSet).sort()\n  } catch (error) {\n    console.error('[PublishModal] Failed to load service groups:', error)\n    availableServiceGroups.value = []\n  } finally {\n    isLoadingGroups.value = false\n  }\n}\n\n// Handle service group input\nconst handleServiceGroupInput = () => {\n  showGroupSuggestions.value = true\n}\n\n// Handle service group blur (with delay to allow option click)\nconst handleServiceGroupBlur = () => {\n  setTimeout(() => {\n    showGroupSuggestions.value = false\n  }, 200)\n}\n\n// Select a service group from dropdown\nconst selectServiceGroup = (group: string) => {\n  formData.serviceGroup = group\n  showGroupSuggestions.value = false\n}\n\n// Load parameter requirements from plan template\nconst loadParameterRequirements = async () => {\n  if (!props.planTemplateId) {\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    return\n  }\n\n  isLoadingParameters.value = true\n  try {\n    const requirements = await PlanParameterApiService.getParameterRequirements(\n      props.planTemplateId\n    )\n    parameterRequirements.value = requirements\n\n    // Initialize form parameters with extracted parameters\n    if (requirements.hasParameters) {\n      formData.parameters = requirements.parameters.map(param => ({\n        name: param,\n        description: '',\n      }))\n    }\n  } catch (error) {\n    console.error('[PublishModal] Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn('[PublishModal] Parameter requirements not available yet, will retry later')\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n  } finally {\n    isLoadingParameters.value = false\n  }\n}\n\n// Show message\nconst showMessage = (msg: string, type: 'success' | 'error' | 'info') => {\n  if (type === 'success') {\n    success.value = msg\n    setTimeout(() => {\n      success.value = ''\n    }, 3000)\n  } else if (type === 'error') {\n    error.value = msg\n    setTimeout(() => {\n      error.value = ''\n    }, 5000)\n  }\n}\n\n// Validate form\nconst validateForm = (): boolean => {\n  // Validate tool name\n  if (!formData.serviceName.trim()) {\n    showMessage(t('mcpService.toolNameRequiredError'), 'error')\n    return false\n  }\n\n  // Validate tool description\n  if (!formData.userRequest.trim()) {\n    showMessage(t('mcpService.toolDescriptionRequiredError'), 'error')\n    return false\n  }\n\n  // Validate service group\n  if (!formData.serviceGroup.trim()) {\n    showMessage(t('mcpService.serviceGroupRequiredError'), 'error')\n    return false\n  }\n\n  // Ensure at least one service is selected\n  if (!publishAsInternalToolcall.value && !publishAsHttpService.value) {\n    showMessage('Please select at least one service type', 'error')\n    return false\n  }\n\n  // Validate parameter names and descriptions\n  for (let i = 0; i < formData.parameters.length; i++) {\n    const param = formData.parameters[i]\n    if (param.name && !param.description.trim()) {\n      showMessage(`Parameter \"${param.name}\" description cannot be empty`, 'error')\n      return false\n    }\n    if (param.description && !param.name.trim()) {\n      showMessage(\n        `Parameter description \"${param.description}\" corresponding name cannot be empty`,\n        'error'\n      )\n      return false\n    }\n  }\n\n  return true\n}\n\n// Handle publishing\nconst handlePublish = async () => {\n  console.log('[PublishModal] Starting to handle publish request')\n  console.log('[PublishModal] Form data:', formData)\n  console.log('[PublishModal] Current tool:', currentTool.value)\n  console.log('[PublishModal] Publish as HTTP service:', publishAsHttpService.value)\n\n  if (!validateForm()) {\n    console.log('[PublishModal] Form validation failed')\n    return\n  }\n\n  publishing.value = true\n  try {\n    // 1. If no current tool data, get or create default first\n    if (!currentTool.value) {\n      console.log('[PublishModal] No current tool data, getting existing tool or creating default')\n      const existingTool = await CoordinatorToolApiService.getCoordinatorToolByTemplate(\n        props.planTemplateId\n      )\n\n      if (existingTool) {\n        currentTool.value = existingTool\n      } else {\n        // Create default tool VO (not saved yet)\n        currentTool.value = CoordinatorToolApiService.createDefaultCoordinatorTool(\n          props.planTemplateId,\n          undefined,\n          props.planDescription\n        )\n      }\n    }\n\n    // 2. Update tool information\n    console.log('[PublishModal] Updating tool information')\n    currentTool.value.toolName = formData.serviceName.trim()\n    currentTool.value.toolDescription = formData.userRequest.trim()\n    currentTool.value.serviceGroup = formData.serviceGroup.trim()\n    currentTool.value.planTemplateId = props.planTemplateId // Ensure planTemplateId is set\n\n    // Set service enabled status and corresponding endpoint\n    currentTool.value.enableInternalToolcall = publishAsInternalToolcall.value\n    currentTool.value.enableHttpService = publishAsHttpService.value\n    currentTool.value.enableMcpService = false\n\n    // Set corresponding endpoint\n    currentTool.value.mcpEndpoint = undefined\n\n    // 3. Update inputSchema\n    const inputSchema = formData.parameters\n      .filter(param => param.name.trim() && param.description.trim())\n      .map(param => ({\n        name: param.name.trim(),\n        description: param.description.trim(),\n        type: 'string',\n      }))\n\n    currentTool.value.inputSchema = JSON.stringify(inputSchema)\n    console.log('[PublishModal] Updated tool information:', currentTool.value)\n\n    // 4. Save tool\n    if (currentTool.value.id) {\n      console.log('[PublishModal] Updating existing tool, ID:', currentTool.value.id)\n      await CoordinatorToolApiService.updateCoordinatorTool(currentTool.value.id, currentTool.value)\n    } else {\n      console.log('[PublishModal] Creating new tool')\n      const savedTool = await CoordinatorToolApiService.createCoordinatorTool(currentTool.value)\n      currentTool.value = savedTool // Update current tool, including newly generated ID\n    }\n\n    // 5. Perform corresponding publishing operations based on publish type\n    const enabledServices = []\n    if (publishAsInternalToolcall.value) enabledServices.push('Internal Method Call')\n    if (publishAsHttpService.value) enabledServices.push('HTTP Service')\n\n    if (enabledServices.length > 0) {\n      console.log(\n        '[PublishModal] Step 5: Publishing service, ID:',\n        currentTool.value.id,\n        'Enabled services:',\n        enabledServices.join(', ')\n      )\n\n      // Build service URL information\n      const serviceUrls = []\n      if (publishAsInternalToolcall.value) {\n        serviceUrls.push(`Internal Call: ${formData.serviceName}`)\n      }\n\n      console.log('[PublishModal] Service published successfully')\n      showMessage(t('mcpService.publishSuccess'), 'success')\n      emit('published', currentTool.value)\n    } else {\n      // Just save, don't publish as any service\n      console.log('[PublishModal] Only saving tool, not publishing as any service')\n      showMessage(t('mcpService.saveSuccess'), 'success')\n      emit('published', currentTool.value)\n    }\n  } catch (err: unknown) {\n    console.error('[PublishModal] Failed to publish service:', err)\n    const message = err instanceof Error ? err.message : 'Unknown error'\n    showMessage(t('mcpService.publishFailed') + ': ' + message, 'error')\n  } finally {\n    publishing.value = false\n  }\n}\n\n// Handle delete\nconst handleDelete = async () => {\n  if (deleting.value) return\n\n  // Confirm deletion\n  if (!confirm(t('mcpService.deleteConfirmMessage'))) {\n    return\n  }\n\n  if (!currentTool.value?.id) {\n    showMessage(\n      t('mcpService.deleteFailed') + ': ' + t('mcpService.selectPlanTemplateFirst'),\n      'error'\n    )\n    return\n  }\n\n  deleting.value = true\n  try {\n    console.log('[PublishModal] Starting to delete MCP service, ID:', currentTool.value.id)\n\n    // Call delete API\n    const result = await CoordinatorToolApiService.deleteCoordinatorTool(currentTool.value.id)\n\n    if (result.success) {\n      console.log('[PublishModal] Deleted successfully')\n      showMessage(t('mcpService.deleteSuccess'), 'success')\n\n      // Close modal\n      showModal.value = false\n\n      // Notify parent component of successful deletion\n      emit('published', null)\n    } else {\n      throw new Error(result.message)\n    }\n  } catch (error: unknown) {\n    console.error('[PublishModal] Failed to delete MCP service:', error)\n    const message = error instanceof Error ? error.message : 'Unknown error'\n    showMessage(t('mcpService.deleteFailed') + ': ' + message, 'error')\n  } finally {\n    deleting.value = false\n  }\n}\n\n// Watch modal display state\nconst watchModal = async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Modal opened, starting to initialize data')\n    initializeFormData()\n    await loadCoordinatorToolData()\n  }\n}\n\n// Load coordinator tool data\nconst loadCoordinatorToolData = async () => {\n  if (!props.planTemplateId) {\n    console.log('[PublishModal] ' + t('mcpService.noPlanTemplateId'))\n    return\n  }\n\n  try {\n    console.log(\n      '[PublishModal] Starting to load coordinator tool data, planTemplateId:',\n      props.planTemplateId\n    )\n\n    // Try to get existing tool\n    const existingTool = await CoordinatorToolApiService.getCoordinatorToolByTemplate(\n      props.planTemplateId\n    )\n\n    let tool: CoordinatorToolVO\n    if (existingTool) {\n      // Use existing tool\n      tool = existingTool\n      console.log('[PublishModal] Found existing coordinator tool:', tool)\n    } else {\n      // Create default tool VO (not saved to database)\n      tool = CoordinatorToolApiService.createDefaultCoordinatorTool(\n        props.planTemplateId,\n        undefined,\n        props.planDescription\n      )\n      console.log('[PublishModal] Created default coordinator tool VO:', tool)\n    }\n\n    // Save current tool data\n    currentTool.value = tool\n\n    // Only existing tools (with ID) are set as saved\n    isSaved.value = !!tool.id\n\n    // Build service URL information\n    const serviceUrls = []\n    if (tool.enableMcpService && tool.mcpEndpoint) {\n      const baseUrl = window.location.origin\n      serviceUrls.push(`MCP: ${baseUrl}/mcp${tool.mcpEndpoint}`)\n    }\n    if (tool.enableInternalToolcall) {\n      serviceUrls.push(`Internal Call: ${tool.toolName}`)\n    }\n\n    console.log('[PublishModal] Load tool data completed')\n    // Fill form data\n    formData.serviceName = tool.toolName || ''\n    formData.userRequest = tool.toolDescription || props.planDescription || ''\n    formData.serviceGroup = tool.serviceGroup ?? ''\n\n    // Set form data based on service type\n    publishAsHttpService.value = tool.enableHttpService ?? false\n    publishAsInternalToolcall.value = tool.enableInternalToolcall ?? false\n\n    // Parse inputSchema as parameters\n    try {\n      if (tool.inputSchema) {\n        const parameters = JSON.parse(tool.inputSchema)\n        if (Array.isArray(parameters) && parameters.length > 0) {\n          // Only override when inputSchema has parameters, otherwise keep parameters loaded from plan template\n          formData.parameters = parameters.map(param => ({\n            name: param.name || '',\n            description: param.description || '',\n          }))\n          console.log('[PublishModal] Load parameters from inputSchema:', formData.parameters)\n        } else {\n          console.log(\n            '[PublishModal] inputSchema is empty, keeping existing parameters:',\n            formData.parameters\n          )\n        }\n      }\n    } catch (e) {\n      console.warn('[PublishModal] ' + t('mcpService.parseInputSchemaFailed') + ':', e)\n      // Don't clear parameters when parsing fails, keep existing parameters\n      console.log(\n        '[PublishModal] Parsing failed, keeping existing parameters:',\n        formData.parameters\n      )\n    }\n\n    console.log('[PublishModal] Form data filled:', formData)\n  } catch (err: unknown) {\n    console.error('[PublishModal] ' + t('mcpService.loadToolDataFailed') + ':', err)\n    const message = err instanceof Error ? err.message : 'Unknown error'\n    showMessage(t('mcpService.loadToolDataFailed') + ': ' + message, 'error')\n  }\n}\n\n// Watch props changes\nwatch(() => props.modelValue, watchModal)\n\n// Watch for planTemplateId changes\nwatch(\n  () => props.planTemplateId,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Load available service groups when modal opens\nwatch(showModal, newVisible => {\n  if (newVisible) {\n    loadAvailableServiceGroups()\n  }\n})\n\n// Initialize when component mounts\nonMounted(async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Initialize when component mounted')\n    initializeFormData()\n    await loadCoordinatorToolData()\n    await loadParameterRequirements()\n  }\n})\n\n// Expose methods for parent component\ndefineExpose({\n  loadParameterRequirements,\n})\n</script>\n\n<style scoped>\n/* Wide modal styles */\n:deep(.wide-modal .modal-container) {\n  width: 90%;\n  max-width: 900px !important; /* Adjust width to 900px */\n}\n\n/* Form layout optimization - reference new Model modal styles */\n.modal-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px; /* Adjust to 16px, consistent with new Model modal */\n  width: 100%;\n}\n\n.form-section {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n  width: 100%;\n}\n\n.section-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  padding-bottom: 8px;\n}\n\n.form-item {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n}\n\n.form-item label {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  margin: 0; /* Remove default margin */\n}\n\n.required {\n  color: #ff6b6b;\n}\n\n/* Field description styles */\n.field-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  margin-top: 4px;\n  line-height: 1.4;\n  font-style: italic;\n}\n\n.form-item input,\n.form-item textarea {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n  min-height: 48px; /* Ensure consistent minimum height */\n}\n\n.form-item input {\n  height: 48px; /* Single line input fixed height */\n}\n\n.form-item input:focus,\n.form-item textarea:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n}\n\n.form-item input::placeholder,\n.form-item textarea::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n/* Service Group Autocomplete Styles */\n.service-group-autocomplete {\n  position: relative;\n}\n\n.service-group-autocomplete input {\n  width: 100%;\n}\n\n.service-group-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  z-index: 99999;\n  margin-top: 4px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.service-group-option {\n  padding: 12px 16px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.service-group-option:last-child {\n  border-bottom: none;\n}\n\n.service-group-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.description-field {\n  resize: vertical;\n  min-height: 80px;\n  line-height: 1.5;\n  width: 100%;\n}\n\n/* Parameter Requirements Help Text */\n.params-help-text {\n  margin-bottom: 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  padding: 6px 8px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 4px;\n}\n\n/* Parameter table responsive */\n.parameter-table {\n  margin-bottom: 16px;\n  width: 100%;\n  overflow-x: auto;\n}\n\n.parameter-table table {\n  width: 100%;\n  border-collapse: collapse;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  overflow: hidden;\n  min-width: 600px;\n}\n\n.parameter-table th {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 500;\n  padding: 12px;\n  text-align: left;\n  font-size: 14px;\n  white-space: nowrap;\n}\n\n.parameter-table td {\n  padding: 8px 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.parameter-input {\n  width: 100%;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.parameter-input:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02) !important;\n  color: rgba(255, 255, 255, 0.6) !important;\n  cursor: not-allowed;\n  border-color: rgba(255, 255, 255, 0.05) !important;\n}\n\n/* Delete and add button styles removed */\n\n/* Endpoint component responsive - supports manual input */\n.custom-dropdown {\n  position: relative;\n  width: 100%;\n}\n\n.dropdown-input {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  height: 48px; /* Ensure consistent height with other inputs */\n}\n\n.dropdown-input input {\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #fff;\n  font-size: 14px;\n  width: 100%;\n  cursor: text; /* Allow text input */\n  height: 100%;\n  padding: 0;\n}\n\n.dropdown-input input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.dropdown-input.active {\n  border-color: #667eea;\n  outline: none;\n  background-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n  transform: translateY(-1px);\n}\n\n.dropdown-input:hover {\n  border-color: rgba(255, 255, 255, 0.2);\n  background-color: rgba(255, 255, 255, 0.07);\n  transform: translateY(-1px);\n}\n\n.dropdown-arrow {\n  transition: transform 0.3s ease;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 16px;\n  flex-shrink: 0;\n  margin-left: 8px;\n}\n\n.dropdown-arrow.rotated {\n  transform: rotate(180deg);\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  max-height: 200px;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(10px);\n  z-index: 10;\n  margin-top: 4px;\n}\n\n.dropdown-item {\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(102, 126, 234, 0.1));\n  color: #a8b3ff;\n  transform: translateX(4px);\n}\n\n.dropdown-item.selected {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(102, 126, 234, 0.2));\n  color: #a8b3ff;\n  font-weight: 500;\n}\n\n.dropdown-item.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n  padding-left: 16px; /* Align with other items */\n}\n\n.dropdown-item.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n/* Button container - reference screenshot styles */\n.button-container {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  margin-top: 0;\n  align-items: center;\n  padding: 16px 0;\n  min-height: 52px; /* Ensure container has fixed height, prevent jitter */\n  position: relative; /* Provide reference for absolutely positioned child elements */\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.primary {\n  background: rgba(102, 126, 234, 0.2);\n  border-color: rgba(102, 126, 234, 0.3);\n  color: #a8b3ff;\n}\n\n.action-btn.primary:hover:not(:disabled) {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.action-btn.danger {\n  background: rgba(234, 102, 102, 0.2);\n  border-color: rgba(234, 102, 102, 0.3);\n  color: #ff6b6b;\n}\n\n.action-btn.danger:hover:not(:disabled) {\n  background: rgba(234, 102, 102, 0.3);\n}\n\n.action-btn.danger:disabled {\n  background: rgba(234, 102, 102, 0.1);\n  border-color: rgba(234, 102, 102, 0.2);\n  color: rgba(255, 107, 107, 0.5);\n  cursor: not-allowed;\n}\n\n/* Read-only input styles */\n.readonly-input {\n  background: rgba(255, 255, 255, 0.03) !important;\n  color: rgba(255, 255, 255, 0.7) !important;\n  cursor: not-allowed !important;\n  opacity: 0.8;\n}\n\n.readonly-input::placeholder {\n  color: rgba(255, 255, 255, 0.4) !important;\n}\n\n/* Endpoint container layout */\n.endpoint-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n.endpoint-row {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n}\n\n/* Custom dropdown styles - reference screenshot three */\n.custom-select {\n  position: relative;\n  display: inline-block;\n  width: 100%; /* Adjust to 100% to fit new layout */\n  flex-shrink: 0;\n}\n\n.select-input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(20, 20, 25, 0.95);\n  border: 2px solid rgba(102, 126, 234, 0.6);\n  border-radius: 12px;\n  color: #667eea;\n  transition: all 0.3s ease;\n  font-size: 14px;\n  font-weight: 600;\n  outline: none;\n  width: 100%;\n  justify-content: space-between;\n  height: 44px;\n  box-sizing: border-box;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n  padding: 0 12px;\n}\n\n.select-input-container:hover {\n  border-color: rgba(102, 126, 234, 0.8);\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.4);\n}\n\n.select-input-container:focus-within {\n  border-color: rgba(102, 126, 234, 0.9);\n  outline: none;\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);\n}\n\n.input-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  min-width: 0;\n}\n\n.input-icon {\n  color: #667eea;\n  flex-shrink: 0;\n}\n\n.select-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  text-shadow: none;\n  display: flex;\n  align-items: center;\n  gap: 0;\n  min-width: 0;\n  height: 100%;\n}\n\n.select-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.select-arrow-btn {\n  background: none;\n  border: none;\n  color: #667eea;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n}\n\n.select-arrow-btn:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.chevron {\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  opacity: 0.9;\n  filter: none;\n  width: 16px;\n  height: 16px;\n}\n\n.select-dropdown {\n  position: absolute;\n  top: 100%;\n  z-index: 99999;\n  margin-top: 6px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  width: 280px; /* Keep consistent with select-btn width */\n  max-height: 280px;\n  overflow: hidden;\n  /* Ensure not occupying document flow */\n  pointer-events: auto;\n}\n\n.select-dropdown.dropdown-top {\n  top: auto;\n  bottom: 100%;\n  margin-top: 0;\n  margin-bottom: 4px;\n}\n\n.dropdown-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 18px;\n  border-bottom: 1px solid rgba(102, 126, 234, 0.2);\n  font-size: 14px;\n  font-weight: 600;\n  color: #667eea;\n  background: rgba(102, 126, 234, 0.05);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.select-options {\n  padding: 12px 0;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.select-option {\n  display: flex;\n  align-items: center;\n  gap: 0;\n  width: 100%;\n  padding: 12px 18px;\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  font-size: 14px;\n}\n\n.select-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.select-option.active {\n  background: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  border-left: 3px solid #667eea;\n  padding-left: 15px;\n  font-weight: 500;\n}\n\n.select-option.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n}\n\n.select-option.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n.option-name {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.check-icon {\n  color: #667eea;\n  opacity: 0.8;\n}\n\n/* Manual input area styles */\n.manual-input-section {\n  padding: 14px 18px;\n  border-top: 1px solid rgba(102, 126, 234, 0.2);\n  background: rgba(102, 126, 234, 0.03);\n}\n\n.manual-input-container {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  width: 100%;\n}\n\n.manual-input {\n  flex: 1;\n  padding: 8px 12px;\n  background: rgba(20, 20, 25, 0.8);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.manual-input:focus {\n  border-color: rgba(102, 126, 234, 0.8);\n  outline: none;\n  background: rgba(20, 20, 25, 0.9);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.manual-input::placeholder {\n  color: rgba(102, 126, 234, 0.5);\n}\n\n.add-manual-btn {\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.15);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.add-manual-btn:hover {\n  background: rgba(102, 126, 234, 0.25);\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n/* Service publishing option styles */\n.service-publish-options {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.mcp-publish-option,\n.http-publish-option,\n.internal-toolcall-publish-option {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n/* .http-publish-option, .mcp-publish-option, .internal-toolcall-publish-option now use the same styles */\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-input {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n  cursor: pointer;\n}\n\n.checkbox-text {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.checkbox-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-left: 24px;\n}\n\n/* HTTP service options now use the same styles as MCP service, no special handling needed */\n\n.endpoint-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-bottom: 8px;\n}\n\n/* Two-column layout styles */\n.endpoint-url-row {\n  display: flex;\n  gap: 16px;\n  width: 100%;\n}\n\n.endpoint-url-row.single-item {\n  gap: 0;\n}\n\n.endpoint-url-row.single-item .endpoint-item {\n  flex: 0 0 50%; /* Maintain 50% width even when displayed alone */\n}\n\n.endpoint-item {\n  flex: 0 0 50%; /* Fixed width 50%, not responsive */\n  min-width: 0;\n}\n\n.url-item {\n  flex: 1;\n  min-width: 0;\n}\n\n/* URL display styles */\n.url-container {\n  width: 100%;\n}\n\n.url-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 48px;\n}\n\n.url-display:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.url-text {\n  flex: 1;\n  font-size: 14px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  word-break: break-all;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.copy-icon {\n  color: rgba(255, 255, 255, 0.6);\n  margin-left: 8px;\n  flex-shrink: 0;\n  transition: all 0.3s ease;\n}\n\n.url-display:hover .copy-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99998;\n  background: transparent;\n}\n\n.slideDown-enter-active,\n.slideDown-leave-active {\n  transition: all 0.2s ease;\n  transform-origin: top;\n}\n\n.slideDown-enter-from,\n.slideDown-leave-to {\n  opacity: 0;\n  transform: translateY(-8px) scale(0.95);\n}\n\n/* Old save button styles removed */\n\n.loading-icon {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Required field styles */\n.required {\n  color: #ff4d4f;\n  margin-left: 4px;\n}\n\n/* Error state styles */\n.form-item input.error,\n.form-item textarea.error {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.1);\n}\n\n.form-item input.error:focus,\n.form-item textarea.error:focus {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.2);\n}\n\n/* Tooltip messages */\n.error-toast,\n.success-toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  z-index: 10000; /* Ensure above modal */\n  animation: slideIn 0.3s ease;\n}\n\n.error-toast {\n  background: rgba(234, 102, 102, 0.9);\n  border: 1px solid rgba(234, 102, 102, 0.5);\n}\n\n.success-toast {\n  background: rgba(102, 234, 102, 0.9);\n  border: 1px solid rgba(102, 234, 102, 0.5);\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div v-if=\"modelValue\" class=\"modal-overlay\" @click=\"handleCancel\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>{{ $t('sidebar.saveConfirmationTitle') }}</h3>\n        <button class=\"close-btn\" @click=\"handleCancel\">\n          <Icon icon=\"carbon:close\" width=\"16\" />\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <p>{{ $t('sidebar.saveConfirmationMessage') }}</p>\n      </div>\n      <div class=\"modal-footer\">\n        <button class=\"btn btn-secondary\" @click=\"handleCancel\">\n          {{ $t('common.cancel') }}\n        </button>\n        <button class=\"btn btn-primary\" @click=\"handleSave\" :disabled=\"isSaving\">\n          <Icon v-if=\"isSaving\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n          {{ isSaving ? $t('sidebar.saving') : $t('common.save') }}\n        </button>\n        <button class=\"btn btn-danger\" @click=\"handleContinueWithoutSave\">\n          {{ $t('sidebar.continueWithoutSave') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { ref } from 'vue'\n\ninterface Props {\n  modelValue: boolean\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'save'): void\n  (e: 'continue'): void\n}\n\ndefineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst isSaving = ref(false)\n\nconst handleCancel = () => {\n  emit('update:modelValue', false)\n}\n\nconst handleSave = async () => {\n  isSaving.value = true\n  try {\n    emit('save')\n    emit('update:modelValue', false)\n  } finally {\n    isSaving.value = false\n  }\n}\n\nconst handleContinueWithoutSave = () => {\n  emit('continue')\n  emit('update:modelValue', false)\n}\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-body p {\n  margin: 0;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:play\" width=\"16\" />\n      <span>{{ t('sidebar.executionController') }}</span>\n    </div>\n    <div class=\"execution-content\">\n      <!-- Parameter Requirements Display -->\n      <div class=\"params-requirements-group\">\n        <label>{{ t('sidebar.parameterRequirements') }}</label>\n        <div class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <!-- Show parameter fields only if there are parameters -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"parameter-fields\">\n          <div\n            v-for=\"param in parameterRequirements.parameters\"\n            :key=\"param\"\n            class=\"parameter-field\"\n          >\n            <label class=\"parameter-label\">\n              {{ param }}\n              <span class=\"required\">*</span>\n            </label>\n            <input\n              v-model=\"parameterValues[param]\"\n              class=\"parameter-input\"\n              :class=\"{ error: parameterErrors[param] }\"\n              :placeholder=\"t('sidebar.enterValueFor', { param })\"\n              @input=\"updateParameterValue(param, ($event.target as HTMLInputElement).value)\"\n              required\n            />\n            <div v-if=\"parameterErrors[param]\" class=\"parameter-error\">\n              {{ parameterErrors[param] }}\n            </div>\n          </div>\n        </div>\n\n        <!-- Validation status message -->\n        <div\n          v-if=\"\n            parameterRequirements.hasParameters &&\n            !canExecute &&\n            !props.isExecuting &&\n            !props.isGenerating\n          \"\n          class=\"validation-message\"\n        >\n          <Icon icon=\"carbon:warning\" width=\"14\" />\n          {{ t('sidebar.fillAllRequiredParameters') }}\n        </div>\n      </div>\n\n      <!-- File Upload Component -->\n      <FileUploadComponent\n        ref=\"fileUploadRef\"\n        :disabled=\"props.isExecuting || props.isGenerating\"\n        @files-uploaded=\"handleFilesUploaded\"\n        @files-removed=\"handleFilesRemoved\"\n        @upload-key-changed=\"handleUploadKeyChanged\"\n        @upload-started=\"handleUploadStarted\"\n        @upload-completed=\"handleUploadCompleted\"\n        @upload-error=\"handleUploadError\"\n      />\n\n      <button\n        class=\"btn btn-primary execute-btn\"\n        @click=\"handleExecutePlan\"\n        :disabled=\"!canExecute\"\n      >\n        <Icon\n          :icon=\"props.isExecuting ? 'carbon:circle-dash' : 'carbon:play'\"\n          width=\"16\"\n          :class=\"{ spinning: props.isExecuting }\"\n        />\n        {{ props.isExecuting ? t('sidebar.executing') : t('sidebar.executePlan') }}\n      </button>\n      <button\n        class=\"btn publish-mcp-btn\"\n        @click=\"handlePublishMcpService\"\n        :disabled=\"!currentPlanTemplateId\"\n        v-if=\"showPublishButton\"\n      >\n        <Icon icon=\"carbon:application\" width=\"16\" />\n        {{ buttonText }}\n      </button>\n\n      <!-- Internal Call wrapper - only show when enableInternalToolcall is true -->\n      <div v-if=\"toolInfo?.enableInternalToolcall\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.internalCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.internalCallDescription') }}</p>\n        </div>\n        <div class=\"internal-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.internalMethodCall') }}</div>\n            <div class=\"call-endpoint\">\n              {{ t('sidebar.toolName') }}: {{ toolInfo?.toolName || currentPlanTemplateId }}\n            </div>\n            <div v-if=\"toolInfo?.serviceGroup\" class=\"call-endpoint\">\n              {{ t('sidebar.serviceGroup') }}: {{ toolInfo.serviceGroup }}\n            </div>\n            <div class=\"call-description\">{{ t('sidebar.internalCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.internalCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- HTTP API URLs wrapper with tabs - only show when enableHttpService is true -->\n      <div v-if=\"toolInfo?.enableHttpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.httpCallExample') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.httpCallDescription') }}</p>\n        </div>\n        <div class=\"http-api-urls-wrapper\">\n          <div class=\"tab-container\">\n            <div class=\"tab-header\">\n              <button\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                :class=\"['tab-button', { active: activeTab === tab.id }]\"\n                @click=\"activeTab = tab.id\"\n              >\n                {{ tab.label }}\n              </button>\n            </div>\n            <div class=\"tab-content\">\n              <div\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                v-show=\"activeTab === tab.id\"\n                class=\"tab-panel\"\n              >\n                <div class=\"http-api-url-display\">\n                  <div class=\"api-method\">{{ tab.method }}</div>\n                  <div class=\"api-endpoint\">{{ tab.endpoint }}</div>\n                  <div class=\"api-description\">{{ tab.description }}</div>\n                  <div v-if=\"tab.example\" class=\"api-example\">\n                    <strong>{{ t('sidebar.example') }}:</strong>\n                    <pre class=\"example-code\">{{ tab.example }}</pre>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- MCP Call wrapper - only show when enableMcpService is true -->\n      <div v-if=\"toolInfo?.enableMcpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.mcpCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.mcpCallDescription') }}</p>\n        </div>\n        <div class=\"mcp-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.mcpServiceCall') }}</div>\n            <div class=\"call-endpoint\">{{ t('sidebar.mcpEndpoint') }}: /mcp/execute</div>\n            <div class=\"call-description\">{{ t('sidebar.mcpCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.mcpCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Save Confirmation Dialog -->\n  <SaveConfirmationDialog\n    v-model=\"showSaveDialog\"\n    @save=\"handleSaveAndExecute\"\n    @continue=\"handleContinueExecution\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport type { CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport SaveConfirmationDialog from '@/components/sidebar/SaveConfirmationDialog.vue'\nimport { sidebarStore } from '@/stores/sidebar'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useToast } from '@/plugins/useToast'\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Props\ninterface Props {\n  currentPlanTemplateId?: string\n  isExecuting?: boolean\n  isGenerating?: boolean\n  showPublishButton?: boolean\n  toolInfo?: CoordinatorToolVO\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  currentPlanTemplateId: '',\n  isExecuting: false,\n  isGenerating: false,\n  showPublishButton: true,\n  toolInfo: () => ({\n    toolName: '',\n    toolDescription: '',\n    planTemplateId: '',\n    inputSchema: '[]',\n    enableHttpService: false,\n    enableMcpService: false,\n    enableInternalToolcall: false,\n    serviceGroup: '',\n  }),\n})\n\n// Emits\nconst emit = defineEmits<{\n  executePlan: [payload: PlanExecutionRequestPayload]\n  publishMcpService: []\n  clearParams: []\n  updateExecutionParams: [params: string]\n  saveBeforeExecute: []\n}>()\n\n// Local state\nconst executionParams = ref('')\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst parameterValues = ref<Record<string, string>>({})\nconst isLoadingParameters = ref(false)\nconst activeTab = ref('get-sync')\nconst parameterErrors = ref<Record<string, string>>({})\nconst isValidationError = ref(false)\nconst isExecutingPlan = ref(false) // Flag to prevent parameter reload during execution\n\n// File upload state\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\n\n// Save confirmation dialog state\nconst showSaveDialog = ref(false)\nconst pendingExecutionPayload = ref<PlanExecutionRequestPayload | null>(null)\n\n// API tabs configuration\nconst apiTabs = ref([\n  {\n    id: 'get-sync',\n    label: 'GET + Sync',\n    method: 'GET',\n    endpoint: '/api/executor/executeByToolNameSync/{toolName}',\n    description: 'Synchronous GET request - returns execution result immediately',\n    example: `GET /api/executor/executeByToolNameSync/my-tool?allParams={\"rawParam\":\"test\"}\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`,\n  },\n  {\n    id: 'post-sync',\n    label: 'POST + Sync',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameSync',\n    description: 'Synchronous POST request - returns execution result immediately',\n    example: `POST /api/executor/executeByToolNameSync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`,\n  },\n  {\n    id: 'post-async',\n    label: 'POST + Async',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameAsync',\n    description: 'Asynchronous POST request - returns task ID, check status separately',\n    example: `POST /api/executor/executeByToolNameAsync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"planId\": \"plan-123\",\n  \"status\": \"processing\",\n  \"message\": \"Task submitted, processing\",\n  \"memoryId\": \"ABC12345\",\n  \"toolName\": \"my-tool\",\n  \"planTemplateId\": \"template-456\"\n}\n\n# Check execution status and get detailed results:\nGET /api/executor/details/{planId}\nResponse: {\n  \"currentPlanId\": \"plan-123\",\n  \"title\": \"Plan Title\",\n  \"status\": \"completed\",\n  \"summary\": \"Execution completed successfully\",\n  \"agentExecutionSequence\": [...],\n  \"userInputWaitState\": null,\n  \"structureResult\": {\n    \"message\": [\n      {\n        \"name\": \"Product A\",\n        \"price\": \"100\",\n        \"quantity\": \"5\"\n      }\n    ],\n    \"fileList\": [\n      {\n        \"fileName\": \"report.md\",\n        \"fileDescription\": \"Generated report with product information\"\n      }\n    ]\n  }\n}`,\n  },\n])\n\n// Computed properties\nconst isAnyServiceEnabled = computed(() => {\n  return (\n    props.toolInfo.enableInternalToolcall ??\n    props.toolInfo.enableHttpService ??\n    props.toolInfo.enableMcpService\n  )\n})\n\nconst buttonText = computed(() => {\n  return isAnyServiceEnabled.value\n    ? t('sidebar.updateServiceStatus')\n    : t('sidebar.publishMcpService')\n})\n\nconst canExecute = computed(() => {\n  if (props.isExecuting || props.isGenerating) {\n    return false\n  }\n\n  if (parameterRequirements.value.hasParameters) {\n    // Check if all required parameters are filled\n    return parameterRequirements.value.parameters.every(param => {\n      const value = parameterValues.value[param]\n      return typeof value === 'string' && value.trim() !== ''\n    })\n  }\n\n  return true\n})\n\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[ExecutionController] Files uploaded:', files.length, 'uploadKey:', key)\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[ExecutionController] Files removed, remaining:', files.length)\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[ExecutionController] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[ExecutionController] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[ExecutionController] Upload completed')\n}\n\nconst handleUploadError = (error: unknown) => {\n  console.error('[ExecutionController] Upload error:', error)\n}\n\n// Methods\nconst handleExecutePlan = () => {\n  console.log('[ExecutionController]  Execute button clicked')\n\n  // Check if task requirements have been modified\n  if (sidebarStore.hasTaskRequirementModified) {\n    console.log(\n      '[ExecutionController]  Task requirements modified, showing save confirmation dialog'\n    )\n    // Prepare payload but don't execute yet\n    if (!validateParameters()) {\n      console.log('[ExecutionController]  Parameter validation failed:', parameterErrors.value)\n      return\n    }\n\n    const replacementParams =\n      parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0\n        ? parameterValues.value\n        : undefined\n\n    pendingExecutionPayload.value = {\n      title: '', // Will be set by the parent component\n      planData: {\n        title: '',\n        steps: [],\n        directResponse: false,\n      }, // Will be set by the parent component\n      params: undefined, // Will be set by the parent component\n      replacementParams,\n      uploadedFiles: uploadedFiles.value,\n      uploadKey: uploadKey.value,\n    }\n\n    showSaveDialog.value = true\n    return\n  }\n\n  // Continue with normal execution if no modifications\n  proceedWithExecution()\n}\n\nconst proceedWithExecution = () => {\n  // Set execution flag to prevent parameter reload\n  isExecutingPlan.value = true\n  console.log('[ExecutionController]  Set isExecutingPlan to true')\n\n  // Validate parameters before execution\n  if (!validateParameters()) {\n    console.log('[ExecutionController]  Parameter validation failed:', parameterErrors.value)\n    isExecutingPlan.value = false // Reset flag on validation failure\n    return\n  }\n\n  // Pass replacement parameters if available\n  const replacementParams =\n    parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0\n      ? parameterValues.value\n      : undefined\n\n  console.log('[ExecutionController]  Replacement params:', replacementParams)\n\n  const payload: PlanExecutionRequestPayload = {\n    title: '', // Will be set by the parent component\n    planData: {\n      title: '',\n      steps: [],\n      directResponse: false,\n    }, // Will be set by the parent component\n    params: undefined, // Will be set by the parent component\n    replacementParams,\n    uploadedFiles: uploadedFiles.value,\n    uploadKey: uploadKey.value,\n  }\n\n  console.log(\n    '[ExecutionController]  Emitting executePlan with payload:',\n    JSON.stringify(payload, null, 2)\n  )\n  emit('executePlan', payload)\n}\n\nconst handleSaveAndExecute = async () => {\n  console.log('[ExecutionController]  Save and execute requested')\n  try {\n    // Emit save event to parent (Sidebar component)\n    // The parent will handle the save and then we can execute\n    emit('saveBeforeExecute')\n    // Wait a bit for save to complete\n    await new Promise(resolve => setTimeout(resolve, 500))\n    // Now proceed with execution\n    if (pendingExecutionPayload.value) {\n      console.log(\n        '[ExecutionController]  Emitting executePlan after save:',\n        JSON.stringify(pendingExecutionPayload.value, null, 2)\n      )\n      emit('executePlan', pendingExecutionPayload.value)\n      pendingExecutionPayload.value = null\n    }\n  } catch (error: unknown) {\n    console.error('[ExecutionController]  Failed to save before execute:', error)\n    const message = error instanceof Error ? error.message : t('sidebar.saveFailed')\n    toast.error(message)\n  }\n}\n\nconst handleContinueExecution = () => {\n  console.log('[ExecutionController]  Continue without save requested')\n  if (pendingExecutionPayload.value) {\n    console.log(\n      '[ExecutionController]  Emitting executePlan without save:',\n      JSON.stringify(pendingExecutionPayload.value, null, 2)\n    )\n    emit('executePlan', pendingExecutionPayload.value)\n    pendingExecutionPayload.value = null\n  }\n}\n\nconst handlePublishMcpService = () => {\n  emit('publishMcpService')\n}\n\nconst clearExecutionParams = () => {\n  console.log('[ExecutionController]  clearExecutionParams called')\n  executionParams.value = ''\n  // Clear parameter values as well\n  parameterValues.value = {}\n\n  // Reset execution flag after clearing\n  isExecutingPlan.value = false\n  console.log('[ExecutionController]  Reset isExecutingPlan to false')\n\n  console.log('[ExecutionController]  After clear - parameterValues cleared')\n  emit('clearParams')\n}\n\n// Load parameter requirements when plan template changes\nconst loadParameterRequirements = async () => {\n  console.log(\n    '[ExecutionController]  loadParameterRequirements called for templateId:',\n    props.currentPlanTemplateId\n  )\n  console.log(\n    '[ExecutionController]  Current parameterRequirements before load:',\n    JSON.stringify(parameterRequirements.value, null, 2)\n  )\n\n  if (!props.currentPlanTemplateId) {\n    console.log('[ExecutionController]  No template ID, resetting parameters')\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    parameterValues.value = {}\n    return\n  }\n\n  // Clear previous data immediately to prevent stale data display\n  parameterRequirements.value = {\n    parameters: [],\n    hasParameters: false,\n    requirements: '',\n  }\n  parameterValues.value = {}\n  console.log('[ExecutionController]  Cleared previous data before loading new template')\n\n  isLoadingParameters.value = true\n  try {\n    console.log('[ExecutionController]  Fetching parameter requirements from API...')\n    const requirements = await PlanParameterApiService.getParameterRequirements(\n      props.currentPlanTemplateId\n    )\n    console.log(\n      '[ExecutionController]  Received requirements from API:',\n      JSON.stringify(requirements, null, 2)\n    )\n\n    parameterRequirements.value = requirements\n\n    // Initialize parameter values\n    const newValues: Record<string, string> = {}\n    requirements.parameters.forEach(param => {\n      newValues[param] = parameterValues.value[param] || ''\n    })\n    parameterValues.value = newValues\n\n    console.log(\n      '[ExecutionController]  Updated parameterRequirements:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Updated parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n\n    // Update execution params with current parameter values\n    updateExecutionParamsFromParameters()\n  } catch (error) {\n    console.error('[ExecutionController]  Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn(\n        '[ExecutionController]  Parameter requirements not available yet, will retry later'\n      )\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    // Clear parameter values when there's an error to prevent stale data\n    parameterValues.value = {}\n    console.log(\n      '[ExecutionController]  Reset parameterRequirements due to error:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Cleared parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n  } finally {\n    isLoadingParameters.value = false\n    console.log('[ExecutionController]  loadParameterRequirements completed')\n  }\n}\n\n// Update parameter value and sync with execution params\nconst updateParameterValue = (paramName: string, value: string) => {\n  parameterValues.value[paramName] = value\n  // Clear error for this parameter when user starts typing\n  if (parameterErrors.value[paramName]) {\n    delete parameterErrors.value[paramName]\n  }\n  updateExecutionParamsFromParameters()\n}\n\n// Validate all parameters\nconst validateParameters = (): boolean => {\n  parameterErrors.value = {}\n  isValidationError.value = false\n\n  if (!parameterRequirements.value.hasParameters) {\n    return true\n  }\n\n  let hasErrors = false\n\n  parameterRequirements.value.parameters.forEach(param => {\n    const value = parameterValues.value[param] ? parameterValues.value[param].trim() : ''\n    if (!value) {\n      parameterErrors.value[param] = `${param} is required`\n      hasErrors = true\n    }\n  })\n\n  isValidationError.value = hasErrors\n  return !hasErrors\n}\n\n// Update execution params from parameter values\nconst updateExecutionParamsFromParameters = () => {\n  if (parameterRequirements.value.hasParameters) {\n    // Convert parameter values to JSON string for execution\n    executionParams.value = JSON.stringify(parameterValues.value, null, 2)\n  } else {\n    executionParams.value = ''\n  }\n  emit('updateExecutionParams', executionParams.value)\n}\n\n// Watch for changes in plan template ID\nwatch(\n  () => props.currentPlanTemplateId,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // Skip parameter reload if we're currently executing a plan\n      if (isExecutingPlan.value) {\n        console.log('[ExecutionController]  Skipping parameter reload - plan is executing')\n        return\n      }\n\n      console.log('[ExecutionController]  Template ID changed, will reload parameters')\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        console.log('[ExecutionController]  New template detected, retrying with delay...')\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          console.log('[ExecutionController]  Delay timeout, calling loadParameterRequirements')\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        console.log('[ExecutionController]  Immediate reload of parameters')\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Watch for changes in execution params (for backward compatibility)\nwatch(\n  () => executionParams.value,\n  newValue => {\n    emit('updateExecutionParams', newValue)\n  }\n)\n\n// Load parameters on mount\nonMounted(() => {\n  loadParameterRequirements()\n})\n\n// Expose methods for parent component\ndefineExpose({\n  executionParams,\n  clearExecutionParams,\n  loadParameterRequirements,\n  fileUploadRef,\n  uploadedFiles,\n  uploadKey,\n})\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.execution-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.params-requirements-group {\n  label {\n    display: block;\n    margin-bottom: 6px;\n    font-size: 12px;\n    color: rgba(255, 255, 255, 0.8);\n    font-weight: 500;\n  }\n\n  .params-help-text {\n    margin-bottom: 12px;\n    font-size: 11px;\n    color: rgba(255, 255, 255, 0.6);\n    line-height: 1.4;\n    padding: 6px 8px;\n    background: rgba(102, 126, 234, 0.1);\n    border: 1px solid rgba(102, 126, 234, 0.2);\n    border-radius: 4px;\n  }\n\n  .parameter-fields {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    margin-bottom: 12px;\n  }\n\n  .parameter-field {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n\n    .parameter-label {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.8);\n      font-weight: 500;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n\n      .required {\n        color: #ff6b6b;\n        font-weight: bold;\n      }\n    }\n\n    .parameter-input {\n      width: 100%;\n      background: rgba(0, 0, 0, 0.3);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      padding: 8px 12px;\n      min-height: 36px;\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n\n      &::placeholder {\n        color: rgba(255, 255, 255, 0.4);\n      }\n\n      &.error {\n        border-color: #ff6b6b;\n        box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);\n      }\n    }\n\n    .parameter-error {\n      color: #ff6b6b;\n      font-size: 11px;\n      margin-top: 4px;\n      display: block;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    }\n  }\n\n  .validation-message {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: #ffa726;\n    font-size: 14px;\n    margin-top: 8px;\n    padding: 8px 12px;\n    background: rgba(255, 167, 38, 0.1);\n    border: 1px solid rgba(255, 167, 38, 0.3);\n    border-radius: 4px;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  }\n}\n\n.call-example-wrapper {\n  margin-top: 12px;\n}\n\n.call-example-header {\n  margin-bottom: 12px;\n}\n\n.call-example-title {\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  margin: 0 0 6px 0;\n}\n\n.call-example-description {\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 12px;\n  line-height: 1.4;\n  margin: 0;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n}\n\n.http-api-urls-wrapper {\n  margin-top: 0;\n}\n\n.internal-call-wrapper,\n.mcp-call-wrapper {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.call-info {\n  font-size: 11px;\n\n  .call-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .call-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .call-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .call-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.tab-container {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.tab-header {\n  display: flex;\n  background: rgba(0, 0, 0, 0.3);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tab-button {\n  flex: 1;\n  padding: 8px 12px;\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 11px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n\n  &:last-child {\n    border-right: none;\n  }\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    color: rgba(255, 255, 255, 0.8);\n  }\n\n  &.active {\n    background: rgba(102, 126, 234, 0.2);\n    color: #667eea;\n    font-weight: 600;\n  }\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.tab-panel {\n  padding: 0;\n}\n\n.http-api-url-display {\n  padding: 12px;\n  font-size: 11px;\n\n  .api-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .api-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .api-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .api-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n\n  &.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-1px);\n      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n    }\n  }\n\n  &.publish-mcp-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    border: none;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);\n    }\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n    box-shadow: none !important;\n  }\n\n  .spinning {\n    animation: spin 1s linear infinite;\n  }\n}\n\n.execute-btn,\n.publish-mcp-btn {\n  padding: 10px 16px;\n  font-size: 13px;\n  font-weight: 500;\n  width: 100%;\n  margin-bottom: 8px;\n}\n\n.publish-mcp-btn {\n  margin-bottom: 0;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reactive, computed, watch, ref } from 'vue'\n// import { useI18n } from 'vue-i18n' // Currently unused\nimport type { StepData, DisplayPlanData } from '@/types/plan-execution'\nimport { sidebarStore } from '@/stores/sidebar'\n\nexport interface JsonEditorProps {\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  hiddenFields?: string[]\n  currentPlanTemplateId: string\n}\n\nexport interface JsonEditorEmits {\n  (e: 'rollback'): void\n  (e: 'restore'): void\n  (e: 'save'): void\n  (e: 'update:jsonContent', value: string): void\n}\n\n/**\n * Business logic for JsonEditor component\n */\nexport function useJsonEditor(props: JsonEditorProps, emit: JsonEditorEmits) {\n  // I18n\n  // const { t } = useI18n() // Currently unused\n\n  // State\n  const showJsonPreview = ref(false)\n\n  // Reactive display data - Based on DynamicAgentExecutionPlan structure\n  const displayData = reactive<DisplayPlanData>({\n    title: '',\n    steps: [],\n    directResponse: false, // Always false for dynamic agent planning\n    planTemplateId: props.currentPlanTemplateId || '',\n    planType: 'dynamic_agent',\n  })\n\n  /**\n   * Parse JSON content into visual data\n   * Maps backend DynamicAgentExecutionPlan structure to frontend DisplayPlanData\n   */\n  const parseJsonToVisual = (jsonContent: string) => {\n    console.log('[JsonEditorLogic] parseJsonToVisual called with jsonContent:', jsonContent)\n    console.log(\n      '[JsonEditorLogic] parseJsonToVisual called with currentPlanTemplateId:',\n      props.currentPlanTemplateId\n    )\n\n    try {\n      if (!jsonContent) {\n        console.log('[JsonEditorLogic] No jsonContent, resetting to default')\n        // Reset to default - matches DynamicAgentExecutionPlan structure\n        Object.assign(displayData, {\n          title: '',\n          steps: [],\n          directResponse: false,\n          planTemplateId: props.currentPlanTemplateId || '',\n          planType: 'dynamic_agent',\n        })\n        console.log('[JsonEditorLogic] Reset displayData to:', displayData)\n        return\n      }\n\n      const parsed = JSON.parse(jsonContent)\n      console.log('[JsonEditorLogic] Parsed JSON:', parsed)\n\n      // Map basic fields from DynamicAgentExecutionPlan\n      displayData.title = parsed.title || ''\n      displayData.directResponse = false // Always false for dynamic agent planning\n      displayData.planTemplateId = parsed.planTemplateId || props.currentPlanTemplateId || ''\n      displayData.planType = parsed.planType || 'dynamic_agent'\n\n      // Parse steps - maps ExecutionStep structure\n      displayData.steps = (parsed.steps || []).map((step: unknown) => {\n        const stepObj = step as Record<string, unknown>\n        return {\n          stepRequirement: (stepObj.stepRequirement as string) || '',\n          agentName: (stepObj.agentName as string) || '',\n          modelName: (stepObj.modelName as string | null) || null, // Default to null if not specified\n          selectedToolKeys: (stepObj.selectedToolKeys as string[]) || [],\n          terminateColumns: (stepObj.terminateColumns as string) || '',\n        }\n      })\n\n      console.log('[JsonEditorLogic] Updated displayData to:', displayData)\n    } catch (error) {\n      console.warn('Failed to parse JSON content:', error)\n      // Reset to default when parsing fails to prevent stale data\n      Object.assign(displayData, {\n        title: '',\n        steps: [],\n        directResponse: false,\n        planTemplateId: props.currentPlanTemplateId || '',\n        planType: 'dynamic_agent',\n      })\n      console.log('[JsonEditorLogic] Error occurred, reset displayData to:', displayData)\n    }\n  }\n\n  /**\n   * Convert visual data back to JSON\n   * Maps frontend DisplayPlanData to backend DynamicAgentExecutionPlan structure\n   */\n  const convertVisualToJson = (): string => {\n    try {\n      const result: Record<string, unknown> = {\n        title: displayData.title,\n        steps: displayData.steps.map(step => ({\n          stepRequirement: step.stepRequirement,\n          agentName: step.agentName,\n          modelName: step.modelName ?? '', // Convert null to empty string for JSON\n          selectedToolKeys: step.selectedToolKeys,\n          terminateColumns: step.terminateColumns,\n        })),\n        directResponse: displayData.directResponse,\n        planTemplateId: displayData.planTemplateId,\n        planType: displayData.planType,\n      }\n\n      return JSON.stringify(result, null, 2)\n    } catch (error) {\n      console.error('Failed to convert visual data to JSON:', error)\n      return '{}'\n    }\n  }\n\n  // Computed properties\n  const formattedJsonOutput = computed(() => convertVisualToJson())\n\n  // Watch for JSON content changes\n  watch(\n    () => props.jsonContent,\n    (newContent, oldContent) => {\n      console.log(\n        '[JsonEditorLogic] Watch triggered - jsonContent changed from',\n        oldContent,\n        'to',\n        newContent\n      )\n      parseJsonToVisual(newContent)\n    },\n    { immediate: true }\n  )\n\n  // Watch for display data changes and emit updates\n  watch(\n    displayData,\n    () => {\n      const jsonOutput = convertVisualToJson()\n      emit('update:jsonContent', jsonOutput)\n    },\n    { deep: true }\n  )\n\n  // Watch for currentPlanTemplateId changes\n  watch(\n    () => props.currentPlanTemplateId,\n    newId => {\n      if (newId) {\n        displayData.planTemplateId = newId\n      }\n    }\n  )\n\n  // Track initial step requirements to detect actual changes\n  let initialStepRequirements: string[] = []\n  let isInitialLoad = true\n\n  // Watch for stepRequirement/stepContent changes to track modifications\n  watch(\n    () => displayData.steps.map(step => step.stepRequirement || step.stepContent || ''),\n    newRequirements => {\n      // Skip on initial load\n      if (isInitialLoad) {\n        initialStepRequirements = [...newRequirements]\n        isInitialLoad = false\n        return\n      }\n\n      // Only set flag if requirements actually changed\n      const hasChanged =\n        newRequirements.length !== initialStepRequirements.length ||\n        newRequirements.some((req, index) => req !== (initialStepRequirements[index] || ''))\n\n      if (hasChanged) {\n        sidebarStore.hasTaskRequirementModified = true\n      }\n    },\n    { deep: true }\n  )\n\n  // Reset initial state when JSON content changes (new template loaded)\n  watch(\n    () => props.jsonContent,\n    () => {\n      isInitialLoad = true\n      initialStepRequirements = []\n    }\n  )\n\n  // Step management functions\n  const addStep = () => {\n    const newStep: StepData = {\n      stepRequirement: '',\n      agentName: 'ConfigurableDynaAgent', // Default agent name\n      modelName: null, // Default to null (no model selected)\n      selectedToolKeys: [],\n      terminateColumns: '',\n      agentType: '',\n      stepContent: '',\n    }\n    displayData.steps.push(newStep)\n  }\n\n  const removeStep = (index: number) => {\n    if (index >= 0 && index < displayData.steps.length) {\n      displayData.steps.splice(index, 1)\n    }\n  }\n\n  const moveStepUp = (index: number) => {\n    if (index > 0) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index - 1, 0, step)\n    }\n  }\n\n  const moveStepDown = (index: number) => {\n    if (index < displayData.steps.length - 1) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index + 1, 0, step)\n    }\n  }\n\n  // JSON preview functions\n  const toggleJsonPreview = () => {\n    showJsonPreview.value = !showJsonPreview.value\n  }\n\n  const closeJsonPreview = () => {\n    showJsonPreview.value = false\n  }\n\n  // Action handlers\n  const handleRollback = () => {\n    emit('rollback')\n  }\n\n  const handleRestore = () => {\n    emit('restore')\n  }\n\n  const handleSave = () => {\n    emit('save')\n  }\n\n  return {\n    // State\n    showJsonPreview,\n    displayData,\n    formattedJsonOutput,\n\n    // Step management\n    addStep,\n    removeStep,\n    moveStepUp,\n    moveStepDown,\n\n    // JSON preview\n    toggleJsonPreview,\n    closeJsonPreview,\n\n    // Actions\n    handleRollback,\n    handleRestore,\n    handleSave,\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by appl.form-select:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-select:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.form-textarea {law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.jsonTemplate') }}</span>\n    </div>\n    <!-- Visual JSON Editor -->\n    <div class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Agent Selection -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.agent') }}</label>\n                <div class=\"agent-selector\">\n                  <select v-model=\"step.agentName\" class=\"form-select agent-select\">\n                    <option value=\"\">{{ $t('sidebar.selectAgent') }}</option>\n                    <option value=\"DEFAULT_AGENT\">DEFAULT_AGENT</option>\n                    <option value=\"BROWSER_AGENT\">BROWSER_AGENT</option>\n                    <option value=\"TEXT_FILE_AGENT\">TEXT_FILE_AGENT</option>\n                    <option value=\"JSX_GENERATOR_AGENT\">JSX_GENERATOR_AGENT</option>\n                    <option value=\"FILE_MANAGER_AGENT\">FILE_MANAGER_AGENT</option>\n                  </select>\n\n                  <!-- Add step button -->\n                  <button\n                    @click=\"addStep\"\n                    class=\"btn btn-sm btn-add-step\"\n                    :title=\"$t('sidebar.addStep')\"\n                  >\n                    <Icon icon=\"carbon:add\" width=\"14\" />\n                  </button>\n                </div>\n              </div>\n\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepContent\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n                <input\n                  v-model=\"step.terminateColumns\"\n                  type=\"text\"\n                  class=\"form-input\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Plan ID Section -->\n      <div class=\"plan-id-section\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planId') }}</label>\n          <input\n            v-model=\"displayData.planTemplateId\"\n            type=\"text\"\n            class=\"form-input\"\n            placeholder=\"planTemplate-1756109892045\"\n          />\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\n// Props\n\nconst props = withDefaults(defineProps<JsonEditorProps>(), {\n  currentPlanTemplateId: '',\n  hiddenFields: () => [],\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'update:jsonContent': [value: string]\n}>()\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(props, emit)\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n.checkbox-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n}\n\n.form-checkbox {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n}\n\n.checkbox-label {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n/* Plan ID Section */\n.plan-id-section {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-add {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n}\n\n.btn-add:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Legacy styles for compatibility */\n.json-editor {\n  width: 100%;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  font-size: 11px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  padding: 8px;\n  resize: vertical;\n  min-height: 200px;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  overflow-wrap: break-word;\n  word-break: break-word;\n  tab-size: 2;\n  font-variant-ligatures: none;\n}\n\n.json-editor:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.json-editor::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n</style>\n","'use strict';\n\n/**\n * Create a bound version of a function with a specified `this` context\n *\n * @param {Function} fn - The function to bind\n * @param {*} thisArg - The value to be passed as the `this` parameter\n * @returns {Function} A new function that will call the original function with the specified `this` context\n */\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is an empty object (safely handles Buffers)\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an empty object, otherwise false\n */\nconst isEmptyObject = (val) => {\n  // Early return for non-objects or Buffers to prevent RangeError\n  if (!isObject(val) || isBuffer(val)) {\n    return false;\n  }\n\n  try {\n    return Object.keys(val).length === 0 && Object.getPrototypeOf(val) === Object.prototype;\n  } catch (e) {\n    // Fallback for any other objects that might cause RangeError with Object.keys()\n    return false;\n  }\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Buffer check\n    if (isBuffer(obj)) {\n      return;\n    }\n\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  if (isBuffer(obj)){\n    return null;\n  }\n\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless, skipUndefined} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else if (!skipUndefined || !isUndefined(val)) {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      //Buffer check\n      if (isBuffer(source)) {\n        return source;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isEmptyObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  const msg = error && error.message ? error.message : 'Error';\n\n  // Prefer explicit code; otherwise copy the low-level error's code (e.g. ECONNREFUSED)\n  const errCode = code == null && error ? error.code : code;\n  AxiosError.call(axiosError, msg, errCode, config, request, response);\n\n  // Chain the original error on the standard field; non-enumerable to avoid JSON noise\n  if (error && axiosError.cause == null) {\n    Object.defineProperty(axiosError, 'cause', { value: error, configurable: true });\n  }\n\n  axiosError.name = (error && error.name) || 'Error';\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (utils.isBoolean(value)) {\n      return value.toString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {void}\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), {\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    },\n    ...options\n  });\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data, this.parseReviver);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn(...args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure, sameSite) {\n      if (typeof document === 'undefined') return;\n\n      const cookie = [`${name}=${encodeURIComponent(value)}`];\n\n      if (utils.isNumber(expires)) {\n        cookie.push(`expires=${new Date(expires).toUTCString()}`);\n      }\n      if (utils.isString(path)) {\n        cookie.push(`path=${path}`);\n      }\n      if (utils.isString(domain)) {\n        cookie.push(`domain=${domain}`);\n      }\n      if (secure === true) {\n        cookie.push('secure');\n      }\n      if (utils.isString(sameSite)) {\n        cookie.push(`SameSite=${sameSite}`);\n      }\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      if (typeof document === 'undefined') return null;\n      const match = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));\n      return match ? decodeURIComponent(match[1]) : null;\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000, '/');\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop, caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop, caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop, caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b, prop) => mergeDeepProperties(headersToObject(a), headersToObject(b), prop, true)\n  };\n\n  utils.forEach(Object.keys({...config1, ...config2}), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let { data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth } = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // browser handles it\n    } else if (utils.isFunction(data.getHeaders)) {\n      // Node.js FormData (like form-data package)\n      const formHeaders = data.getHeaders();\n      // Only set safe headers to avoid overwriting security headers\n      const allowedHeaders = ['content-type', 'content-length'];\n      Object.entries(formHeaders).forEach(([key, val]) => {\n        if (allowedHeaders.includes(key.toLowerCase())) {\n          headers.set(key, val);\n        }\n      });\n    }\n  }  \n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n  request.onerror = function handleError(event) {\n       // Browsers deliver a ProgressEvent in XHR onerror\n       // (message may be empty; when present, surface it)\n       // See https://developer.mozilla.org/docs/Web/API/XMLHttpRequest/error_event\n       const msg = event && event.message ? event.message : 'Network Error';\n       const err = new AxiosError(msg, AxiosError.ERR_NETWORK, config, request);\n       // attach the underlying event for consumers who want details\n       err.event = event || null;\n       reject(err);\n       request = null;\n    };\n    \n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst {isFunction} = utils;\n\nconst globalFetchAPI = (({Request, Response}) => ({\n  Request, Response\n}))(utils.global);\n\nconst {\n  ReadableStream, TextEncoder\n} = utils.global;\n\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst factory = (env) => {\n  env = utils.merge.call({\n    skipUndefined: true\n  }, globalFetchAPI, env);\n\n  const {fetch: envFetch, Request, Response} = env;\n  const isFetchSupported = envFetch ? isFunction(envFetch) : typeof fetch === 'function';\n  const isRequestSupported = isFunction(Request);\n  const isResponseSupported = isFunction(Response);\n\n  if (!isFetchSupported) {\n    return false;\n  }\n\n  const isReadableStreamSupported = isFetchSupported && isFunction(ReadableStream);\n\n  const encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n      ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n      async (str) => new Uint8Array(await new Request(str).arrayBuffer())\n  );\n\n  const supportsRequestStream = isRequestSupported && isReadableStreamSupported && test(() => {\n    let duplexAccessed = false;\n\n    const hasContentType = new Request(platform.origin, {\n      body: new ReadableStream(),\n      method: 'POST',\n      get duplex() {\n        duplexAccessed = true;\n        return 'half';\n      },\n    }).headers.has('Content-Type');\n\n    return duplexAccessed && !hasContentType;\n  });\n\n  const supportsResponseStream = isResponseSupported && isReadableStreamSupported &&\n    test(() => utils.isReadableStream(new Response('').body));\n\n  const resolvers = {\n    stream: supportsResponseStream && ((res) => res.body)\n  };\n\n  isFetchSupported && ((() => {\n    ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n      !resolvers[type] && (resolvers[type] = (res, config) => {\n        let method = res && res[type];\n\n        if (method) {\n          return method.call(res);\n        }\n\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n    });\n  })());\n\n  const getBodyLength = async (body) => {\n    if (body == null) {\n      return 0;\n    }\n\n    if (utils.isBlob(body)) {\n      return body.size;\n    }\n\n    if (utils.isSpecCompliantForm(body)) {\n      const _request = new Request(platform.origin, {\n        method: 'POST',\n        body,\n      });\n      return (await _request.arrayBuffer()).byteLength;\n    }\n\n    if (utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n      return body.byteLength;\n    }\n\n    if (utils.isURLSearchParams(body)) {\n      body = body + '';\n    }\n\n    if (utils.isString(body)) {\n      return (await encodeText(body)).byteLength;\n    }\n  }\n\n  const resolveBodyLength = async (headers, body) => {\n    const length = utils.toFiniteNumber(headers.getContentLength());\n\n    return length == null ? getBodyLength(body) : length;\n  }\n\n  return async (config) => {\n    let {\n      url,\n      method,\n      data,\n      signal,\n      cancelToken,\n      timeout,\n      onDownloadProgress,\n      onUploadProgress,\n      responseType,\n      headers,\n      withCredentials = 'same-origin',\n      fetchOptions\n    } = resolveConfig(config);\n\n    let _fetch = envFetch || fetch;\n\n    responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n    let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n    let request = null;\n\n    const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n    });\n\n    let requestContentLength;\n\n    try {\n      if (\n        onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n        (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n      ) {\n        let _request = new Request(url, {\n          method: 'POST',\n          body: data,\n          duplex: \"half\"\n        });\n\n        let contentTypeHeader;\n\n        if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n          headers.setContentType(contentTypeHeader)\n        }\n\n        if (_request.body) {\n          const [onProgress, flush] = progressEventDecorator(\n            requestContentLength,\n            progressEventReducer(asyncDecorator(onUploadProgress))\n          );\n\n          data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n        }\n      }\n\n      if (!utils.isString(withCredentials)) {\n        withCredentials = withCredentials ? 'include' : 'omit';\n      }\n\n      // Cloudflare Workers throws when credentials are defined\n      // see https://github.com/cloudflare/workerd/issues/902\n      const isCredentialsSupported = isRequestSupported && \"credentials\" in Request.prototype;\n\n      const resolvedOptions = {\n        ...fetchOptions,\n        signal: composedSignal,\n        method: method.toUpperCase(),\n        headers: headers.normalize().toJSON(),\n        body: data,\n        duplex: \"half\",\n        credentials: isCredentialsSupported ? withCredentials : undefined\n      };\n\n      request = isRequestSupported && new Request(url, resolvedOptions);\n\n      let response = await (isRequestSupported ? _fetch(request, fetchOptions) : _fetch(url, resolvedOptions));\n\n      const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n      if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n        const options = {};\n\n        ['status', 'statusText', 'headers'].forEach(prop => {\n          options[prop] = response[prop];\n        });\n\n        const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n        const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n          responseContentLength,\n          progressEventReducer(asyncDecorator(onDownloadProgress), true)\n        ) || [];\n\n        response = new Response(\n          trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n            flush && flush();\n            unsubscribe && unsubscribe();\n          }),\n          options\n        );\n      }\n\n      responseType = responseType || 'text';\n\n      let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n      !isStreamResponse && unsubscribe && unsubscribe();\n\n      return await new Promise((resolve, reject) => {\n        settle(resolve, reject, {\n          data: responseData,\n          headers: AxiosHeaders.from(response.headers),\n          status: response.status,\n          statusText: response.statusText,\n          config,\n          request\n        })\n      })\n    } catch (err) {\n      unsubscribe && unsubscribe();\n\n      if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n        throw Object.assign(\n          new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n          {\n            cause: err.cause || err\n          }\n        )\n      }\n\n      throw AxiosError.from(err, err && err.code, config, request);\n    }\n  }\n}\n\nconst seedCache = new Map();\n\nexport const getFetch = (config) => {\n  let env = (config && config.env) || {};\n  const {fetch, Request, Response} = env;\n  const seeds = [\n    Request, Response, fetch\n  ];\n\n  let len = seeds.length, i = len,\n    seed, target, map = seedCache;\n\n  while (i--) {\n    seed = seeds[i];\n    target = map.get(seed);\n\n    target === undefined && map.set(seed, target = (i ? new Map() : factory(env)))\n\n    map = target;\n  }\n\n  return target;\n};\n\nconst adapter = getFetch();\n\nexport default adapter;\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport * as fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\n/**\n * Known adapters mapping.\n * Provides environment-specific adapters for Axios:\n * - `http` for Node.js\n * - `xhr` for browsers\n * - `fetch` for fetch API-based requests\n * \n * @type {Object<string, Function|Object>}\n */\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: {\n    get: fetchAdapter.getFetch,\n  }\n};\n\n// Assign adapter names for easier debugging and identification\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', { value });\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', { value });\n  }\n});\n\n/**\n * Render a rejection reason string for unknown or unsupported adapters\n * \n * @param {string} reason\n * @returns {string}\n */\nconst renderReason = (reason) => `- ${reason}`;\n\n/**\n * Check if the adapter is resolved (function, null, or false)\n * \n * @param {Function|null|false} adapter\n * @returns {boolean}\n */\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\n/**\n * Get the first suitable adapter from the provided list.\n * Tries each adapter in order until a supported one is found.\n * Throws an AxiosError if no adapter is suitable.\n * \n * @param {Array<string|Function>|string|Function} adapters - Adapter(s) by name or function.\n * @param {Object} config - Axios request configuration\n * @throws {AxiosError} If no suitable adapter is available\n * @returns {Function} The resolved adapter function\n */\nfunction getAdapter(adapters, config) {\n  adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n  const { length } = adapters;\n  let nameOrAdapter;\n  let adapter;\n\n  const rejectedReasons = {};\n\n  for (let i = 0; i < length; i++) {\n    nameOrAdapter = adapters[i];\n    let id;\n\n    adapter = nameOrAdapter;\n\n    if (!isResolvedHandle(nameOrAdapter)) {\n      adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n      if (adapter === undefined) {\n        throw new AxiosError(`Unknown adapter '${id}'`);\n      }\n    }\n\n    if (adapter && (utils.isFunction(adapter) || (adapter = adapter.get(config)))) {\n      break;\n    }\n\n    rejectedReasons[id || '#' + i] = adapter;\n  }\n\n  if (!adapter) {\n    const reasons = Object.entries(rejectedReasons)\n      .map(([id, state]) => `adapter ${id} ` +\n        (state === false ? 'is not supported by the environment' : 'is not available in the build')\n      );\n\n    let s = length ?\n      (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n      'as no adapter specified';\n\n    throw new AxiosError(\n      `There is no suitable adapter to dispatch the request ` + s,\n      'ERR_NOT_SUPPORT'\n    );\n  }\n\n  return adapter;\n}\n\n/**\n * Exports Axios adapters and utility to resolve an adapter\n */\nexport default {\n  /**\n   * Resolve an adapter from a list of adapter names or functions.\n   * @type {Function}\n   */\n  getAdapter,\n\n  /**\n   * Exposes all known adapters\n   * @type {Object<string, Function|Object>}\n   */\n  adapters: knownAdapters\n};\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter, config);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.13.2\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift(...requestInterceptorChain);\n      chain.push(...responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n  WebServerIsDown: 521,\n  ConnectionTimedOut: 522,\n  OriginIsUnreachable: 523,\n  TimeoutOccurred: 524,\n  SslHandshakeFailed: 525,\n  InvalidSslCertificate: 526,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","import type { AxiosResponse } from 'axios'\nimport axios from 'axios'\n\nexport interface ModelOption {\n  value: string\n  label: string\n}\n\nexport interface AvailableModelsResponse {\n  options: ModelOption[]\n  total: number\n}\n\nexport class ConfigApiService {\n  /**\n   * Get available model list\n   */\n  public static async getAvailableModels(): Promise<AvailableModelsResponse> {\n    try {\n      const response: AxiosResponse<AvailableModelsResponse> = await axios({\n        url: '/api/models/available-models',\n        method: 'GET',\n        baseURL: '', // Override the default /api/v1 baseURL\n      })\n      return response.data\n    } catch (error) {\n      console.error('Failed to fetch available models:', error)\n      return { options: [], total: 0 }\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assigned-tools\">\n    <div class=\"section-header\">\n      <span>{{ title }} ({{ filteredSelectedToolIds.length }})</span>\n      <button class=\"action-btn small\" @click=\"$emit('add-tools')\" v-if=\"showAddButton\">\n        <Icon icon=\"carbon:add\" />\n        {{ addButtonText }}\n      </button>\n    </div>\n\n    <div class=\"tools-grid\" :class=\"{ 'grid-layout': useGridLayout }\">\n      <div v-for=\"toolId in filteredSelectedToolIds\" :key=\"toolId\" class=\"tool-item assigned\">\n        <div class=\"tool-info\">\n          <span class=\"tool-name\">{{ getToolDisplayNameWithGroup(toolId) }}</span>\n          <span class=\"tool-desc\">{{ getToolDescription(toolId) }}</span>\n        </div>\n      </div>\n\n      <div v-if=\"filteredSelectedToolIds.length === 0\" class=\"no-tools\">\n        <Icon icon=\"carbon:tool-box\" />\n        <span>{{ emptyText }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { computed, watch } from 'vue'\n\n// Props\ninterface Props {\n  title: string\n  selectedToolIds: string[]\n  availableTools: Array<{\n    key: string\n    name: string\n    description: string\n    enabled: boolean\n    serviceGroup: string\n    selectable: boolean\n  }>\n  addButtonText?: string\n  emptyText?: string\n  showAddButton?: boolean\n  useGridLayout?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  addButtonText: 'Add/Remove Tools',\n  emptyText: 'No tools assigned',\n  showAddButton: true,\n  useGridLayout: false,\n})\n\n// Emits\nconst emit = defineEmits<{\n  'add-tools': []\n  'tools-filtered': [filteredToolIds: string[]]\n}>()\n\n// Computed property to filter out tools that are not in availableTools\nconst filteredSelectedToolIds = computed(() => {\n  if (!Array.isArray(props.selectedToolIds)) {\n    return []\n  }\n  return props.selectedToolIds.filter(toolId =>\n    props.availableTools.some(tool => tool.key === toolId)\n  )\n})\n\n// Watch for changes in filtered tools and emit event\nwatch(\n  filteredSelectedToolIds,\n  newFilteredTools => {\n    // Only emit if there's a difference (some tools were filtered out)\n    const selectedLength = props.selectedToolIds.length\n    if (newFilteredTools.length !== selectedLength) {\n      emit('tools-filtered', newFilteredTools)\n    }\n  },\n  { immediate: true }\n)\n\n// Methods\nconst getToolDisplayNameWithGroup = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  if (!tool) return toolId\n\n  const group = tool.serviceGroup || 'Ungrouped'\n  return `${group}.${tool.name}`\n}\n\nconst getToolDescription = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  return tool ? tool.description : ''\n}\n</script>\n\n<style scoped>\n.assigned-tools {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.section-header span {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.small {\n  padding: 6px 10px;\n  font-size: 11px;\n}\n\n.tools-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.tools-grid.grid-layout {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 12px;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.tool-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  transition: all 0.3s ease;\n}\n\n.tools-grid.grid-layout .tool-item {\n  padding: 12px;\n  justify-content: flex-start;\n}\n\n.tool-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.tool-item.assigned {\n  border-color: rgba(102, 126, 234, 0.3);\n  background: rgba(102, 126, 234, 0.1);\n}\n\n.tool-info {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  flex: 1;\n}\n\n.tool-name {\n  display: block;\n  font-weight: 500;\n  margin-bottom: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.tool-desc {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.3;\n}\n\n.no-tools {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 40px;\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.tools-grid.grid-layout .no-tools {\n  padding: 16px;\n  font-size: 12px;\n  grid-column: 1 / -1;\n}\n\n.no-tools svg {\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal\n    v-model=\"visible\"\n    :title=\"$t('toolSelection.title')\"\n    @confirm=\"handleConfirm\"\n    @update:model-value=\"handleCancel\"\n  >\n    <div class=\"tool-selection-content\">\n      <!-- Search and Sort -->\n      <div class=\"tool-controls\">\n        <div class=\"search-container\">\n          <input\n            v-model=\"searchQuery\"\n            type=\"text\"\n            class=\"search-input\"\n            :placeholder=\"$t('toolSelection.searchPlaceholder')\"\n          />\n        </div>\n        <div class=\"sort-container\">\n          <select v-model=\"sortBy\" class=\"sort-select\">\n            <option value=\"group\">{{ $t('toolSelection.sortByGroup') }}</option>\n            <option value=\"name\">{{ $t('toolSelection.sortByName') }}</option>\n            <option value=\"enabled\">{{ $t('toolSelection.sortByStatus') }}</option>\n          </select>\n        </div>\n      </div>\n\n      <!-- Tool Statistics -->\n      <div class=\"tool-summary\">\n        <span class=\"summary-text\">\n          {{\n            $t('toolSelection.summary', {\n              groups: groupedTools.size,\n              tools: totalTools,\n              selected: selectedTools.length,\n            })\n          }}\n        </span>\n      </div>\n\n      <!-- Tool Group List -->\n      <div class=\"tool-groups\" v-if=\"groupedTools.size > 0\">\n        <div v-for=\"[groupName, tools] in groupedTools\" :key=\"groupName\" class=\"tool-group\">\n          <!-- Group Header -->\n          <div\n            class=\"tool-group-header\"\n            :class=\"{ collapsed: collapsedGroups.has(groupName) }\"\n            @click=\"toggleGroupCollapse(groupName)\"\n          >\n            <div class=\"group-title-area\">\n              <Icon\n                :icon=\"\n                  collapsedGroups.has(groupName) ? 'carbon:chevron-right' : 'carbon:chevron-down'\n                \"\n                class=\"collapse-icon\"\n              />\n              <Icon icon=\"carbon:folder\" class=\"group-icon\" />\n              <span class=\"group-name\">{{ groupName }}</span>\n              <span class=\"group-count\">\n                ({{ getSelectedToolsInGroup(tools).length }}/{{ tools.length }})\n              </span>\n            </div>\n            <div class=\"group-actions\" @click.stop>\n              <label class=\"group-enable-all\">\n                <input\n                  type=\"checkbox\"\n                  class=\"group-enable-checkbox\"\n                  :checked=\"isGroupFullySelected(tools)\"\n                  @change=\"toggleGroupSelection(tools, $event)\"\n                  :data-group=\"groupName\"\n                />\n                <span class=\"enable-label\">{{ $t('toolSelection.enableAll') }}</span>\n              </label>\n            </div>\n          </div>\n\n          <!-- Group Content -->\n          <div class=\"tool-group-content\" :class=\"{ collapsed: collapsedGroups.has(groupName) }\">\n            <div v-for=\"tool in tools\" :key=\"tool.key\" class=\"tool-selection-item\">\n              <div class=\"tool-info\">\n                <div class=\"tool-selection-name\">{{ tool.name }}</div>\n                <div v-if=\"tool.description\" class=\"tool-selection-desc\">\n                  {{ tool.description }}\n                </div>\n              </div>\n              <div class=\"tool-actions\">\n                <label class=\"tool-enable-switch\" @click.stop>\n                  <input\n                    type=\"checkbox\"\n                    class=\"tool-enable-checkbox\"\n                    :checked=\"isToolSelected(tool.key)\"\n                    @change=\"toggleToolSelection(tool.key, $event)\"\n                  />\n                  <span class=\"tool-enable-slider\"></span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Empty State -->\n      <div v-else class=\"empty-state\">\n        <Icon icon=\"carbon:tools\" class=\"empty-icon\" />\n        <p>{{ $t('toolSelection.noToolsFound') }}</p>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Tool } from '@/types/tool'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, ref, watch } from 'vue'\nimport Modal from '../modal/index.vue'\n\ninterface Props {\n  modelValue: boolean\n  tools: Tool[]\n  selectedToolIds: string[]\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'confirm', selectedToolIds: string[]): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst visible = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst searchQuery = ref('')\nconst sortBy = ref<'group' | 'name' | 'enabled'>('group')\nconst collapsedGroups = ref(new Set<string>())\nconst selectedTools = ref<string[]>([])\n\n// Set group checkbox indeterminate state\nconst updateGroupCheckboxState = (groupName: string, tools: Tool[]) => {\n  const checkbox = document.querySelector(\n    `input[data-group=\"${groupName}\"]`\n  ) as HTMLInputElement | null\n  if (checkbox) {\n    checkbox.indeterminate = isGroupPartiallySelected(tools)\n  }\n}\n\n// Initialize the selected tools\nwatch(\n  () => props.selectedToolIds,\n  newIds => {\n    selectedTools.value = [...newIds]\n  },\n  { immediate: true }\n)\n\n// Filtered and sorted tools\nconst filteredTools = computed(() => {\n  let filtered = props.tools.filter(tool => tool.key) // Filter out invalid tools\n\n  // Filter out non-selectable tools\n  filtered = filtered.filter(tool => tool.selectable === true)\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(\n      tool =>\n        tool.name.toLowerCase().includes(query) ||\n        tool.description.toLowerCase().includes(query) ||\n        tool.serviceGroup.toLowerCase().includes(query)\n    )\n  }\n\n  // Sorting\n  switch (sortBy.value) {\n    case 'name':\n      filtered = [...filtered].sort((a, b) => a.name.localeCompare(b.name))\n      break\n    case 'enabled':\n      filtered = [...filtered].sort((a, b) => {\n        const aSelected = selectedTools.value.includes(a.key)\n        const bSelected = selectedTools.value.includes(b.key)\n        if (aSelected && !bSelected) return -1\n        if (!aSelected && bSelected) return 1\n        return a.name.localeCompare(b.name)\n      })\n      break\n    case 'group':\n    default:\n      filtered = [...filtered].sort((a, b) => {\n        const groupA = a.serviceGroup || 'Ungrouped'\n        const groupB = b.serviceGroup || 'Ungrouped'\n        if (groupA !== groupB) {\n          return groupA.localeCompare(groupB)\n        }\n        return a.name.localeCompare(b.name)\n      })\n      break\n  }\n\n  return filtered\n})\n\n// Tools grouped by service group\nconst groupedTools = computed(() => {\n  const groups = new Map<string, Tool[]>()\n\n  filteredTools.value.forEach(tool => {\n    const groupName = tool.serviceGroup || 'Ungrouped'\n    if (!groups.has(groupName)) {\n      groups.set(groupName, [])\n    }\n    groups.get(groupName)!.push(tool)\n  })\n\n  // Sort the groups\n  return new Map([...groups.entries()].sort())\n})\n\n// Total number of tools\nconst totalTools = computed(() => filteredTools.value.length)\n\n// Watch for changes in the selected state and update the indeterminate state of group checkboxes\nwatch(\n  [selectedTools, groupedTools],\n  () => {\n    nextTick(() => {\n      for (const [groupName, tools] of groupedTools.value) {\n        updateGroupCheckboxState(groupName, tools)\n      }\n    })\n  },\n  { flush: 'post', deep: false }\n)\n\n// Tool selection logic\nconst isToolSelected = (toolKey: string) => {\n  return selectedTools.value.includes(toolKey)\n}\n\nconst toggleToolSelection = (toolKey: string, event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n\n  // Prevent undefined toolKey\n  if (!toolKey) {\n    console.error('toolKey is undefined, cannot proceed')\n    return\n  }\n\n  if (isChecked) {\n    // Add the tool to the selected list\n    if (!selectedTools.value.includes(toolKey)) {\n      selectedTools.value = [...selectedTools.value, toolKey]\n    }\n  } else {\n    // Remove the tool from the selected list\n    selectedTools.value = selectedTools.value.filter(id => id !== toolKey)\n  }\n}\n\n// Group selection logic\nconst getSelectedToolsInGroup = (tools: Tool[]) => {\n  return tools.filter(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupFullySelected = (tools: Tool[]) => {\n  return tools.length > 0 && tools.every(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupPartiallySelected = (tools: Tool[]) => {\n  const selectedCount = getSelectedToolsInGroup(tools).length\n  return selectedCount > 0 && selectedCount < tools.length\n}\n\nconst toggleGroupSelection = (tools: Tool[], event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n  const toolKeys = tools.map(tool => tool.key)\n\n  if (isChecked) {\n    // Select all tools in the group - Use a new array to avoid reference issues\n    const newSelected = [...selectedTools.value]\n    toolKeys.forEach(key => {\n      if (!newSelected.includes(key)) {\n        newSelected.push(key)\n      }\n    })\n    selectedTools.value = newSelected\n  } else {\n    // Deselect all tools in the group - Create a new array\n    selectedTools.value = selectedTools.value.filter(id => !toolKeys.includes(id))\n  }\n}\n\n// Group collapse logic\nconst toggleGroupCollapse = (groupName: string) => {\n  if (collapsedGroups.value.has(groupName)) {\n    collapsedGroups.value.delete(groupName)\n  } else {\n    collapsedGroups.value.add(groupName)\n  }\n}\n\n// Dialog event handling\nconst handleConfirm = () => {\n  emit('confirm', [...selectedTools.value])\n  emit('update:modelValue', false)\n}\n\nconst handleCancel = () => {\n  // Translate to English and follow frontend terminology\n  selectedTools.value = [...props.selectedToolIds]\n  emit('update:modelValue', false)\n}\n\n// When the modal opens, expand the first group by default and collapse the others\nwatch(visible, newVisible => {\n  if (newVisible) {\n    collapsedGroups.value.clear()\n    const groupNames = Array.from(groupedTools.value.keys())\n    if (groupNames.length > 1) {\n      // Collapse all groups except the first one by default\n      groupNames.slice(1).forEach(name => {\n        collapsedGroups.value.add(name)\n      })\n    }\n  }\n})\n</script>\n\n<style scoped>\n.tool-selection-content {\n  min-height: 400px;\n  max-height: 600px;\n  overflow-y: auto;\n}\n\n.tool-controls {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 16px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.search-container {\n  flex: 1;\n}\n\n.search-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: rgba(102, 126, 234, 0.5);\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.search-input::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.sort-container {\n  min-width: 140px;\n}\n\n.sort-select {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.tool-summary {\n  margin-bottom: 16px;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.summary-text {\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n}\n\n.tool-group {\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.tool-group-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  cursor: pointer;\n  transition: all 0.3s;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tool-group-header:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.tool-group-header.collapsed {\n  border-bottom: none;\n}\n\n.group-title-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.collapse-icon {\n  color: rgba(255, 255, 255, 0.6);\n  transition: transform 0.3s;\n}\n\n.group-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.group-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.group-count {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n}\n\n.group-actions {\n  display: flex;\n  align-items: center;\n}\n\n.group-enable-all {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n}\n\n.group-enable-checkbox {\n  cursor: pointer;\n}\n\n.tool-group-content {\n  max-height: 300px;\n  overflow-y: auto;\n  transition: all 0.3s;\n}\n\n.tool-group-content.collapsed {\n  max-height: 0;\n  overflow: hidden;\n}\n\n.tool-selection-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  transition: background-color 0.3s;\n}\n\n.tool-selection-item:hover {\n  background: rgba(255, 255, 255, 0.03);\n}\n\n.tool-selection-item:last-child {\n  border-bottom: none;\n}\n\n.tool-info {\n  flex: 1;\n}\n\n.tool-selection-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  margin-bottom: 4px;\n}\n\n.tool-selection-desc {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n  line-height: 1.4;\n}\n\n.tool-actions {\n  margin-left: 12px;\n}\n\n.tool-enable-switch {\n  position: relative;\n  display: inline-block;\n  width: 44px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.tool-enable-checkbox {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.tool-enable-slider {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 24px;\n  transition: all 0.3s;\n}\n\n.tool-enable-slider:before {\n  position: absolute;\n  content: '';\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background: white;\n  border-radius: 50%;\n  transition: all 0.3s;\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider {\n  background: rgba(102, 126, 234, 0.8);\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider:before {\n  transform: translateX(20px);\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 20px;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.empty-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  opacity: 0.6;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.dynamicAgentPlan') }}</span>\n    </div>\n    <!-- Error Display -->\n    <div v-if=\"planTypeError\" class=\"error-section\">\n      <div class=\"error-message\">\n        <Icon icon=\"carbon:warning\" width=\"16\" />\n        <div class=\"error-content\">\n          <div class=\"error-title\">{{ $t('sidebar.planTypeError') }}</div>\n          <div class=\"error-description\">{{ planTypeError }}</div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Visual JSON Editor -->\n    <div v-else class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :class=\"{ error: titleError }\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n          <!-- Inline validation message for title -->\n          <div v-if=\"titleError\" class=\"field-error-message\">\n            <Icon icon=\"carbon:warning\" width=\"12\" />\n            {{ titleError }}\n          </div>\n        </div>\n\n        <!-- Plan Template ID (Read-only) -->\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planTemplateId') }}</label>\n          <input\n            :value=\"currentPlanTemplateId\"\n            type=\"text\"\n            class=\"form-input readonly-input\"\n            readonly\n            :placeholder=\"$t('sidebar.planTemplateIdPlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n          <div class=\"steps-actions\">\n            <button @click=\"addStep\" class=\"btn btn-xs\" :title=\"$t('sidebar.addStep')\">\n              <Icon icon=\"carbon:add\" width=\"12\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepRequirement\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n\n                <textarea\n                  v-model=\"step.terminateColumns\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n\n                <!-- Preview Section -->\n                <div\n                  v-if=\"step.terminateColumns && step.terminateColumns.trim()\"\n                  class=\"preview-section\"\n                >\n                  <div class=\"preview-label\">{{ $t('sidebar.preview') }}:</div>\n                  <div class=\"preview-content\">\n                    <div class=\"preview-text\">\n                      {{ $t('sidebar.systemWillReturnListWithTableHeaderFormat') }}:\n                      <span class=\"preview-table-header\">{{\n                        formatTableHeader(step.terminateColumns)\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Model Name -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.modelName') }}</label>\n                <div class=\"model-selector-wrapper\">\n                  <div\n                    class=\"model-selector\"\n                    :class=\"{\n                      'is-open': isModelDropdownOpenForStep(index),\n                      'is-disabled': isLoadingModels,\n                    }\"\n                  >\n                    <!-- Input field with dropdown arrow -->\n                    <div class=\"model-input-wrapper\">\n                      <input\n                        :value=\"getModelDisplayValue(index)\"\n                        type=\"text\"\n                        class=\"form-input model-search-input\"\n                        :placeholder=\"getModelPlaceholder(index)\"\n                        :disabled=\"isLoadingModels\"\n                        @click.stop=\"openModelDropdown(index)\"\n                        @focus=\"openModelDropdown(index)\"\n                        @input=\"handleModelSearchInput($event, index)\"\n                        @keydown.escape=\"closeModelDropdown(index)\"\n                        @keydown.enter.prevent=\"selectFirstFilteredModel(index)\"\n                        @keydown.down.prevent=\"navigateModelDown(index)\"\n                        @keydown.up.prevent=\"navigateModelUp(index)\"\n                      />\n                      <Icon\n                        icon=\"carbon:chevron-down\"\n                        width=\"14\"\n                        class=\"dropdown-arrow\"\n                        :class=\"{ 'is-open': isModelDropdownOpenForStep(index) }\"\n                        @click.stop=\"toggleModelDropdown(index)\"\n                      />\n                    </div>\n\n                    <!-- Dropdown list -->\n                    <div\n                      v-if=\"isModelDropdownOpenForStep(index)\"\n                      class=\"model-dropdown\"\n                      @click.stop\n                    >\n                      <!-- Loading state -->\n                      <div v-if=\"isLoadingModels\" class=\"dropdown-item disabled\">\n                        {{ $t('sidebar.loading') }}\n                      </div>\n\n                      <!-- Error state -->\n                      <div v-else-if=\"modelsLoadError\" class=\"dropdown-item disabled error\">\n                        {{ $t('sidebar.modelLoadError') }}\n                      </div>\n\n                      <!-- No models found -->\n                      <div\n                        v-else-if=\"getFilteredModelsForStep(index).length === 0\"\n                        class=\"dropdown-item disabled\"\n                      >\n                        {{ $t('sidebar.noModelsFound') }}\n                      </div>\n\n                      <!-- Model options -->\n                      <div\n                        v-for=\"(model, idx) in getFilteredModelsForStep(index)\"\n                        :key=\"model.value\"\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': step.modelName === model.value,\n                          'is-highlighted': getHighlightedIndex(index) === idx,\n                        }\"\n                        @click=\"selectModelForStep(model.value, index)\"\n                        @mouseenter=\"setHighlightedIndex(index, idx)\"\n                      >\n                        {{ model.value }}\n                        <Icon\n                          v-if=\"step.modelName === model.value\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n\n                      <!-- Default empty option -->\n                      <div\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': !step.modelName,\n                          'is-highlighted': getHighlightedIndex(index) === -1,\n                        }\"\n                        @click=\"selectModelForStep('', index)\"\n                        @mouseenter=\"setHighlightedIndex(index, -1)\"\n                      >\n                        {{ $t('sidebar.noModelSelected') }}\n                        <Icon\n                          v-if=\"!step.modelName\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Error refresh button -->\n                  <button\n                    v-if=\"modelsLoadError\"\n                    @click=\"loadAvailableModels\"\n                    class=\"btn btn-sm btn-danger\"\n                    :title=\"$t('sidebar.retryLoadModels')\"\n                  >\n                    <Icon icon=\"carbon:warning\" width=\"14\" />\n                    {{ $t('sidebar.retry') }}\n                  </button>\n                </div>\n\n                <!-- Error message -->\n                <div v-if=\"modelsLoadError\" class=\"error-message\">\n                  <Icon icon=\"carbon:warning\" width=\"12\" />\n                  {{ modelsLoadError }}\n                </div>\n              </div>\n\n              <!-- Tool Selection -->\n              <div class=\"form-row\">\n                <AssignedTools\n                  :title=\"$t('sidebar.selectedTools')\"\n                  :selected-tool-ids=\"step.selectedToolKeys\"\n                  :available-tools=\"sidebarStore.availableTools\"\n                  :add-button-text=\"$t('sidebar.addRemoveTools')\"\n                  :empty-text=\"$t('sidebar.noTools')\"\n                  :use-grid-layout=\"true\"\n                  @add-tools=\"showToolSelectionModal(index)\"\n                  @tools-filtered=\"\n                    (filteredTools: string[]) => handleToolsFiltered(index, filteredTools)\n                  \"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleCopyPlan\"\n            :disabled=\"isGenerating || isExecuting\"\n            :title=\"$t('sidebar.copyPlan')\"\n          >\n            <Icon icon=\"carbon:copy\" width=\"14\" />\n            {{ $t('sidebar.copyPlan') }}\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tool Selection Modal -->\n    <ToolSelectionModal\n      v-model=\"showToolModal\"\n      :tools=\"sidebarStore.availableTools\"\n      :selected-tool-ids=\"\n        currentStepIndex >= 0 ? displayData.steps[currentStepIndex]?.selectedToolKeys || [] : []\n      \"\n      @confirm=\"handleToolSelectionConfirm\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ConfigApiService, type ModelOption } from '@/api/config-api-service'\nimport AssignedTools from '@/components/shared/AssignedTools.vue'\nimport ToolSelectionModal from '@/components/tool-selection-modal/ToolSelectionModal.vue'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { Icon } from '@iconify/vue'\nimport { onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\nconst { t } = useI18n()\n\n// Define props interface specific to JsonEditorV2\ninterface JsonEditorV2Props {\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  currentPlanTemplateId: string\n}\n\n// Props\nconst props = withDefaults(defineProps<JsonEditorV2Props>(), {\n  currentPlanTemplateId: '',\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'copy-plan': []\n  'update:jsonContent': [value: string]\n}>()\n\n// Create compatible props object for useJsonEditor\nconst compatibleProps: JsonEditorProps = {\n  ...props,\n  hiddenFields: [],\n}\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(compatibleProps, emit)\n\n// Error state\nconst planTypeError = ref<string | null>(null)\nconst titleError = ref<string>('')\n\n// Model selection state\nconst availableModels = ref<ModelOption[]>([])\nconst isLoadingModels = ref(false)\nconst modelsLoadError = ref<string>('')\n\n// Per-step state for dropdown (stepIndex -> state)\nconst modelSearchFilters = ref<Map<number, string>>(new Map())\nconst openDropdownSteps = ref<Set<number>>(new Set())\nconst highlightedIndices = ref<Map<number, number>>(new Map())\n\n// Get search filter for a specific step\nconst getSearchFilter = (stepIndex: number): string => {\n  return modelSearchFilters.value.get(stepIndex) ?? ''\n}\n\n// Set search filter for a specific step\nconst setSearchFilter = (stepIndex: number, value: string) => {\n  modelSearchFilters.value.set(stepIndex, value)\n}\n\n// Filtered models based on search for a specific step\nconst getFilteredModelsForStep = (stepIndex: number) => {\n  const filter = getSearchFilter(stepIndex)\n  if (!filter.trim()) {\n    return availableModels.value\n  }\n  const searchTerm = filter.toLowerCase().trim()\n  return availableModels.value.filter(\n    model =>\n      model.value.toLowerCase().includes(searchTerm) ||\n      model.label.toLowerCase().includes(searchTerm)\n  )\n}\n\n// Get display value for a specific step\nconst getModelDisplayValue = (stepIndex: number): string => {\n  const step = displayData.steps[stepIndex]\n  const filter = getSearchFilter(stepIndex)\n  if (openDropdownSteps.value.has(stepIndex) && filter !== '') {\n    return filter\n  }\n  return step.modelName ?? ''\n}\n\n// Get placeholder text based on selected model\nconst getModelPlaceholder = (stepIndex: number) => {\n  if (isLoadingModels.value) {\n    return ''\n  }\n  if (modelsLoadError.value) {\n    return ''\n  }\n  const step = displayData.steps[stepIndex]\n  if (step.modelName) {\n    return ''\n  }\n  return (t('sidebar.modelNameDescription') as string) || ''\n}\n\n// Check if dropdown is open for a specific step\nconst isModelDropdownOpenForStep = (stepIndex: number): boolean => {\n  return openDropdownSteps.value.has(stepIndex)\n}\n\n// Model dropdown functions\nconst openModelDropdown = (stepIndex: number) => {\n  if (!isLoadingModels.value) {\n    openDropdownSteps.value.add(stepIndex)\n  }\n}\n\nconst closeModelDropdown = (stepIndex: number) => {\n  openDropdownSteps.value.delete(stepIndex)\n  highlightedIndices.value.set(stepIndex, -1)\n  // Reset search filter to selected model name\n  const step = displayData.steps[stepIndex]\n  setSearchFilter(stepIndex, step.modelName ?? '')\n}\n\nconst toggleModelDropdown = (stepIndex: number) => {\n  if (isModelDropdownOpenForStep(stepIndex)) {\n    closeModelDropdown(stepIndex)\n  } else {\n    openModelDropdown(stepIndex)\n  }\n}\n\nconst selectModelForStep = (modelName: string, stepIndex: number) => {\n  const step = displayData.steps[stepIndex]\n  step.modelName = modelName\n  setSearchFilter(stepIndex, modelName)\n  closeModelDropdown(stepIndex)\n}\n\n// Handle search input\nconst handleModelSearchInput = (event: Event, stepIndex: number) => {\n  const target = event.target as HTMLInputElement\n  setSearchFilter(stepIndex, target.value)\n  openModelDropdown(stepIndex)\n}\n\n// Get highlighted index for a step\nconst getHighlightedIndex = (stepIndex: number): number => {\n  return highlightedIndices.value.get(stepIndex) ?? -1\n}\n\n// Set highlighted index for a step\nconst setHighlightedIndex = (stepIndex: number, index: number) => {\n  highlightedIndices.value.set(stepIndex, index)\n}\n\n// Keyboard navigation\nconst selectFirstFilteredModel = (stepIndex: number) => {\n  const highlightedIndex = getHighlightedIndex(stepIndex)\n  const filtered = getFilteredModelsForStep(stepIndex)\n\n  // If a specific item is highlighted, select it\n  if (highlightedIndex >= 0 && highlightedIndex < filtered.length) {\n    selectModelForStep(filtered[highlightedIndex].value, stepIndex)\n  } else if (highlightedIndex === -1) {\n    // Select empty option\n    selectModelForStep('', stepIndex)\n  } else if (filtered.length > 0) {\n    // Fallback to first item\n    selectModelForStep(filtered[0].value, stepIndex)\n  } else {\n    const step = displayData.steps[stepIndex]\n    if (!step.modelName) {\n      selectModelForStep('', stepIndex)\n    }\n  }\n}\n\nconst navigateModelDown = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    setHighlightedIndex(stepIndex, 0)\n    return\n  }\n  const filtered = getFilteredModelsForStep(stepIndex)\n  const totalItems = filtered.length + 1 // +1 for \"no model selected\" option\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.min(currentIndex + 1, totalItems - 1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\nconst navigateModelUp = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    const filtered = getFilteredModelsForStep(stepIndex)\n    setHighlightedIndex(stepIndex, filtered.length)\n    return\n  }\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.max(currentIndex - 1, -1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\n// Click outside to close dropdown\nconst handleClickOutside = (event: MouseEvent) => {\n  const target = event.target as HTMLElement\n  // Check if click is inside any model selector\n  const modelSelector = target.closest('.model-selector')\n  if (!modelSelector) {\n    // Close all open dropdowns\n    openDropdownSteps.value.clear()\n  }\n}\n\n// Initialize search filters when steps change\nwatch(\n  () => displayData.steps,\n  newSteps => {\n    newSteps.forEach((step, index) => {\n      if (!modelSearchFilters.value.has(index)) {\n        setSearchFilter(index, step.modelName ?? '')\n      }\n    })\n  },\n  { deep: true, immediate: true }\n)\n\n// Tool selection state - use sidebar store's availableTools\nconst showToolModal = ref(false)\nconst currentStepIndex = ref<number>(-1)\n\n// Load available models\nconst loadAvailableModels = async () => {\n  if (isLoadingModels.value) return\n\n  isLoadingModels.value = true\n  modelsLoadError.value = ''\n\n  try {\n    const response = await ConfigApiService.getAvailableModels()\n    availableModels.value = response.options\n  } catch (error) {\n    console.error('Failed to load models:', error)\n    modelsLoadError.value = error instanceof Error ? error.message : 'Failed to load models'\n    availableModels.value = []\n  } finally {\n    isLoadingModels.value = false\n  }\n}\n\n// Available tools are now loaded from sidebar store\n\n// Tool selection functions\nconst showToolSelectionModal = (stepIndex: number) => {\n  currentStepIndex.value = stepIndex\n  showToolModal.value = true\n  console.log('[JsonEditorV2] Available tools from store:', sidebarStore.availableTools)\n}\n\nconst handleToolSelectionConfirm = (selectedToolIds: string[]) => {\n  if (currentStepIndex.value >= 0 && currentStepIndex.value < displayData.steps.length) {\n    // Update the specific step's selected tool keys\n    displayData.steps[currentStepIndex.value].selectedToolKeys = [...selectedToolIds]\n  }\n  showToolModal.value = false\n  currentStepIndex.value = -1\n}\n\nconst handleToolsFiltered = (stepIndex: number, filteredTools: string[]) => {\n  if (stepIndex >= 0 && stepIndex < displayData.steps.length) {\n    // Update the step's selected tool keys with filtered tools\n    displayData.steps[stepIndex].selectedToolKeys = [...filteredTools]\n  }\n}\n\n// Copy plan function\nconst handleCopyPlan = () => {\n  emit('copy-plan')\n}\n\n// Initialize parsedData with default structure\nconst initializeParsedData = () => {\n  try {\n    // Clear any previous errors\n    planTypeError.value = null\n\n    // Initialize with default structure if not exists\n    if (!displayData.title) {\n      displayData.title = ''\n    }\n    displayData.directResponse = false // Always false for dynamic agent planning\n  } catch (error) {\n    const errorMessage = `Failed to initialize JsonEditorV2: ${error instanceof Error ? error.message : 'Unknown error'}`\n    planTypeError.value = errorMessage\n    console.error(errorMessage, error)\n  }\n}\n\n// Watch for parsedData changes to validate structure\nwatch(\n  () => displayData,\n  newData => {\n    try {\n      // Soft validation for title - show warning but don't block the form\n      if (!newData.title.trim()) {\n        titleError.value = 'Title is required field'\n      } else {\n        titleError.value = ''\n      }\n\n      // Clear any structural errors\n      planTypeError.value = null\n    } catch (error) {\n      planTypeError.value = `Invalid data structure: ${error instanceof Error ? error.message : 'Unknown error'}`\n      titleError.value = ''\n    }\n  },\n  { immediate: true, deep: true }\n)\n\n// Watch for props changes\nwatch(\n  () => props.jsonContent,\n  (newContent, oldContent) => {\n    console.log(\n      '[JsonEditorV2] Props watch triggered - jsonContent changed from',\n      oldContent,\n      'to',\n      newContent\n    )\n    if (newContent && newContent !== oldContent) {\n      console.log('[JsonEditorV2] Force parsing new jsonContent:', newContent)\n      try {\n        const parsed = JSON.parse(newContent)\n        console.log('[JsonEditorV2] Parsed new jsonContent:', parsed)\n        Object.assign(displayData, {\n          title: parsed.title || '',\n          steps: parsed.steps || [],\n          directResponse: false,\n          planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n          planType: parsed.planType || 'dynamic_agent',\n        })\n        console.log('[JsonEditorV2] Updated displayData with new content:', displayData)\n      } catch (error) {\n        console.warn('[JsonEditorV2] Failed to parse new jsonContent:', error)\n      }\n    }\n  },\n  { immediate: true }\n)\n\n// Initialize on mount\nonMounted(() => {\n  console.log('[JsonEditorV2] Component mounted with jsonContent:', props.jsonContent)\n  console.log(\n    '[JsonEditorV2] Component mounted with currentPlanTemplateId:',\n    props.currentPlanTemplateId\n  )\n  console.log('[JsonEditorV2] Component mounted with displayData:', displayData)\n\n  // Force parse the current jsonContent to ensure it's processed\n  if (props.jsonContent) {\n    console.log('[JsonEditorV2] Force parsing jsonContent on mount:', props.jsonContent)\n    // Call parseJsonToVisual directly to ensure it's processed\n    try {\n      const parsed = JSON.parse(props.jsonContent)\n      console.log('[JsonEditorV2] Parsed jsonContent on mount:', parsed)\n      Object.assign(displayData, {\n        title: parsed.title || '',\n        steps: parsed.steps || [],\n        directResponse: false,\n        planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n        planType: parsed.planType || 'dynamic_agent',\n      })\n      console.log('[JsonEditorV2] Updated displayData on mount:', displayData)\n    } catch (error) {\n      console.warn('[JsonEditorV2] Failed to parse jsonContent on mount:', error)\n    }\n  }\n\n  initializeParsedData()\n  loadAvailableModels()\n\n  // Add click outside listener\n  document.addEventListener('click', handleClickOutside)\n})\n\nonUnmounted(() => {\n  // Remove click outside listener\n  document.removeEventListener('click', handleClickOutside)\n})\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n\n// Format table header preview\nconst formatTableHeader = (terminateColumns: string): string => {\n  if (!terminateColumns.trim()) {\n    return ''\n  }\n\n  // Split by comma and clean up each column name\n  const columns = terminateColumns\n    .split(',')\n    .map(col => col.trim())\n    .filter(col => col.length > 0)\n\n  if (columns.length === 0) {\n    return ''\n  }\n\n  // Format as |col1|col2|col3|\n  return `|${columns.join('|')}|`\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Error Section Styles */\n.error-section {\n  margin-bottom: 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n  border-radius: 8px;\n  padding: 16px;\n}\n\n.error-message {\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  color: #ef4444;\n}\n\n.error-content {\n  flex: 1;\n}\n\n.error-title {\n  font-weight: 600;\n  font-size: 14px;\n  margin-bottom: 4px;\n}\n\n.error-description {\n  font-size: 12px;\n  color: rgba(239, 68, 68, 0.8);\n  line-height: 1.4;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n/* Error state for form inputs */\n.form-input.error,\n.form-select.error,\n.form-textarea.error {\n  border-color: #ef4444;\n  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);\n}\n\n/* Field error message */\n.field-error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02);\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.6);\n  cursor: not-allowed;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 12px;\n}\n\n.readonly-input:focus {\n  border-color: rgba(255, 255, 255, 0.05);\n  box-shadow: none;\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n/* Model Selector Styles */\n.model-selector-wrapper {\n  display: flex;\n  gap: 8px;\n  align-items: flex-start;\n}\n\n.model-selector {\n  position: relative;\n  flex: 1;\n}\n\n.model-input-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.model-search-input {\n  flex: 1;\n  padding-right: 32px;\n}\n\n.dropdown-arrow {\n  position: absolute;\n  right: 12px;\n  color: rgba(255, 255, 255, 0.5);\n  pointer-events: none;\n  transition: transform 0.2s ease;\n}\n\n.dropdown-arrow.is-open {\n  transform: rotate(180deg);\n}\n\n.model-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 4px;\n  background: rgba(0, 0, 0, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  max-height: 200px;\n  overflow-y: auto;\n  z-index: 1000;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.dropdown-item {\n  padding: 8px 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover,\n.dropdown-item.is-highlighted {\n  background: rgba(102, 126, 234, 0.2);\n  color: white;\n}\n\n.dropdown-item.is-selected {\n  background: rgba(102, 126, 234, 0.15);\n  color: #667eea;\n  font-weight: 500;\n}\n\n.dropdown-item.disabled {\n  color: rgba(255, 255, 255, 0.5);\n  cursor: not-allowed;\n  font-style: italic;\n}\n\n.dropdown-item.disabled.error {\n  color: #ef4444;\n}\n\n.check-icon {\n  color: #667eea;\n  margin-left: 8px;\n}\n\n.model-selector.is-disabled .model-search-input {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.tool-keys-display {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  min-height: 32px;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n}\n\n.tool-key-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.tool-key-input {\n  flex: 1;\n  font-size: 10px;\n}\n\n.remove-tool-key-btn {\n  width: 20px;\n  height: 20px;\n  background: transparent;\n  border: none;\n  border-radius: 2px;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n}\n\n.remove-tool-key-btn:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.no-tool-keys {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 10px;\n  font-style: italic;\n  text-align: center;\n  padding: 8px;\n}\n\n.btn-add-tool-key {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n  align-self: flex-start;\n}\n\n.btn-add-tool-key:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Preview Section Styles */\n.preview-section {\n  margin-top: 8px;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n  font-size: 10px;\n}\n\n.preview-label {\n  font-weight: 600;\n  color: #667eea;\n  margin-bottom: 4px;\n  font-size: 9px;\n}\n\n.preview-content {\n  color: white;\n}\n\n.preview-text {\n  line-height: 1.4;\n  color: white;\n}\n\n.preview-table-header {\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 2px 6px;\n  border-radius: 3px;\n  color: #ef4444;\n  font-weight: 600;\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div\n    class=\"sidebar-wrapper\"\n    :class=\"{ 'sidebar-wrapper-collapsed': sidebarStore.isCollapsed }\"\n    :style=\"{ width: sidebarWidth + '%' }\"\n  >\n    <div class=\"sidebar-content\">\n      <div class=\"sidebar-content-header\">\n        <div class=\"sidebar-content-title\">{{ $t('sidebar.title') }}</div>\n      </div>\n\n      <!-- Tab Switcher -->\n      <div class=\"tab-switcher\">\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'list' }\"\n          @click=\"sidebarStore.switchToTab('list')\"\n        >\n          <Icon icon=\"carbon:list\" width=\"16\" />\n          {{ $t('sidebar.templateList') }}\n        </button>\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'config' }\"\n          @click=\"sidebarStore.switchToTab('config')\"\n          :disabled=\"!sidebarStore.selectedTemplate\"\n        >\n          <Icon icon=\"carbon:settings\" width=\"16\" />\n          {{ $t('sidebar.configuration') }}\n        </button>\n      </div>\n\n      <!-- List Tab Content -->\n      <div v-if=\"sidebarStore.currentTab === 'list'\" class=\"tab-content\">\n        <div class=\"organization-section\">\n          <button\n            class=\"new-task-btn\"\n            @click=\"() => sidebarStore.createNewTemplate(sidebarStore.planType)\"\n          >\n            <Icon icon=\"carbon:add\" width=\"16\" />\n            {{ $t('sidebar.newPlan') }}\n          </button>\n          <div class=\"organization-row\">\n            <div class=\"organization-selector\">\n              <label class=\"organization-label\">{{ $t('sidebar.organizationLabel') }}</label>\n              <select\n                :value=\"sidebarStore.organizationMethod\"\n                @change=\"handleOrganizationChange\"\n                class=\"organization-select\"\n              >\n                <option value=\"by_time\">{{ $t('sidebar.organizationByTime') }}</option>\n                <option value=\"by_abc\">{{ $t('sidebar.organizationByAbc') }}</option>\n                <option value=\"by_group_time\">{{ $t('sidebar.organizationByGroupTime') }}</option>\n                <option value=\"by_group_abc\">{{ $t('sidebar.organizationByGroupAbc') }}</option>\n              </select>\n            </div>\n            <div class=\"search-input-wrapper\">\n              <label class=\"search-label\">{{ $t('sidebar.searchLabel') }}</label>\n              <div class=\"search-input-container\">\n                <Icon icon=\"carbon:search\" width=\"16\" class=\"search-icon\" />\n                <input\n                  v-model=\"searchKeyword\"\n                  type=\"text\"\n                  class=\"search-input\"\n                  :placeholder=\"$t('sidebar.searchPlaceholder') || 'Search...'\"\n                />\n                <button\n                  v-if=\"searchKeyword\"\n                  class=\"search-clear-btn\"\n                  @click=\"searchKeyword = ''\"\n                  :title=\"$t('sidebar.clearSearch') || 'Clear search'\"\n                >\n                  <Icon icon=\"carbon:close\" width=\"14\" />\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"sidebar-content-list\">\n          <!-- Loading state -->\n          <div v-if=\"sidebarStore.isLoading\" class=\"loading-state\">\n            <Icon icon=\"carbon:circle-dash\" width=\"20\" class=\"spinning\" />\n            <span>{{ $t('sidebar.loading') }}</span>\n          </div>\n\n          <!-- Error state -->\n          <div v-else-if=\"sidebarStore.errorMessage\" class=\"error-state\">\n            <Icon icon=\"carbon:warning\" width=\"20\" />\n            <span>{{ sidebarStore.errorMessage }}</span>\n            <button @click=\"sidebarStore.loadPlanTemplateList\" class=\"retry-btn\">\n              {{ $t('sidebar.retry') }}\n            </button>\n          </div>\n\n          <!-- Empty state -->\n          <div v-else-if=\"sidebarStore.planTemplateList.length === 0\" class=\"empty-state\">\n            <Icon icon=\"carbon:document\" width=\"32\" />\n            <span>{{ $t('sidebar.noTemplates') }}</span>\n          </div>\n\n          <!-- Plan template list (grouped or ungrouped) -->\n          <template v-else>\n            <template\n              v-for=\"[groupName, templates] in filteredGroupedTemplates\"\n              :key=\"groupName || 'ungrouped'\"\n            >\n              <!-- Group header (only show for grouped methods) -->\n              <div\n                v-if=\"\n                  (sidebarStore.organizationMethod === 'by_group_time' ||\n                    sidebarStore.organizationMethod === 'by_group_abc') &&\n                  templates.length > 0\n                \"\n                class=\"group-header\"\n                @click=\"sidebarStore.toggleGroupCollapse(groupName)\"\n                :title=\"\n                  sidebarStore.isGroupCollapsed(groupName)\n                    ? $t('sidebar.expandGroup')\n                    : $t('sidebar.collapseGroup')\n                \"\n              >\n                <button\n                  class=\"group-toggle-btn\"\n                  @click.stop=\"sidebarStore.toggleGroupCollapse(groupName)\"\n                  :title=\"\n                    sidebarStore.isGroupCollapsed(groupName)\n                      ? $t('sidebar.expandGroup')\n                      : $t('sidebar.collapseGroup')\n                  \"\n                >\n                  <Icon\n                    :icon=\"\n                      sidebarStore.isGroupCollapsed(groupName)\n                        ? 'carbon:chevron-right'\n                        : 'carbon:chevron-down'\n                    \"\n                    width=\"14\"\n                  />\n                </button>\n                <Icon icon=\"carbon:folder\" width=\"16\" />\n                <span class=\"group-name\">\n                  {{\n                    groupName === null || groupName === ''\n                      ? $t('sidebar.ungroupedMethods')\n                      : groupName\n                  }}\n                </span>\n                <span class=\"group-count\">({{ templates.length }})</span>\n              </div>\n              <!-- Template items (hidden when group is collapsed) -->\n              <template\n                v-if=\"\n                  !(\n                    (sidebarStore.organizationMethod === 'by_group_time' ||\n                      sidebarStore.organizationMethod === 'by_group_abc') &&\n                    sidebarStore.isGroupCollapsed(groupName)\n                  )\n                \"\n              >\n                <div\n                  v-for=\"template in templates\"\n                  :key=\"template.id\"\n                  class=\"sidebar-content-list-item\"\n                  :class=\"{\n                    'sidebar-content-list-item-active':\n                      template.id === sidebarStore.currentPlanTemplateId,\n                    'grouped-item':\n                      sidebarStore.organizationMethod === 'by_group_time' ||\n                      sidebarStore.organizationMethod === 'by_group_abc',\n                  }\"\n                  @click=\"sidebarStore.selectTemplate(template)\"\n                >\n                  <div class=\"task-icon\">\n                    <Icon icon=\"carbon:document\" width=\"20\" />\n                  </div>\n                  <div class=\"task-details\">\n                    <div class=\"task-title\">{{ template.title || $t('sidebar.unnamedPlan') }}</div>\n                    <div class=\"task-preview\">\n                      {{ getTaskPreviewText(template) }}\n                    </div>\n                  </div>\n                  <div class=\"task-time\">\n                    {{\n                      getRelativeTimeString(\n                        sidebarStore.parseDateTime(template.updateTime || template.createTime)\n                      )\n                    }}\n                  </div>\n                  <div class=\"task-actions\">\n                    <button\n                      class=\"delete-task-btn\"\n                      :title=\"$t('sidebar.deleteTemplate')\"\n                      @click.stop=\"sidebarStore.deleteTemplate(template)\"\n                    >\n                      <Icon icon=\"carbon:close\" width=\"16\" />\n                    </button>\n                  </div>\n                </div>\n              </template>\n            </template>\n          </template>\n        </div>\n      </div>\n\n      <!-- Config Tab Content -->\n      <div v-else-if=\"sidebarStore.currentTab === 'config'\" class=\"tab-content config-tab\">\n        <div v-if=\"sidebarStore.selectedTemplate\" class=\"config-container\">\n          <!-- Template Info Header -->\n          <div class=\"template-info-header\">\n            <div class=\"template-info\">\n              <h3>{{ sidebarStore.selectedTemplate.title || $t('sidebar.unnamedPlan') }}</h3>\n              <span class=\"template-id\">ID: {{ sidebarStore.selectedTemplate.id }}</span>\n            </div>\n            <button class=\"back-to-list-btn\" @click=\"sidebarStore.switchToTab('list')\">\n              <Icon icon=\"carbon:arrow-left\" width=\"16\" />\n            </button>\n          </div>\n\n          <!-- Section 2: JSON Editor (Conditional based on plan type) -->\n          <!-- Use JsonEditorV2 for dynamic_agent type -->\n          <JsonEditorV2\n            v-if=\"sidebarStore.planType === 'dynamic_agent'\"\n            :key=\"sidebarStore.currentPlanTemplateId || 'default'\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @copy-plan=\"handleCopyPlan\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Use JsonEditor for simple or other types -->\n          <JsonEditor\n            v-else\n            :key=\"'simple-' + (sidebarStore.currentPlanTemplateId || 'default')\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Section 3: Execution Controller -->\n          <ExecutionController\n            ref=\"executionControllerRef\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :show-publish-button=\"showPublishButton\"\n            :tool-info=\"currentToolInfo\"\n            @execute-plan=\"handleExecutePlan\"\n            @publish-mcp-service=\"handlePublishMcpService\"\n            @clear-params=\"handleClearExecutionParams\"\n            @update-execution-params=\"handleUpdateExecutionParams\"\n            @save-before-execute=\"handleSaveBeforeExecute\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <!-- Sidebar Resizer -->\n    <div\n      class=\"sidebar-resizer\"\n      @mousedown=\"startResize\"\n      @dblclick=\"resetSidebarWidth\"\n      :title=\"$t('sidebar.resizeHint')\"\n    >\n      <div class=\"resizer-line\"></div>\n    </div>\n  </div>\n\n  <!-- Publish MCP Service Modal -->\n  <PublishServiceModal\n    ref=\"publishMcpModalRef\"\n    v-model=\"showPublishMcpModal\"\n    :plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n    :plan-description=\"sidebarStore.selectedTemplate?.description || ''\"\n    @published=\"handleMcpServicePublished\"\n  />\n\n  <!-- Copy Plan Modal -->\n  <div v-if=\"showCopyPlanModal\" class=\"modal-overlay\" @click=\"closeCopyPlanModal\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>{{ $t('sidebar.copyPlan') }}</h3>\n        <button class=\"close-btn\" @click=\"closeCopyPlanModal\">\n          <Icon icon=\"carbon:close\" width=\"16\" />\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.newPlanTitle') }}</label>\n          <input\n            v-model=\"newPlanTitle\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.enterNewPlanTitle')\"\n            @keyup.enter=\"confirmCopyPlan\"\n          />\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button class=\"btn btn-secondary\" @click=\"closeCopyPlanModal\">\n          {{ $t('common.cancel') }}\n        </button>\n        <button\n          class=\"btn btn-primary\"\n          @click=\"confirmCopyPlan\"\n          :disabled=\"!newPlanTitle.trim() || isCopyingPlan\"\n        >\n          <Icon v-if=\"isCopyingPlan\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n          {{ isCopyingPlan ? $t('sidebar.copying') : $t('sidebar.copyPlan') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'SidebarPanel',\n})\n\nimport type { CoordinatorToolConfig, CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { CoordinatorToolApiService } from '@/api/coordinator-tool-api-service'\nimport PublishServiceModal from '@/components/publish-service-modal/PublishServiceModal.vue'\nimport { useToast } from '@/plugins/useToast'\nimport { sidebarStore } from '@/stores/sidebar'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport type { PlanTemplate } from '@/types/plan-template'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport ExecutionController from './ExecutionController.vue'\nimport JsonEditor from './JsonEditor.vue'\nimport JsonEditorV2 from './JsonEditorV2.vue'\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Search functionality\nconst searchKeyword = ref('')\n\n// Sidebar width management\nconst sidebarWidth = ref(80) // Default width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startWidth = ref(0)\n\n// Component refs\nconst executionControllerRef = ref<InstanceType<typeof ExecutionController> | null>(null)\n\n// Tool information state\nconst currentToolInfo = ref<CoordinatorToolVO>({\n  toolName: '',\n  toolDescription: '',\n  planTemplateId: '',\n  inputSchema: '[]',\n  enableHttpService: false,\n  enableMcpService: false,\n  enableInternalToolcall: false,\n  serviceGroup: '',\n})\n\n// Store tool information for all templates\nconst templateToolInfo = ref<Partial<Record<string, CoordinatorToolVO>>>({})\nconst publishMcpModalRef = ref<InstanceType<typeof PublishServiceModal> | null>(null)\n\n// CoordinatorTool configuration\nconst coordinatorToolConfig = ref<CoordinatorToolConfig>({\n  enabled: true,\n  success: true,\n})\n\n// Computed property: whether to show publish MCP service button\nconst showPublishButton = computed(() => {\n  return coordinatorToolConfig.value.enabled\n})\n\n// Watch for changes in currentPlanTemplateId and jsonContent\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  (newId, oldId) => {\n    console.log('[Sidebar] currentPlanTemplateId changed from', oldId, 'to', newId)\n  }\n)\n\nwatch(\n  () => sidebarStore.jsonContent,\n  (newContent, oldContent) => {\n    console.log('[Sidebar] jsonContent changed from', oldContent, 'to', newContent)\n  }\n)\n\n// Load CoordinatorTool configuration\nconst loadCoordinatorToolConfig = async () => {\n  try {\n    const config = await CoordinatorToolApiService.getCoordinatorToolConfig()\n    coordinatorToolConfig.value = config\n  } catch (error) {\n    console.error('Failed to load CoordinatorTool configuration:', error)\n    // Use default configuration\n    coordinatorToolConfig.value = {\n      enabled: true,\n      success: false,\n      message: error instanceof Error ? error.message : 'Unknown error',\n    }\n  }\n}\n\n// Use pinia store\n// Use TS object-implemented sidebarStore\n// Use sidebarStore instance directly, no pinia needed\n\n// Emits - Keep some events for communication with external components\nconst emit = defineEmits<{\n  planExecutionRequested: [payload: PlanExecutionRequestPayload]\n}>()\n\nconst handleSaveTemplate = async () => {\n  try {\n    const saveResult = await sidebarStore.saveTemplate()\n\n    const result = saveResult as {\n      duplicate?: boolean\n      saved?: boolean\n      message?: string\n      versionCount?: number\n    }\n    if (result?.duplicate) {\n      toast.success(\n        t('sidebar.saveCompleted', {\n          message: result.message,\n          versionCount: result.versionCount,\n        })\n      )\n    } else if (result?.saved) {\n      toast.success(\n        t('sidebar.saveSuccess', {\n          message: result.message,\n          versionCount: result.versionCount,\n        })\n      )\n      // Refresh parameter requirements after successful save\n      refreshParameterRequirements()\n    } else if (result?.message) {\n      toast.success(t('sidebar.saveStatus', { message: result.message }))\n    }\n  } catch (error: unknown) {\n    console.error('Failed to save plan modifications:', error)\n    const message = error instanceof Error ? error.message : t('sidebar.saveFailed')\n    toast.error(message)\n    throw error // Re-throw to allow caller to handle\n  }\n}\n\nconst handleSaveBeforeExecute = async () => {\n  console.log('[Sidebar]  Save before execute requested')\n  await handleSaveTemplate()\n}\n\n// Method to refresh parameter requirements\nconst refreshParameterRequirements = async () => {\n  // Add a delay to ensure the backend has processed the new template and committed the transaction\n  await new Promise(resolve => setTimeout(resolve, 1000))\n\n  console.log(\n    '[Sidebar]  Refreshing parameter requirements for templateId:',\n    sidebarStore.currentPlanTemplateId\n  )\n\n  // Use nextTick to ensure all reactive updates are complete\n  await nextTick()\n\n  // Get ExecutionController component through ref and call its refresh method\n  if (executionControllerRef.value) {\n    console.log('[Sidebar]  Calling ExecutionController.loadParameterRequirements()')\n    executionControllerRef.value.loadParameterRequirements()\n\n    // Add a retry mechanism in case the first call fails due to timing\n    setTimeout(() => {\n      if (executionControllerRef.value) {\n        console.log(\n          '[Sidebar]  Retry: Calling ExecutionController.loadParameterRequirements() again'\n        )\n        executionControllerRef.value.loadParameterRequirements()\n      }\n    }, 2000) // Increased delay to 2 seconds for database transaction commit\n  } else {\n    console.warn('[Sidebar]  ExecutionController ref not available')\n  }\n\n  // Refresh parameter requirements in PublishMcpServiceModal\n  if (publishMcpModalRef.value) {\n    console.log('[Sidebar]  Calling PublishMcpServiceModal.loadParameterRequirements()')\n    publishMcpModalRef.value.loadParameterRequirements()\n  } else {\n    console.warn('[Sidebar]  PublishMcpServiceModal ref not available')\n  }\n}\n\n// Version control handlers\nconst handleRollback = () => {\n  try {\n    if (typeof sidebarStore.rollbackVersion === 'function') {\n      sidebarStore.rollbackVersion()\n    } else {\n      console.warn('rollbackVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during rollback operation:', error)\n    toast.error(t('sidebar.rollbackFailed') || 'Rollback failed')\n  }\n}\n\nconst handleRestore = () => {\n  try {\n    if (typeof sidebarStore.restoreVersion === 'function') {\n      sidebarStore.restoreVersion()\n    } else {\n      console.warn('restoreVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during restore operation:', error)\n    toast.error(t('sidebar.restoreFailed') || 'Restore failed')\n  }\n}\n\nconst handleExecutePlan = async (payload: PlanExecutionRequestPayload) => {\n  console.log(\n    '[Sidebar]  handleExecutePlan called with payload:',\n    JSON.stringify(payload, null, 2)\n  )\n  console.log('[Sidebar]  Current sidebarStore state:', {\n    currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n    selectedTemplate: sidebarStore.selectedTemplate?.id,\n    jsonContent: sidebarStore.jsonContent.substring(0, 100) + '...',\n  })\n\n  try {\n    const planData = sidebarStore.preparePlanExecution()\n    console.log('[Sidebar]  Prepared plan data:', JSON.stringify(planData, null, 2))\n\n    if (!planData) {\n      console.log('[Sidebar]  No plan data available, returning')\n      return\n    }\n\n    // Always use the prepared plan data (which includes planTemplateId)\n    // Add replacement parameters to plan data if provided\n    const finalPlanData = {\n      ...planData,\n      uploadedFiles: payload.uploadedFiles,\n      uploadKey: payload.uploadKey,\n    }\n\n    if (payload.replacementParams && Object.keys(payload.replacementParams).length > 0) {\n      console.log('[Sidebar]  Processing replacement parameters:', payload.replacementParams)\n      finalPlanData.replacementParams = payload.replacementParams\n    }\n\n    console.log('[Sidebar]  Final plan data:', JSON.stringify(finalPlanData, null, 2))\n\n    // Use the prepared plan data for the payload\n    const finalPayload: PlanExecutionRequestPayload = {\n      ...payload,\n      title: finalPlanData.title,\n      planData: finalPlanData.planData,\n      params: finalPlanData.params,\n      uploadedFiles: finalPlanData.uploadedFiles,\n      uploadKey: finalPlanData.uploadKey,\n    }\n\n    console.log(\n      '[Sidebar]  Emitting planExecutionRequested with final payload:',\n      JSON.stringify(finalPayload, null, 2)\n    )\n    emit('planExecutionRequested', finalPayload)\n\n    console.log('[Sidebar]  Event emitted successfully')\n  } catch (error: unknown) {\n    console.error('[Sidebar]  Error executing plan:', error)\n    const message = error instanceof Error ? error.message : 'Unknown error'\n    toast.error(t('sidebar.executeFailed') + ': ' + message)\n  } finally {\n    console.log('[Sidebar]  Cleaning up after execution')\n    sidebarStore.finishPlanExecution()\n    // Clear execution parameters after successful execution\n    sidebarStore.clearExecutionParams()\n    // Also clear ExecutionController parameters\n    if (executionControllerRef.value) {\n      console.log('[Sidebar]  Calling ExecutionController.clearExecutionParams')\n      executionControllerRef.value.clearExecutionParams()\n    }\n    console.log('[Sidebar]  Cleanup completed')\n  }\n}\n\n// MCP service publishing related state\nconst showPublishMcpModal = ref(false)\n\n// Copy plan related state\nconst showCopyPlanModal = ref(false)\nconst newPlanTitle = ref('')\nconst isCopyingPlan = ref(false)\n\nconst handlePublishMcpService = () => {\n  console.log('[Sidebar] Publish MCP service button clicked')\n  console.log('[Sidebar] currentPlanTemplateId:', sidebarStore.currentPlanTemplateId)\n\n  if (!sidebarStore.currentPlanTemplateId) {\n    console.log('[Sidebar] No plan template selected, showing warning')\n    toast.error(t('mcpService.selectPlanTemplateFirst'))\n    return\n  }\n\n  console.log('[Sidebar] Opening publish MCP service modal')\n  showPublishMcpModal.value = true\n}\n\nconst handleMcpServicePublished = async (tool: CoordinatorToolVO | null) => {\n  if (tool === null) {\n    console.log('MCP service deleted successfully')\n    toast.success(t('mcpService.deleteSuccess'))\n    // Reset tool information\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  } else {\n    console.log('MCP service published successfully:', tool)\n    toast.success(t('mcpService.publishSuccess'))\n    // Update tool information\n    currentToolInfo.value = {\n      ...tool,\n      toolName: tool.toolName,\n      serviceGroup: tool.serviceGroup ?? '',\n    }\n  }\n\n  // Reload available tools to include the newly published service\n  console.log('[Sidebar]  Reloading available tools after service publish/delete')\n  await sidebarStore.loadAvailableTools()\n\n  // Reload tool info for all templates to update the task preview\n  await loadAllTemplateToolInfo()\n}\n\n// Execution Controller event handlers\nconst handleClearExecutionParams = () => {\n  sidebarStore.clearExecutionParams()\n}\n\nconst handleUpdateExecutionParams = (params: string) => {\n  sidebarStore.executionParams = params\n}\n\n// Copy plan handler functions\nconst handleCopyPlan = () => {\n  console.log('[Sidebar] Copy plan clicked')\n\n  if (!sidebarStore.selectedTemplate) {\n    console.log('[Sidebar] No template selected, cannot copy')\n    toast.error(t('sidebar.selectPlanFirst'))\n    return\n  }\n\n  newPlanTitle.value = (sidebarStore.selectedTemplate.title ?? t('sidebar.unnamedPlan')) + ' (copy)'\n  console.log('[Sidebar] Opening copy plan modal')\n  showCopyPlanModal.value = true\n}\n\nconst closeCopyPlanModal = () => {\n  showCopyPlanModal.value = false\n  newPlanTitle.value = ''\n  isCopyingPlan.value = false\n}\n\nconst confirmCopyPlan = async () => {\n  if (!newPlanTitle.value.trim()) {\n    toast.error(t('sidebar.titleRequired'))\n    return\n  }\n\n  if (!sidebarStore.selectedTemplate || !sidebarStore.jsonContent) {\n    toast.error(t('sidebar.noPlanToCopy'))\n    return\n  }\n\n  isCopyingPlan.value = true\n\n  try {\n    const currentPlan = JSON.parse(sidebarStore.jsonContent)\n    const newPlan = {\n      ...currentPlan,\n      title: newPlanTitle.value.trim(),\n      planTemplateId: '', // New plan should not have the same template ID\n    }\n\n    const { PlanActApiService } = await import('@/api/plan-act-api-service')\n    const result = await PlanActApiService.savePlanTemplate('', JSON.stringify(newPlan))\n\n    const typedResult = result as { saved?: boolean; message?: string }\n    if (typedResult.saved) {\n      toast.success(t('sidebar.copyPlanSuccess', { title: newPlanTitle.value.trim() }))\n      await sidebarStore.loadPlanTemplateList()\n      closeCopyPlanModal()\n    } else {\n      toast.error(t('sidebar.copyPlanFailed', { message: typedResult.message || 'Unknown error' }))\n    }\n  } catch (error: unknown) {\n    console.error('[Sidebar] Error copying plan:', error)\n    const message = error instanceof Error ? error.message : 'Unknown error'\n    toast.error(t('sidebar.copyPlanFailed', { message: message }))\n  } finally {\n    isCopyingPlan.value = false\n  }\n}\n\n// Load tool information when plan template changes\nconst loadToolInfo = async (planTemplateId: string | null) => {\n  if (!planTemplateId) {\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n    return\n  }\n\n  try {\n    const toolData = await CoordinatorToolApiService.getCoordinatorToolByTemplate(planTemplateId)\n    if (toolData) {\n      currentToolInfo.value = {\n        ...toolData,\n        toolName: toolData.toolName,\n        serviceGroup: toolData.serviceGroup ?? '',\n      }\n    } else {\n      // No tool found or not published, don't show any call examples\n      currentToolInfo.value = {\n        toolName: '',\n        toolDescription: '',\n        planTemplateId: planTemplateId,\n        inputSchema: '[]',\n        enableHttpService: false,\n        enableMcpService: false,\n        enableInternalToolcall: false,\n        serviceGroup: '',\n      }\n    }\n  } catch (error) {\n    console.error('Failed to load tool information:', error)\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: planTemplateId,\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  }\n}\n\n// Handle organization method change\nconst handleOrganizationChange = (event: Event) => {\n  const target = event.target as HTMLSelectElement\n  sidebarStore.setOrganizationMethod(\n    target.value as 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc'\n  )\n}\n\n// Utility functions\nconst getRelativeTimeString = (date: Date): string => {\n  // Check if date is valid\n  if (isNaN(date.getTime())) {\n    console.warn('Invalid date received:', date)\n    return t('time.unknown')\n  }\n\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMinutes = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMinutes < 1) return t('time.now')\n  if (diffMinutes < 60) return t('time.minuteAgo', { count: diffMinutes })\n  if (diffHours < 24) return t('time.hourAgo', { count: diffHours })\n  if (diffDays < 30) return t('time.dayAgo', { count: diffDays })\n\n  return date.toLocaleDateString('zh-CN')\n}\n\n// Get task preview text - show tool name if published, otherwise empty\nconst getTaskPreviewText = (template: PlanTemplate): string => {\n  const toolInfo = templateToolInfo.value[template.id]\n  if (!toolInfo) {\n    return '' // Return empty string when no tools are published\n  }\n  return `${t('sidebar.publishedTool')}: ${toolInfo.toolName}`\n}\n\n// Filter templates based on search keyword\nconst filteredGroupedTemplates = computed(() => {\n  const keyword = searchKeyword.value.trim().toLowerCase()\n  if (!keyword) {\n    return sidebarStore.groupedTemplates\n  }\n\n  const filtered = new Map<string | null, PlanTemplate[]>()\n\n  // Iterate through all groups\n  for (const [groupName, templates] of sidebarStore.groupedTemplates) {\n    const matchingTemplates: PlanTemplate[] = []\n\n    for (const template of templates) {\n      // Search in title\n      const title = (template.title || '').toLowerCase()\n      // Search in task preview\n      const preview = getTaskPreviewText(template).toLowerCase()\n\n      if (title.includes(keyword) || preview.includes(keyword)) {\n        matchingTemplates.push(template)\n      }\n    }\n\n    // Only add groups that have matching templates\n    if (matchingTemplates.length > 0) {\n      filtered.set(groupName, matchingTemplates)\n    }\n  }\n\n  return filtered\n})\n\n// Auto-expand groups that contain matching items when searching\nwatch(searchKeyword, newKeyword => {\n  const keyword = newKeyword.trim().toLowerCase()\n  if (!keyword) {\n    return\n  }\n\n  // Only auto-expand for grouped organization methods\n  if (\n    sidebarStore.organizationMethod !== 'by_group_time' &&\n    sidebarStore.organizationMethod !== 'by_group_abc'\n  ) {\n    return\n  }\n\n  // Expand groups that contain matches\n  for (const [groupName, templates] of sidebarStore.groupedTemplates) {\n    let hasMatch = false\n    for (const template of templates) {\n      const title = (template.title || '').toLowerCase()\n      const preview = getTaskPreviewText(template).toLowerCase()\n      if (title.includes(keyword) || preview.includes(keyword)) {\n        hasMatch = true\n        break\n      }\n    }\n\n    if (hasMatch && sidebarStore.isGroupCollapsed(groupName)) {\n      sidebarStore.toggleGroupCollapse(groupName)\n    }\n  }\n})\n\n// Load tool information for all templates\nconst loadAllTemplateToolInfo = async () => {\n  for (const template of sidebarStore.planTemplateList) {\n    try {\n      const toolData = await CoordinatorToolApiService.getCoordinatorToolByTemplate(template.id)\n      if (toolData?.toolName) {\n        templateToolInfo.value[template.id] = toolData\n      }\n    } catch (error) {\n      // Silently ignore errors for templates without published tools\n      console.debug(`No tool found for template ${template.id}:`, error)\n    }\n  }\n}\n\n// Sidebar resize methods\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startWidth.value = sidebarWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startWidth.value + deltaPercent\n\n  // Limit sidebar width between 15% and 100%\n  newWidth = Math.max(15, Math.min(100, newWidth))\n\n  sidebarWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('sidebarWidth', sidebarWidth.value.toString())\n}\n\nconst resetSidebarWidth = () => {\n  sidebarWidth.value = 80\n  localStorage.setItem('sidebarWidth', '80')\n}\n\n// Watch for plan template changes to load tool information\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  newPlanTemplateId => {\n    loadToolInfo(newPlanTemplateId)\n  },\n  { immediate: true }\n)\n\n// Lifecycle\nonMounted(async () => {\n  await sidebarStore.loadPlanTemplateList()\n  await loadAllTemplateToolInfo() // Load tool info after templates are loaded\n  loadCoordinatorToolConfig()\n  sidebarStore.loadAvailableTools() // Load available tools on sidebar mount\n\n  // Restore sidebar width from localStorage\n  const savedWidth = localStorage.getItem('sidebarWidth')\n  if (savedWidth) {\n    sidebarWidth.value = parseFloat(savedWidth)\n  }\n})\n\nonUnmounted(() => {\n  // Clean up event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n})\n\n// Expose methods for parent component to call\ndefineExpose({\n  loadPlanTemplateList: sidebarStore.loadPlanTemplateList,\n  toggleSidebar: sidebarStore.toggleSidebar,\n  currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n})\n</script>\n\n<style scoped>\n.sidebar-wrapper {\n  position: relative;\n  height: 100vh;\n  background: rgba(255, 255, 255, 0.05);\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  transition: width 0.1s ease;\n  overflow: hidden;\n  display: flex;\n}\n.sidebar-wrapper-collapsed {\n  border-right: none;\n  width: 0 !important;\n  /* transform: translateX(-100%); */\n\n  .sidebar-content,\n  .sidebar-resizer {\n    opacity: 0;\n    pointer-events: none;\n  }\n}\n\n.sidebar-content {\n  height: 100%;\n  width: 100%;\n  padding: 12px 0 12px 12px;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s ease-in-out;\n  flex: 1;\n\n  .sidebar-content-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n    overflow: hidden;\n\n    .sidebar-content-title {\n      font-size: 20px;\n      font-weight: 600;\n\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n  }\n\n  .tab-switcher {\n    display: flex;\n    margin-bottom: 16px;\n    padding-right: 12px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n    padding: 4px;\n\n    .tab-button {\n      flex: 1;\n      padding: 8px 12px;\n      background: transparent;\n      border: none;\n      border-radius: 6px;\n      color: rgba(255, 255, 255, 0.7);\n      font-size: 12px;\n      font-weight: 500;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n      transition: all 0.2s ease;\n\n      &:hover:not(:disabled) {\n        background: rgba(255, 255, 255, 0.1);\n        color: rgba(255, 255, 255, 0.9);\n      }\n\n      &.active {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);\n      }\n\n      &:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n    }\n  }\n\n  .tab-content {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    min-height: 0;\n  }\n\n  .config-tab {\n    .config-container {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      overflow-y: auto;\n      padding-right: 12px;\n\n      .template-info-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin-bottom: 16px;\n        padding: 12px;\n        background: rgba(255, 255, 255, 0.05);\n        border-radius: 8px;\n\n        .template-info {\n          flex: 1;\n          min-width: 0;\n\n          h3 {\n            margin: 0 0 4px 0;\n            font-size: 14px;\n            font-weight: 600;\n            color: white;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n\n          .template-id {\n            font-size: 11px;\n            color: rgba(255, 255, 255, 0.5);\n          }\n        }\n\n        .back-to-list-btn {\n          width: 28px;\n          height: 28px;\n          background: transparent;\n          border: none;\n          border-radius: 4px;\n          color: rgba(255, 255, 255, 0.7);\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: all 0.2s ease;\n\n          &:hover {\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n          }\n        }\n      }\n\n      .json-editor {\n        width: 100%;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: white;\n        font-size: 12px;\n        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n        padding: 8px;\n        resize: vertical;\n        min-height: 100px;\n\n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n\n        &::placeholder {\n          color: rgba(255, 255, 255, 0.4);\n        }\n      }\n\n      .json-editor {\n        min-height: 200px;\n        font-size: 11px;\n        line-height: 1.5;\n        white-space: pre-wrap;\n        overflow-wrap: break-word;\n        word-break: break-word;\n        tab-size: 2;\n        font-variant-ligatures: none;\n      }\n    }\n  }\n}\n\n.organization-section {\n  margin-bottom: 16px;\n  padding-right: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n\n  .organization-row {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n\n  .organization-selector {\n    flex: 0 0 auto;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .organization-label {\n      font-size: 12px;\n      color: rgba(255, 255, 255, 0.7);\n      white-space: nowrap;\n      margin: 0;\n      padding: 0;\n      line-height: 1;\n    }\n\n    .organization-select {\n      width: 20ch;\n      max-width: 20ch;\n      padding: 6px 10px;\n      background: rgba(255, 255, 255, 0.05);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.1);\n        border-color: rgba(255, 255, 255, 0.2);\n      }\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n\n      option {\n        background: #1a1a1a;\n        color: white;\n        white-space: normal;\n      }\n    }\n  }\n\n  .search-input-wrapper {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    min-width: 0;\n\n    .search-label {\n      font-size: 12px;\n      color: rgba(255, 255, 255, 0.7);\n      white-space: nowrap;\n      margin: 0;\n      padding: 0;\n      line-height: 1;\n    }\n\n    .search-input-container {\n      flex: 1;\n      position: relative;\n      display: flex;\n      align-items: center;\n      min-width: 0;\n    }\n\n    .search-icon {\n      position: absolute;\n      left: 10px;\n      color: rgba(255, 255, 255, 0.5);\n      pointer-events: none;\n      z-index: 1;\n    }\n\n    .search-input {\n      width: 100%;\n      padding: 6px 10px 6px 32px;\n      background: rgba(255, 255, 255, 0.05);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      transition: all 0.2s ease;\n\n      &::placeholder {\n        color: rgba(255, 255, 255, 0.4);\n      }\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.1);\n        border-color: rgba(255, 255, 255, 0.2);\n      }\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n    }\n\n    .search-clear-btn {\n      position: absolute;\n      right: 6px;\n      width: 20px;\n      height: 20px;\n      background: transparent;\n      border: none;\n      border-radius: 4px;\n      color: rgba(255, 255, 255, 0.5);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.2s ease;\n      z-index: 1;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.1);\n        color: white;\n      }\n    }\n  }\n\n  .new-task-btn {\n    width: 100%;\n    padding: 10px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border: none;\n    border-radius: 6px;\n    color: white;\n    font-size: 13px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    transition: all 0.2s ease;\n    white-space: nowrap;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n  }\n}\n\n.sidebar-content-list {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow-y: auto;\n  padding-right: 12px;\n\n  .loading-state,\n  .error-state,\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 32px 16px;\n    color: rgba(255, 255, 255, 0.6);\n    font-size: 14px;\n    text-align: center;\n    gap: 12px;\n\n    .spinning {\n      animation: spin 1s linear infinite;\n    }\n\n    .retry-btn {\n      padding: 8px 16px;\n      background: rgba(255, 255, 255, 0.1);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 4px;\n      color: white;\n      cursor: pointer;\n      font-size: 12px;\n      transition: background-color 0.2s ease;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.2);\n      }\n    }\n  }\n\n  .group-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 12px;\n    margin-top: 12px;\n    margin-bottom: 6px;\n    color: rgba(255, 255, 255, 0.8);\n    font-size: 13px;\n    font-weight: 600;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    cursor: pointer;\n    user-select: none;\n    transition: background-color 0.2s ease;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.05);\n    }\n\n    &:first-child {\n      margin-top: 0;\n    }\n\n    .group-toggle-btn {\n      width: 20px;\n      height: 20px;\n      background: transparent;\n      border: none;\n      border-radius: 4px;\n      color: rgba(255, 255, 255, 0.7);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.2s ease;\n      flex-shrink: 0;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.1);\n        color: white;\n      }\n\n      &:active {\n        transform: scale(0.95);\n      }\n    }\n\n    .group-name {\n      flex: 1;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n\n    .group-count {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.5);\n      flex-shrink: 0;\n    }\n  }\n\n  .sidebar-content-list-item {\n    display: flex;\n    align-items: flex-start;\n    padding: 12px;\n    margin-bottom: 8px;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    position: relative;\n\n    &.grouped-item {\n      margin-left: 16px;\n      border-left: 2px solid rgba(102, 126, 234, 0.3);\n    }\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.1);\n      border-color: rgba(255, 255, 255, 0.2);\n      transform: translateY(-1px);\n    }\n\n    &.sidebar-content-list-item-active {\n      border: 2px solid #667eea;\n      background: rgba(102, 126, 234, 0.1);\n    }\n\n    .task-icon {\n      margin-right: 12px;\n      color: #667eea;\n      flex-shrink: 0;\n      margin-top: 2px;\n    }\n\n    .task-details {\n      flex: 1;\n      min-width: 0;\n\n      .task-title {\n        font-size: 14px;\n        font-weight: 600;\n        color: white;\n        margin-bottom: 4px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .task-preview {\n        font-size: 12px;\n        color: rgba(255, 255, 255, 0.7);\n        line-height: 1.4;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n    }\n\n    .task-time {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.5);\n      margin-left: 8px;\n      flex-shrink: 0;\n      position: absolute;\n      top: 12px;\n      right: 40px;\n    }\n\n    .task-actions {\n      display: flex;\n      align-items: center;\n      margin-left: 8px;\n      flex-shrink: 0;\n\n      .delete-task-btn {\n        width: 24px;\n        height: 24px;\n        background: transparent;\n        border: none;\n        border-radius: 4px;\n        color: rgba(255, 255, 255, 0.5);\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s ease;\n        position: absolute;\n        top: 12px;\n        right: 12px;\n\n        &:hover {\n          background: rgba(255, 0, 0, 0.2);\n          color: #ff6b6b;\n        }\n      }\n    }\n  }\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Sidebar Resizer Styles */\n.sidebar-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Copy Plan Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 13px;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"direct-page\">\n    <div class=\"direct-chat\">\n      <Sidebar ref=\"sidebarRef\" @planExecutionRequested=\"handlePlanExecutionRequested\" />\n      <!-- Left Panel - Chat -->\n      <div class=\"left-panel\" :style=\"{ width: computedLeftPanelWidth + '%' }\">\n        <div class=\"chat-header\">\n          <button class=\"back-button\" @click=\"goBack\">\n            <Icon icon=\"carbon:arrow-left\" />\n          </button>\n          <h2>{{ $t('conversation') }}</h2>\n          <div class=\"header-actions\">\n            <LanguageSwitcher />\n            <button class=\"config-button\" @click=\"newChat\" :title=\"$t('memory.newChat')\">\n              <Icon icon=\"carbon:add\" width=\"20\" />\n            </button>\n            <button class=\"config-button\" @click=\"handleConfig\" :title=\"$t('direct.configuration')\">\n              <Icon icon=\"carbon:settings-adjust\" width=\"20\" />\n            </button>\n            <button\n              class=\"cron-task-btn\"\n              @click=\"memoryStore.toggleSidebar()\"\n              :title=\"$t('memory.selectMemory')\"\n            >\n              <Icon icon=\"carbon:calendar\" width=\"20\" />\n            </button>\n          </div>\n        </div>\n\n        <!-- Chat Container -->\n        <div class=\"chat-content\">\n          <ChatContainer\n            ref=\"chatRef\"\n            mode=\"direct\"\n            :initial-prompt=\"prompt || ''\"\n            @step-selected=\"handleStepSelected\"\n            @sub-plan-step-selected=\"handleSubPlanStepSelected\"\n          />\n        </div>\n\n        <!-- Input Area -->\n        <InputArea\n          :key=\"$i18n.locale\"\n          ref=\"inputRef\"\n          :disabled=\"isLoading\"\n          :placeholder=\"isLoading ? t('input.waiting') : t('input.placeholder')\"\n          :initial-value=\"prompt\"\n          @send=\"handleSendMessage\"\n          @clear=\"handleInputClear\"\n          @focus=\"handleInputFocus\"\n          @update-state=\"handleInputUpdateState\"\n          @plan-mode-clicked=\"handlePlanModeClicked\"\n        />\n      </div>\n\n      <!-- Resizer -->\n      <div\n        class=\"panel-resizer\"\n        @mousedown=\"startResize\"\n        @dblclick=\"resetPanelSize\"\n        :title=\"$t('direct.panelResizeHint')\"\n      >\n        <div class=\"resizer-line\"></div>\n      </div>\n\n      <!-- Right Panel - Preview -->\n      <RightPanel\n        ref=\"rightPanelRef\"\n        :style=\"{ width: 100 - leftPanelWidth + '%' }\"\n        :current-root-plan-id=\"currentRootPlanId\"\n      />\n    </div>\n\n    <!-- Memory Modal -->\n    <Memory @memory-selected=\"memorySelected\" />\n\n    <!-- Message toast component -->\n    <div v-if=\"message.show\" class=\"message-toast\" :class=\"message.type\">\n      <div class=\"message-content\">\n        <span>{{ message.text }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { CommonApiService } from '@/api/common-api-service'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport ChatContainer from '@/components/chat/ChatContainer.vue'\nimport InputArea from '@/components/input/InputArea.vue'\nimport LanguageSwitcher from '@/components/language-switcher/LanguageSwitcher.vue'\nimport Memory from '@/components/memory/Memory.vue'\nimport RightPanel from '@/components/right-panel/RightPanel.vue'\nimport Sidebar from '@/components/sidebar/Sidebar.vue'\nimport { useMessage } from '@/composables/useMessage'\nimport type { InputMessage } from '@/stores/memory'\nimport { memoryStore } from '@/stores/memory'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { useTaskStore } from '@/stores/task'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useRoute, useRouter } from 'vue-router'\n\n// Define component name for Vue linting rules\ndefineOptions({\n  name: 'DirectIndex',\n})\n\n// Extended InputMessage with optional properties\ninterface ExtendedInputMessage extends InputMessage {\n  attachments?: unknown[]\n  toolName?: string\n  replacementParams?: Record<string, unknown>\n}\n\n// API Response type\ninterface ApiResponse {\n  planId?: string\n  message?: string\n  result?: string\n  [key: string]: unknown\n}\n\n// Message type from chat component\ninterface ChatMessage {\n  id: string\n  [key: string]: unknown\n}\nconst route = useRoute()\nconst router = useRouter()\nconst taskStore = useTaskStore()\nconst { t } = useI18n()\nconst { message } = useMessage()\n\nconst prompt = ref<string>('')\nconst inputOnlyContent = ref<string>('')\nconst rightPanelRef = ref()\nconst chatRef = ref()\nconst inputRef = ref()\nconst sidebarRef = ref()\nconst isExecutingPlan = ref(false)\nconst isLoading = ref(false)\nconst currentRootPlanId = ref<string | null>(null)\n\n// Related to panel width\nconst leftPanelWidth = ref(50) // Left panel width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startLeftWidth = ref(0)\n\n// Computed left panel width that adjusts based on sidebar width\nconst computedLeftPanelWidth = computed(() => {\n  if (sidebarStore.isCollapsed) {\n    return leftPanelWidth.value\n  }\n\n  // When sidebar is expanded, calculate available width for left panel\n  // Get sidebar width from the sidebar component if available\n  let sidebarWidth = 26 // Default sidebar width\n\n  // Try to get actual sidebar width from the sidebar component\n  if (sidebarRef.value && sidebarRef.value.sidebarWidth !== undefined) {\n    sidebarWidth = sidebarRef.value.sidebarWidth\n  }\n\n  // Calculate maximum available width for left panel\n  // Total width is 100%, so left panel max = 100% - sidebar width\n  const maxAvailableWidth = 100 - sidebarWidth\n\n  // Ensure left panel width doesn't exceed available space\n  // Also maintain minimum width of 20%\n  return Math.max(20, Math.min(maxAvailableWidth, leftPanelWidth.value))\n})\n\nonMounted(() => {\n  console.log('[Direct] onMounted called')\n  console.log('[Direct] taskStore.currentTask:', taskStore.currentTask)\n  console.log('[Direct] taskStore.hasUnprocessedTask():', taskStore.hasUnprocessedTask())\n\n  // Register event callbacks to planExecutionManager\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: (rootPlanId: string) => {\n      console.log('[Direct] Plan update event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan update for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanUpdate method\n      if (chatRef.value && typeof chatRef.value.handlePlanUpdate === 'function') {\n        console.log('[Direct] Calling chatRef.handlePlanUpdate with rootPlanId:', rootPlanId)\n        chatRef.value.handlePlanUpdate(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handlePlanUpdate method not available')\n      }\n\n      // Call right panel component's updateDisplayedPlanProgress method\n      if (\n        rightPanelRef.value &&\n        typeof rightPanelRef.value.updateDisplayedPlanProgress === 'function'\n      ) {\n        console.log(\n          '[Direct] Calling rightPanelRef.updateDisplayedPlanProgress with rootPlanId:',\n          rootPlanId\n        )\n        rightPanelRef.value.updateDisplayedPlanProgress(rootPlanId)\n      } else {\n        console.warn('[Direct] rightPanelRef.updateDisplayedPlanProgress method not available')\n      }\n    },\n\n    onPlanCompleted: (rootPlanId: string) => {\n      console.log('[Direct] Plan completed event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan completion for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanCompleted method\n      if (chatRef.value && typeof chatRef.value.handlePlanCompleted === 'function') {\n        const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n\n        // Retrieved plan details from cache for processing\n        if (planDetails && planDetails.completed) {\n          if (planDetails.summary && planDetails.summary.trim().length > 0) {\n            console.log(\n              '[Direct]  Plan details are valid and complete from polling cache, updating UI'\n            )\n            chatRef.value.handlePlanCompleted(planDetails)\n          } else {\n            console.warn(\n              '[Direct]  Plan completed but summary is empty, still proceeding with available data'\n            )\n            chatRef.value.handlePlanCompleted(planDetails)\n          }\n        } else {\n          console.warn('[Direct]  Plan details incomplete in cache, attempting API fallback')\n          // Fallback: try getting it from the API (maybe it has been deleted)\n          CommonApiService.getDetails(rootPlanId)\n            .then(freshDetails => {\n              console.log('[Direct]  Got fresh details from API:', freshDetails)\n              if (freshDetails && freshDetails.completed) {\n                console.log('[Direct] Fresh details from API are valid, updating UI')\n                planExecutionManager.setCachedPlanRecord(rootPlanId, freshDetails)\n                chatRef.value.handlePlanCompleted(freshDetails)\n              } else {\n                console.warn('[Direct]  API details also incomplete, using best available data')\n                chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n              }\n            })\n            .catch(error => {\n              console.error(\n                '[Direct] API call failed (likely record deleted), using cached data:',\n                error\n              )\n              chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n            })\n        }\n      } else {\n        console.warn('[Direct] chatRef.handlePlanCompleted method not available')\n      }\n\n      // Clear current root plan ID when plan is completed\n      currentRootPlanId.value = null\n      console.log('[Direct]  Cleared currentRootPlanId after plan completion')\n\n      //Clear sessionPlanId to ensure that subsequent file uploads use the new planId\n      if (inputRef.value && typeof inputRef.value.resetSession === 'function') {\n        console.log('[Direct]  Calling inputRef.resetSession to clear sessionPlanId')\n        inputRef.value.resetSession()\n      }\n    },\n\n    onDialogRoundStart: (rootPlanId: string) => {\n      console.log('[Direct] Dialog round start event received for rootPlanId:', rootPlanId)\n\n      // Set current root plan ID when dialog starts\n      currentRootPlanId.value = rootPlanId\n      console.log('[Direct] Set currentRootPlanId to:', rootPlanId)\n\n      // Call chat component's handleDialogRoundStart method (without query parameter)\n      if (chatRef.value && typeof chatRef.value.handleDialogRoundStart === 'function') {\n        console.log('[Direct] Calling chatRef.handleDialogRoundStart with planId:', rootPlanId)\n        chatRef.value.handleDialogRoundStart(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handleDialogRoundStart method not available')\n      }\n    },\n\n    onChatInputClear: () => {\n      console.log('[Direct] Chat input clear event received')\n      handleInputClear()\n    },\n\n    onChatInputUpdateState: (rootPlanId: string) => {\n      console.log('[Direct] Chat input update state event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId, true)) {\n        return\n      }\n\n      const uiState = planExecutionManager.getCachedUIState(rootPlanId)\n      if (uiState) {\n        handleInputUpdateState(uiState.enabled, uiState.placeholder)\n      }\n    },\n\n    onPlanError: (message: string) => {\n      // No right panel notification needed, uncomment if needed\n      // showMessage(`${t('planTemplate.executionFailed')}: ${message}`, 'error')\n      chatRef.value.handlePlanError(message)\n    },\n  })\n\n  console.log('[Direct] Event callbacks registered to planExecutionManager')\n\n  // Initialize sidebar data\n  sidebarStore.loadPlanTemplateList()\n\n  // Check if there is a task in the store\n  if (taskStore.hasUnprocessedTask() && taskStore.currentTask) {\n    const taskContent = taskStore.currentTask.prompt\n    console.log('[Direct] Found unprocessed task from store:', taskContent)\n\n    // Check if task content is not empty before processing\n    if (taskContent.trim()) {\n      // Mark the task as processed to prevent duplicate responses\n      taskStore.markTaskAsProcessed()\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log('[Direct] Calling handleChatSendMessage with taskContent:', taskContent)\n          await handleChatSendMessage({\n            input: taskContent,\n          })\n        } catch (error) {\n          console.warn('[Direct] handleChatSendMessage failed, falling back to prompt:', error)\n          prompt.value = taskContent\n        }\n      })\n    } else {\n      // Task has empty content, just mark it as processed and don't execute\n      console.log('[Direct] Task has empty content, marking as processed without execution')\n      taskStore.markTaskAsProcessed()\n    }\n  } else {\n    // Check if there is a task to input (for pre-filling input without executing)\n    const taskToInput = taskStore.getAndClearTaskToInput()\n    if (taskToInput) {\n      inputOnlyContent.value = taskToInput\n      console.log('[Direct] Setting inputOnlyContent for input only:', inputOnlyContent.value)\n      // Don't set prompt.value since this is just for input pre-filling\n    } else {\n      // Degrade to URL parameters (backward compatibility)\n      prompt.value = (route.query.prompt as string) || ''\n      console.log('[Direct] Received task from URL:', prompt.value)\n      console.log('[Direct] No unprocessed task in store')\n    }\n  }\n\n  // Restore panel width from localStorage\n  const savedWidth = localStorage.getItem('directPanelWidth')\n  if (savedWidth) {\n    leftPanelWidth.value = parseFloat(savedWidth)\n  }\n\n  console.log('[Direct] Final prompt value:', prompt.value)\n\n  // Set input content if there's inputOnlyContent (after component is mounted)\n  if (inputOnlyContent.value) {\n    nextTick(() => {\n      if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n        inputRef.value.setInputValue(inputOnlyContent.value)\n        console.log('[Direct] Set input value:', inputOnlyContent.value)\n        inputOnlyContent.value = '' // Clear after setting\n      }\n    })\n  }\n\n  // Listen for plan-execution-requested events on window\n  window.addEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    console.log('[DirectView] Received plan-execution-requested event:', event.detail)\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n\n  // No longer need to check pending plans in sessionStorage\n  // Because emitPlanExecutionRequested in task.ts already sends events directly\n})\n\n// Listen for changes in the store's task (only handle unprocessed tasks)\nwatch(\n  () => taskStore.currentTask,\n  newTask => {\n    console.log('[Direct] Watch taskStore.currentTask triggered, newTask:', newTask)\n    if (newTask && !newTask.processed && newTask.prompt.trim()) {\n      const taskContent = newTask.prompt\n      taskStore.markTaskAsProcessed()\n      console.log('[Direct] Received new task from store:', taskContent)\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log(\n            '[Direct] Directly executing new task via handleChatSendMessage:',\n            taskContent\n          )\n          await handleChatSendMessage({ input: taskContent })\n        } catch (error) {\n          console.warn('[Direct] handleChatSendMessage failed for new task:', error)\n        }\n      })\n    } else {\n      console.log('[Direct] Task is null, already processed, or has empty prompt - ignoring')\n    }\n  },\n  { immediate: false }\n)\n\n// Listen for changes in prompt value, only for logging purposes\nwatch(\n  () => prompt.value,\n  (newPrompt, oldPrompt) => {\n    console.log('[Direct] prompt value changed from:', oldPrompt, 'to:', newPrompt)\n    // Prompt is now only used for input field initial value, no automatic execution\n  },\n  { immediate: false }\n)\n\n// Listen for changes in taskToInput (for handling cron task template setting)\nwatch(\n  () => taskStore.taskToInput,\n  newTaskToInput => {\n    console.log('[Direct] Watch taskStore.taskToInput triggered, newTaskToInput:', newTaskToInput)\n    if (newTaskToInput.trim()) {\n      console.log('[Direct] Setting input value from taskToInput:', newTaskToInput)\n      nextTick(() => {\n        if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n          inputRef.value.setInputValue(newTaskToInput.trim())\n          console.log('[Direct] Input value set from taskToInput watch:', newTaskToInput.trim())\n          // Clear the taskToInput after setting\n          taskStore.getAndClearTaskToInput()\n        }\n      })\n    }\n  },\n  { immediate: false }\n)\n\nonUnmounted(() => {\n  console.log('[Direct] onUnmounted called, cleaning up resources')\n\n  // Clear current root plan ID\n  currentRootPlanId.value = null\n\n  // Clean up plan execution manager resources\n  planExecutionManager.cleanup()\n\n  // Remove event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  window.removeEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n})\n\n// Methods related to panel size adjustment\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startLeftWidth.value = leftPanelWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startLeftWidth.value + deltaPercent\n\n  // Limit panel width between 20% and 80%\n  newWidth = Math.max(20, Math.min(80, newWidth))\n\n  leftPanelWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('directPanelWidth', leftPanelWidth.value.toString())\n}\n\nconst resetPanelSize = () => {\n  leftPanelWidth.value = 50\n  localStorage.setItem('directPanelWidth', '50')\n}\n\n// Helper function to check if the event should be processed for the current plan\nconst shouldProcessEventForCurrentPlan = (\n  rootPlanId: string,\n  allowSpecialIds: boolean = false\n): boolean => {\n  // If no current plan is set, allow all events (initial state)\n  if (!currentRootPlanId.value) {\n    return true\n  }\n\n  // Check if this event is for the current active plan\n  if (rootPlanId === currentRootPlanId.value) {\n    return true\n  }\n\n  // Allow special IDs for UI state updates (error handling, etc.)\n  if (allowSpecialIds && (rootPlanId === 'ui-state' || rootPlanId === 'error')) {\n    return true\n  }\n\n  // Otherwise, ignore the event\n  console.log(\n    '[Direct] Ignoring event for non-current rootPlanId:',\n    rootPlanId,\n    'current:',\n    currentRootPlanId.value\n  )\n  return false\n}\n\n// Handle message sending from ChatContainer via event\nconst handleChatSendMessage = async (query: InputMessage) => {\n  let assistantMessage: ChatMessage | null = null\n\n  try {\n    console.log('[DirectView] Processing send-message event:', query)\n\n    // Validate input - don't send empty requests to backend\n    if (!query.input.trim()) {\n      console.warn('[DirectView] Empty input detected, skipping backend request')\n      return\n    }\n\n    // Add user message to UI\n    const userMessage = chatRef.value?.addMessage('user', query.input)\n    const extendedQuery = query as ExtendedInputMessage\n    if (extendedQuery.attachments && userMessage) {\n      chatRef.value?.updateMessage(userMessage.id, { attachments: extendedQuery.attachments })\n    }\n\n    // Add assistant thinking message\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.thinkingProcessing'),\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n    }\n\n    // Import and call DirectApiService to send message to backend\n    const { DirectApiService } = await import('@/api/direct-api-service')\n\n    // Check if a specific tool is selected (toolName and replacementParams in query)\n    let response: ApiResponse\n\n    if (extendedQuery.toolName && extendedQuery.replacementParams) {\n      // Execute selected tool\n      console.log(\n        '[DirectView] Calling DirectApiService.executeByToolName with tool:',\n        extendedQuery.toolName\n      )\n      response = (await DirectApiService.executeByToolName(\n        extendedQuery.toolName,\n        extendedQuery.replacementParams as Record<string, string>,\n        query.uploadedFiles,\n        query.uploadKey\n      )) as ApiResponse\n    } else {\n      // Use default plan template\n      console.log('[DirectView] Calling DirectApiService.sendMessageWithDefaultPlan')\n      response = (await DirectApiService.sendMessageWithDefaultPlan(query)) as ApiResponse\n    }\n\n    console.log('[DirectView] API response received:', response)\n\n    // Handle the response\n    const typedResponse = response as { planId?: string }\n    if (typedResponse.planId && assistantMessage) {\n      // Plan mode: Update message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: typedResponse.planId,\n          rootPlanId: typedResponse.planId,\n          status: 'running',\n        },\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = typedResponse.planId || null\n      console.log('[DirectView] Set currentRootPlanId to:', typedResponse.planId)\n\n      // Start polling for plan updates\n      planExecutionManager.handlePlanExecutionRequested(typedResponse.planId!, query.input)\n      console.log('[DirectView] Started polling for plan execution updates')\n    } else if (assistantMessage) {\n      // Direct mode: Show the response\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        content: response.message || response.result || 'No response received from backend',\n      })\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n  } catch (error: unknown) {\n    const errorMessage = error instanceof Error ? error.message : String(error)\n    console.error('[DirectView] Send message failed:', errorMessage)\n\n    // Show error message\n    chatRef.value?.addMessage('assistant', `Error: ${errorMessage}`)\n    if (assistantMessage) {\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n  }\n}\n\n// Event handler for input area send button\nconst handleSendMessage = async (message: InputMessage) => {\n  console.log('[DirectView] Send message from input:', JSON.stringify(message))\n\n  // Directly handle the message sending\n  await handleChatSendMessage(message)\n}\n\nconst handleInputClear = () => {\n  console.log('[DirectView] Input cleared')\n  if (inputRef.value && typeof inputRef.value.clear === 'function') {\n    inputRef.value.clear()\n  }\n}\n\nconst handleInputFocus = () => {\n  console.log('[DirectView] Input focused')\n}\n\nconst handleInputUpdateState = (enabled: boolean, placeholder?: string) => {\n  console.log('[DirectView] Input state updated:', enabled, placeholder)\n  isLoading.value = !enabled\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[DirectView] Step selected:', stepId)\n\n  // Forward step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleStepSelected === 'function') {\n    console.log('[DirectView] Forwarding step selection to right panel:', stepId)\n    rightPanelRef.value.handleStepSelected(stepId)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleStepSelected method not available')\n  }\n}\n\nconst handleSubPlanStepSelected = (\n  parentPlanId: string,\n  subPlanId: string,\n  stepIndex: number,\n  subStepIndex: number\n) => {\n  console.log('[DirectView] Sub plan step selected:', {\n    parentPlanId,\n    subPlanId,\n    stepIndex,\n    subStepIndex,\n  })\n\n  // Forward sub plan step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleSubPlanStepSelected === 'function') {\n    console.log('[DirectView] Forwarding sub plan step selection to right panel:', {\n      parentPlanId,\n      subPlanId,\n      stepIndex,\n      subStepIndex,\n    })\n    rightPanelRef.value.handleSubPlanStepSelected(parentPlanId, subPlanId, stepIndex, subStepIndex)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleSubPlanStepSelected method not available')\n  }\n}\n\nconst handlePlanModeClicked = () => {\n  console.log('[DirectView] Plan mode button clicked')\n  // Toggle sidebar display state\n  sidebarStore.toggleSidebar()\n  console.log('[DirectView] Sidebar toggled, isCollapsed:', sidebarStore.isCollapsed)\n}\n\nconst goBack = () => {\n  router.push('/home')\n}\n\nconst handleConfig = () => {\n  router.push('/configs')\n}\n\nconst handlePlanExecutionRequested = async (payload: PlanExecutionRequestPayload) => {\n  console.log('[DirectView] Plan execution requested:', payload)\n\n  // Prevent duplicate execution\n  if (isExecutingPlan.value) {\n    console.log('[DirectView] Plan execution already in progress, ignoring request')\n    return\n  }\n\n  isExecutingPlan.value = true\n\n  // Mark whether user message has been added\n  let userMessageAdded = false\n  let assistantMessage: ChatMessage | null = null\n\n  // Add user and assistant messages using the same pattern as handleChatSendMessage\n  try {\n    console.log('[DirectView] Adding messages for plan execution:', payload.title)\n\n    // Add user message\n    chatRef.value?.addMessage('user', payload.title)\n    userMessageAdded = true\n\n    // Add assistant message to show system feedback\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.planningExecution'),\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n      console.log('[DirectView] Added assistant message for plan execution:', assistantMessage.id)\n    }\n  } catch (messageError) {\n    console.warn('[DirectView] Failed to add messages:', messageError)\n  }\n  try {\n    // Get the plan template ID\n    const planTemplateId = payload.planData.planTemplateId\n\n    if (!planTemplateId) {\n      throw new Error(t('direct.planTemplateIdNotFound'))\n    }\n\n    console.log(\n      '[Direct] Executing plan with templateId:',\n      planTemplateId,\n      'params:',\n      payload.params\n    )\n\n    // Call real API to execute plan\n    console.log('[Direct] About to call PlanActApiService.executePlan')\n\n    // Get uploaded files from InputArea component\n    const uploadedFiles = payload.uploadedFiles ?? []\n    const uploadKey = payload.uploadKey ?? undefined\n\n    console.log('[Direct]  DEBUG - InputArea uploadedFiles:', uploadedFiles)\n    console.log('[Direct]  DEBUG - InputArea uploadKey:', uploadKey)\n    console.log('[Direct] Executing with uploaded files:', uploadedFiles.length)\n    console.log('[Direct] Executing with replacement params:', payload.replacementParams)\n\n    let response\n    if (payload.params?.trim()) {\n      console.log('[Direct] Calling executePlan with rawParam:', payload.params.trim())\n      response = await PlanActApiService.executePlan(\n        planTemplateId,\n        payload.params.trim(),\n        uploadedFiles,\n        payload.replacementParams,\n        uploadKey\n      )\n    } else {\n      console.log('[Direct] Calling executePlan without rawParam')\n      response = await PlanActApiService.executePlan(\n        planTemplateId,\n        undefined,\n        uploadedFiles,\n        payload.replacementParams,\n        uploadKey\n      )\n    }\n\n    console.log('[Direct] Plan execution API response:', response)\n\n    // Use the returned planId to start the plan execution process\n    const executionResponse = response as { planId?: string }\n    if (executionResponse.planId && assistantMessage) {\n      console.log(\n        '[Direct] Got planId from response:',\n        executionResponse.planId,\n        'starting plan execution'\n      )\n\n      // Update assistant message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: executionResponse.planId,\n          rootPlanId: executionResponse.planId,\n          status: 'running',\n        },\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = executionResponse.planId || null\n      console.log('[Direct] Set currentRootPlanId to:', executionResponse.planId)\n\n      // Use planExecutionManager to handle plan execution\n      console.log('[Direct] Delegating plan execution to planExecutionManager')\n      planExecutionManager.handlePlanExecutionRequested(executionResponse.planId!, payload.title)\n    } else {\n      console.error('[Direct] No planId in response:', response)\n      throw new Error(t('direct.executionFailedNoPlanId'))\n    }\n  } catch (error: unknown) {\n    const errorMessage = error instanceof Error ? error.message : String(error)\n    console.error('[Direct] Plan execution failed:', errorMessage)\n    const errorStack = error instanceof Error ? error.stack : undefined\n    console.error('[Direct] Error details:', { message: errorMessage, stack: errorStack })\n\n    // Clear current root plan ID on error\n    currentRootPlanId.value = null\n\n    // Handle error messages using consistent pattern\n    try {\n      console.log('[Direct] Adding error messages to chat')\n\n      // Only add user message if it hasn't been added before\n      if (!userMessageAdded) {\n        chatRef.value?.addMessage('user', payload.title)\n      }\n\n      // Update assistant message with error or add new error message\n      if (assistantMessage) {\n        chatRef.value?.updateMessage(assistantMessage.id, {\n          content: `${t('direct.executionFailed')}: ${(error as Error).message || t('common.unknownError')}`,\n          thinking: undefined,\n        })\n        chatRef.value?.stopStreaming(assistantMessage.id)\n      } else {\n        chatRef.value?.addMessage(\n          'assistant',\n          `${t('direct.executionFailed')}: ${(error as Error).message || t('common.unknownError')}`\n        )\n      }\n    } catch (errorHandlingError) {\n      console.error('[Direct] Failed to add error messages:', errorHandlingError)\n      // Note: This would need toast import if used in this context\n      alert(\n        `${t('direct.executionFailed')}: ${(error as Error).message || t('common.unknownError')}`\n      )\n    }\n  } finally {\n    console.log('[Direct] Plan execution finished, resetting isExecutingPlan flag')\n    isExecutingPlan.value = false\n  }\n}\n\nconst memorySelected = () => {\n  chatRef.value.showMemory()\n}\n\nconst newChat = () => {\n  memoryStore.clearMemoryId()\n  chatRef.value.newChat()\n}\n</script>\n\n<style lang=\"less\" scoped>\n.direct-page {\n  width: 100%;\n  display: flex;\n  position: relative;\n}\n\n.direct-chat {\n  height: 100vh;\n  width: 100%;\n  background: #0a0a0a;\n  display: flex;\n}\n\n.left-panel {\n  position: relative;\n  border-right: none; /* Remove the original border, which will be provided by the resizer */\n  display: flex;\n  flex-direction: column;\n  height: 100vh; /* Use fixed height */\n  overflow: hidden; /* Prevent panel itself overflow */\n  transition: width 0.1s ease; /* Smooth transition */\n}\n\n.panel-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Adjust right panel styles */\n:deep(.right-panel) {\n  transition: width 0.1s ease;\n}\n\n.chat-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: rgba(255, 255, 255, 0.02);\n  flex-shrink: 0; /* Ensure the header will not be compressed */\n  position: sticky; /* Fix the header at the top */\n  top: 0;\n  z-index: 100;\n\n  h2 {\n    flex: 1;\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #ffffff;\n  }\n}\n\n.chat-content {\n  flex: 1; /* Occupy remaining space */\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Allow shrink */\n  overflow: hidden; /* Prevent overflow */\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.back-button {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 14px;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.config-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.cron-task-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.loading-prompt {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #888888;\n  font-size: 16px;\n  padding: 50px;\n}\n\n/* Message toast styles */\n.message-toast {\n  position: fixed;\n  top: 80px;\n  right: 24px;\n  z-index: 9999;\n  min-width: 320px;\n  max-width: 480px;\n  padding: 16px 20px;\n  border-radius: 8px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  animation: slideInRight 0.3s ease-out;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.message-toast.error {\n  color: #fff2f0;\n  background-color: #ff4d4f;\n}\n\n.message-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  word-break: break-all;\n}\n\n.message-content i {\n  font-size: 16px;\n}\n</style>\n"],"file":"index-Bqa2fRyQ.js"}